<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç† | æ—¶å…‰'s Blog</title><meta name="keywords" content="OpenWRT"><meta name="author" content="XiaoWanğŸ’¦"><meta name="copyright" content="XiaoWanğŸ’¦"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†1.OpenWRTè™šæ‹Ÿç³»ç»Ÿå‡†å¤‡ç¯å¢ƒï¼š ç¼–è¯‘æœåŠ¡å™¨ï¼šUbuntu-14.04-desktop è™šæ‹Ÿæœºè½¯ä»¶ï¼šVMWare-10.0 ç¼–è¯‘ç¯å¢ƒå‡†å¤‡ï¼šapt-get install subversion build-essential libncurses5-dev zlib1g-dev gawk git ccache gettext libssl-dev xsltproc fl">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†">
<meta property="og:url" content="https://blog.wwang.pw/post/openwrt-docs.html">
<meta property="og:site_name" content="æ—¶å…‰&#39;s Blog">
<meta property="og:description" content="OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†1.OpenWRTè™šæ‹Ÿç³»ç»Ÿå‡†å¤‡ç¯å¢ƒï¼š ç¼–è¯‘æœåŠ¡å™¨ï¼šUbuntu-14.04-desktop è™šæ‹Ÿæœºè½¯ä»¶ï¼šVMWare-10.0 ç¼–è¯‘ç¯å¢ƒå‡†å¤‡ï¼šapt-get install subversion build-essential libncurses5-dev zlib1g-dev gawk git ccache gettext libssl-dev xsltproc fl">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jsd.cdn.zzko.cn/gh/xiaowansm5/img@master/ecy/982257.1hk8iymuua80.jpg">
<meta property="article:published_time" content="2022-05-21T10:21:16.000Z">
<meta property="article:modified_time" content="2022-11-15T08:48:02.770Z">
<meta property="article:author" content="XiaoWanğŸ’¦">
<meta property="article:tag" content="OpenWRT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jsd.cdn.zzko.cn/gh/xiaowansm5/img@master/ecy/982257.1hk8iymuua80.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.wwang.pw/post/openwrt-docs"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//static.cloudflareinsights.com"/><link rel="preconnect" href="//www.clarity.ms"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5cd98a826aa91c5ceefdb92e614872a9";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script defer="defer" data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;b03745f1bc834e2db65a965fb30269de&quot;}"></script><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "dnxvoye4c3");</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-15 16:48:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/hexo-footer.css"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"Jzooi0OoETnhEN6K",ck:"Jzooi0OoETnhEN6K"})</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiper.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiperstyle.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://jsd.cdn.zzko.cn/gh/xiaowansm5/img@master/æ—¶å…‰.54dv9r8g4dk0.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">118</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">106</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fas fa-list"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ä»“åº“</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://pan.wwang.pw"><i class="fa-fw fa fa-cloud"></i><span> å›ºä»¶ä»“åº“</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://pan.xiaowansm.repl.co/"><i class="fa-fw fa fa-cloud-download"></i><span> å›ºä»¶ä»“åº“[åˆ†æµç«™]</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://p.wwang.pw"><i class="fa-fw fa-fw fab fa-google-drive"></i><span> èµ„æºåº“</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-screwdriver-wrench"></i><span> å·¥å…·</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://wwang.pw/mi"><i class="fa-fw fa-solid fa-lock"></i><span> å°ç±³SSHå¯†ç è®¡ç®—</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://git.xwsm.tk/"><i class="fa-fw fa-brands fa-github"></i><span> GitHubæ–‡ä»¶åŠ é€Ÿ</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://u.xwsm.tk/"><i class="fa-fw fa-solid fa-arrow-up-short-wide"></i><span> ç¼©çŸ­ç½‘å€</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://sub.fasts.eu.org/"><i class="fa-fw fa-solid fa-rocket"></i><span> è®¢é˜…è½¬æ¢</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://api.xiaowansm.repl.co"><i class="fa-fw fa-solid fa-image"></i><span> éšæœºå›¾api</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://xiaow.pages.dev/lab"><i class="fa-fw fa fa-cog"></i><span> å®éªŒå®¤</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fas fa-wave-square"></i><span> æ›´å¤š</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/List/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fa fa-list-alt"></i><span> å•é¡µ</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%80%92%E8%AE%A1%E6%97%B6/"><i class="fa-fw fa-fw far fa-clock"></i><span> å€’è®¡æ—¶</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97/"><i class="fa-fw fa-fw fas fa-gamepad"></i><span> ä¿„ç½—æ–¯æ–¹å—</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E6%97%B6%E9%92%9F/"><i class="fa-fw fa-fw fas fa-clock"></i><span> æ—¶é’Ÿ</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%88%9D%E9%9F%B3%E6%9C%AA%E6%9D%A5/"><i class="fa-fw fa-fw fab fa-studiovinari"></i><span> åˆéŸ³æœªæ¥</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%B0%8F%E5%9C%86%E7%82%B9/"><i class="fa-fw fa-fw far fa-dot-circle"></i><span> å°åœ†ç‚¹</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E6%B6%B2%E4%BD%93/"><i class="fa-fw fa-fw fab fa-google-wallet"></i><span> æ¶²ä½“</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/home/"><i class="fa-fw fa-fw fas fa-infinity faa-tada animated"></i><span> ç½‘å€æ”¶è—</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E6%97%B6%E5%85%89%E6%90%9C%E7%B4%A2/"><i class="fa-fw fa-solid fa-magnifying-glass"></i><span> æ—¶å…‰æœç´¢</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%9B%BE%E7%89%87%E5%8A%A0%E6%B0%B4%E5%8D%B0/"><i class="fa-fw fa-regular fa-image"></i><span> å›¾ç‰‡åŠ æ°´å°</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%8A%A8%E6%80%81%E7%99%BD%E4%BA%91/"><i class="fa-fw fa fa-cloud"></i><span> åŠ¨æ€ç™½äº‘</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%9B%BE%E7%89%87%E8%87%AA%E9%80%82%E5%BA%94UI%E6%A8%A1%E6%9D%BF/"><i class="fa-fw fa-brands fa-uikit"></i><span> å›¾ç‰‡è‡ªé€‚åº”UI</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%9C%A8%E7%BA%BF%E7%94%BB%E6%9D%BF/"><i class="fa-fw fa fa-sign-language"></i><span> åœ¨çº¿ç”»æ¿</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/Onlinemusic/"><i class="fa-fw fa fas fa-music"></i><span> åœ¨çº¿éŸ³ä¹</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">æ—¶å…‰'s Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fas fa-list"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ä»“åº“</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://pan.wwang.pw"><i class="fa-fw fa fa-cloud"></i><span> å›ºä»¶ä»“åº“</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://pan.xiaowansm.repl.co/"><i class="fa-fw fa fa-cloud-download"></i><span> å›ºä»¶ä»“åº“[åˆ†æµç«™]</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://p.wwang.pw"><i class="fa-fw fa-fw fab fa-google-drive"></i><span> èµ„æºåº“</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-screwdriver-wrench"></i><span> å·¥å…·</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://wwang.pw/mi"><i class="fa-fw fa-solid fa-lock"></i><span> å°ç±³SSHå¯†ç è®¡ç®—</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://git.xwsm.tk/"><i class="fa-fw fa-brands fa-github"></i><span> GitHubæ–‡ä»¶åŠ é€Ÿ</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://u.xwsm.tk/"><i class="fa-fw fa-solid fa-arrow-up-short-wide"></i><span> ç¼©çŸ­ç½‘å€</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://sub.fasts.eu.org/"><i class="fa-fw fa-solid fa-rocket"></i><span> è®¢é˜…è½¬æ¢</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://api.xiaowansm.repl.co"><i class="fa-fw fa-solid fa-image"></i><span> éšæœºå›¾api</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://xiaow.pages.dev/lab"><i class="fa-fw fa fa-cog"></i><span> å®éªŒå®¤</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fas fa-wave-square"></i><span> æ›´å¤š</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/List/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fa fa-list-alt"></i><span> å•é¡µ</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%80%92%E8%AE%A1%E6%97%B6/"><i class="fa-fw fa-fw far fa-clock"></i><span> å€’è®¡æ—¶</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97/"><i class="fa-fw fa-fw fas fa-gamepad"></i><span> ä¿„ç½—æ–¯æ–¹å—</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E6%97%B6%E9%92%9F/"><i class="fa-fw fa-fw fas fa-clock"></i><span> æ—¶é’Ÿ</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%88%9D%E9%9F%B3%E6%9C%AA%E6%9D%A5/"><i class="fa-fw fa-fw fab fa-studiovinari"></i><span> åˆéŸ³æœªæ¥</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%B0%8F%E5%9C%86%E7%82%B9/"><i class="fa-fw fa-fw far fa-dot-circle"></i><span> å°åœ†ç‚¹</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E6%B6%B2%E4%BD%93/"><i class="fa-fw fa-fw fab fa-google-wallet"></i><span> æ¶²ä½“</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/home/"><i class="fa-fw fa-fw fas fa-infinity faa-tada animated"></i><span> ç½‘å€æ”¶è—</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E6%97%B6%E5%85%89%E6%90%9C%E7%B4%A2/"><i class="fa-fw fa-solid fa-magnifying-glass"></i><span> æ—¶å…‰æœç´¢</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%9B%BE%E7%89%87%E5%8A%A0%E6%B0%B4%E5%8D%B0/"><i class="fa-fw fa-regular fa-image"></i><span> å›¾ç‰‡åŠ æ°´å°</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%8A%A8%E6%80%81%E7%99%BD%E4%BA%91/"><i class="fa-fw fa fa-cloud"></i><span> åŠ¨æ€ç™½äº‘</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%9B%BE%E7%89%87%E8%87%AA%E9%80%82%E5%BA%94UI%E6%A8%A1%E6%9D%BF/"><i class="fa-fw fa-brands fa-uikit"></i><span> å›¾ç‰‡è‡ªé€‚åº”UI</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/home/%E5%9C%A8%E7%BA%BF%E7%94%BB%E6%9D%BF/"><i class="fa-fw fa fa-sign-language"></i><span> åœ¨çº¿ç”»æ¿</span></a></li><li><a class="site-page child" href="https://blog.wwang.pw/Onlinemusic/"><i class="fa-fw fa fas fa-music"></i><span> åœ¨çº¿éŸ³ä¹</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-05-21T10:21:16.000Z" title="å‘è¡¨äº 2022-05-21 18:21:16">2022-05-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-11-15T08:48:02.770Z" title="æ›´æ–°äº 2022-11-15 16:48:02">2022-11-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/openwrt/">openwrt</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">13.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>58åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title="OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="twikoo_visitors"></span></span></div></div></div><article class="post-content" id="article-container"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†"><a href="#OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†" class="headerlink" title="OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†"></a>OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†</h1><h1 id="1-OpenWRTè™šæ‹Ÿç³»ç»Ÿå‡†å¤‡"><a href="#1-OpenWRTè™šæ‹Ÿç³»ç»Ÿå‡†å¤‡" class="headerlink" title="1.OpenWRTè™šæ‹Ÿç³»ç»Ÿå‡†å¤‡"></a>1.OpenWRTè™šæ‹Ÿç³»ç»Ÿå‡†å¤‡</h1><p>ç¯å¢ƒï¼š</p>
<p>ç¼–è¯‘æœåŠ¡å™¨ï¼šUbuntu-14.04-desktop</p>
<p>è™šæ‹Ÿæœºè½¯ä»¶ï¼šVMWare-10.0</p>
<p>ç¼–è¯‘ç¯å¢ƒå‡†å¤‡ï¼šapt-get install subversion build-essential libncurses5-dev zlib1g-dev gawk git ccache gettext libssl-dev xsltproc flex gcc-multilib</p>
<h2 id="1-1-ç¼–è¯‘openwrtè™šæ‹Ÿæœºç³»ç»Ÿ"><a href="#1-1-ç¼–è¯‘openwrtè™šæ‹Ÿæœºç³»ç»Ÿ" class="headerlink" title="1.1.ç¼–è¯‘openwrtè™šæ‹Ÿæœºç³»ç»Ÿ"></a>1.1.ç¼–è¯‘openwrtè™šæ‹Ÿæœºç³»ç»Ÿ</h2><h3 id="1-1-1-å‡†å¤‡æºç "><a href="#1-1-1-å‡†å¤‡æºç " class="headerlink" title="1.1.1 å‡†å¤‡æºç "></a>1.1.1 å‡†å¤‡æºç </h3><p>#cd &#x2F;home&#x2F;nickli&#x2F;</p>
<p>#mkdir openwrt_SDK</p>
<p>#cd openwrt_SDK</p>
<p>#svn checkout</p>
<p>svn:&#x2F;&#x2F;svn.openwrt.org&#x2F;openwrt&#x2F;branches&#x2F;barrier_breaker</p>
<h3 id="1-1-2-å‡†å¤‡æºç åŒ…"><a href="#1-1-2-å‡†å¤‡æºç åŒ…" class="headerlink" title="1.1.2 å‡†å¤‡æºç åŒ…"></a>1.1.2 å‡†å¤‡æºç åŒ…</h3><p>#cd barrier_breaker</p>
<p>#mkdir dl</p>
<p>#cp -r &#x2F;home&#x2F;public&#x2F;openwrt_dl&#x2F;* .&#x2F;dl&#x2F;</p>
<p>ä¹‹å‰å·²ç»å°†å‡ ä¹æ‰€æœ‰çš„ç¼–è¯‘æ—¶éœ€è¦ä¸‹è½½çš„æºç åŒ…ä¸‹è½½åˆ°äº†&#x2F;home&#x2F;public&#x2F;openwrt_dl ç›®å½•ä¸‹ï¼Œæ‰€ä»¥ä¸ºå‡å°‘ç¼–è¯‘æ—¶é—´ç›´æ¥å°†è¯¥ç›®å½•é“¾æ¥åˆ°æ–°çš„SDKä¸­ã€‚</p>
<h3 id="1-1-3-ç¼–è¯‘é…ç½®"><a href="#1-1-3-ç¼–è¯‘é…ç½®" class="headerlink" title="1.1.3 ç¼–è¯‘é…ç½®"></a>1.1.3 ç¼–è¯‘é…ç½®</h3><p>#make defconfig</p>
<p>#make prereq</p>
<p>#make menuconfig  &#x2F;&#x2F;é…ç½®ç³»ç»Ÿç¼–è¯‘é€‰å•æ—¶éœ€æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>ç³»ç»Ÿç›®æ ‡å¹³å°é€‰æ‹©ä¸ºx86</li>
<li>ç›®æ ‡æ–‡ä»¶ä¸ºè™šæ‹Ÿæœºæ–‡ä»¶***.vmdk</li>
<li>é€‰æ‹©cåº“(uClibc&#x2F;eglibc&#x2F;glibcâ€¦â€¦)</li>
<li>é…ç½®ç³»ç»Ÿæ‰€éœ€çš„åŸºæœ¬é…ç½®æ¯”å¦‚adduser&#x2F;addgroup&#x2F;suç­‰å‘½ä»¤ï¼ˆbasesystem&#x2F;busyboxï¼‰</li>
</ul>
<p>é€€å‡ºé…ç½®å•å¹¶ä¿å­˜ã€‚</p>
<h3 id="1-1-4-ç¼–è¯‘"><a href="#1-1-4-ç¼–è¯‘" class="headerlink" title="1.1.4 ç¼–è¯‘"></a>1.1.4 ç¼–è¯‘</h3><p>#make V&#x3D;99</p>
<p>å®Œæˆä»¥åé•œåƒæ–‡ä»¶â€œopenwrt-x86-generic-combined-squashfs.vmdkâ€å­˜åœ¨äºbin&#x2F;x86&#x2F;ç›®å½•ä¸‹,å°†è¯¥æ–‡ä»¶æ‹·è´åˆ°windowsä¸‹å¦‚F:&#x2F;template&#x2F;ä¸‹ã€‚</p>
<h2 id="1-2-å®‰è£…è™šæ‹Ÿæœº"><a href="#1-2-å®‰è£…è™šæ‹Ÿæœº" class="headerlink" title="1.2.å®‰è£…è™šæ‹Ÿæœº"></a>1.2.å®‰è£…è™šæ‹Ÿæœº</h2><h3 id="1-2-1-æ–°å»ºè™šæ‹Ÿæœº"><a href="#1-2-1-æ–°å»ºè™šæ‹Ÿæœº" class="headerlink" title="1.2.1.æ–°å»ºè™šæ‹Ÿæœº"></a>1.2.1.æ–°å»ºè™šæ‹Ÿæœº</h3><p>ä¸‹ä¸€æ­¥</p>
<p>é€‰æ‹©ç¨åå®‰è£…æ“ä½œç³»ç»Ÿ</p>
<p>å®¢æˆ·åŠæ“ä½œç³»ç»Ÿé€‰æ‹©Linuxï¼Œç‰ˆæœ¬é€‰æ‹©â€œå…¶ä»–Linux 2.6.xå†…æ ¸â€</p>
<p>ä¸ºè™šæ‹Ÿæœºå‘½åï¼Œå¹¶é€‰æ‹©ä¹‹å‰é•œåƒå­˜æ”¾çš„è·¯å¾„ä½œä¸ºè™šæ‹Ÿæœºå­˜æ”¾è·¯å¾„</p>
<p>ç‚¹å‡»ç»§ç»­</p>
<p>Cpu&#x2F;memoryç­‰ä¿¡æ¯ä¿æŒé»˜è®¤ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥å³å¯ï¼š</p>
<p>å†…å­˜é€‰æ‹©512è¶³å¤Ÿäº†ï¼š</p>
<p>é€‰æ‹©æ¡¥æ¥ï¼š</p>
<p>ä¿æŒé»˜è®¤ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥</p>
<p>é€‰æ‹©ç¡¬ç›˜ç±»å‹ä¸ºIDE:</p>
<p>åˆ›å»ºæ–°ç£ç›˜ï¼š</p>
<p>è®¾ç½®ç£ç›˜å¤§å°10Gï¼š</p>
<p>ç„¶åä¸€è·¯é»˜è®¤ï¼Œç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ç›´åˆ°ç»“æŸã€‚</p>
<h3 id="1-2-2-ä¿®æ”¹è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶ï¼š"><a href="#1-2-2-ä¿®æ”¹è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶ï¼š" class="headerlink" title="1.2.2.ä¿®æ”¹è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶ï¼š"></a>1.2.2.ä¿®æ”¹è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶ï¼š</h3><p>è¿›å…¥ä»¥ä¸Šæ”¾ç½®è™šæ‹Ÿæœºçš„ç›®å½•ï¼Œå¹¶æ‰¾åç¼€ä¸ºvmxçš„æ–‡ä»¶ï¼Œä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œå°†ä»¥ä¸‹é€”ä¸­è¡¨ç¤ºçš„è™šæ‹Ÿæœºåå­—ä¿®æ”¹æˆç¬¬ä¸€æ­¥ä¸­ç¼–è¯‘å‡ºæ¥ï¼Œä¿å­˜åœ¨æœ¬åœ°çš„é‚£ä¸ªç³»ç»Ÿé•œåƒåç§°ï¼š</p>
<p>ä¿®æ”¹å®Œæˆåä¿å­˜é€€å‡ºã€‚</p>
<p>åœ¨vmwareä¸­å¯åŠ¨åˆšåˆšæ–°å»ºçš„è™šæ‹Ÿæœºâ€œsmartRouter_4x4â€</p>
<h1 id="2-é…ç½®ä½¿ç”¨"><a href="#2-é…ç½®ä½¿ç”¨" class="headerlink" title="2.é…ç½®ä½¿ç”¨"></a>2.é…ç½®ä½¿ç”¨</h1><h2 id="2-1-è®¾ç½®rootå¯†ç "><a href="#2-1-è®¾ç½®rootå¯†ç " class="headerlink" title="2.1.è®¾ç½®rootå¯†ç "></a>2.1.è®¾ç½®rootå¯†ç </h2><p>#passwd</p>
<p>ä¸¤æ¬¡è¾“å…¥å¯†ç å³å¯</p>
<p>é‡å¯ç³»ç»Ÿå³å¯</p>
<h2 id="2-2-ç½‘ç»œé…ç½®"><a href="#2-2-ç½‘ç»œé…ç½®" class="headerlink" title="2.2.ç½‘ç»œé…ç½®"></a>2.2.ç½‘ç»œé…ç½®</h2><p>#vi &#x2F;etc&#x2F;config&#x2F;network</p>
<p>ä¿å­˜é€€å‡ºï¼Œåé‡å¯ç½‘ç»œï¼š</p>
<p>#&#x2F;etc&#x2F;init.d&#x2F;network restart</p>
<p>#ifconfig  br-lan</p>
<p>ä»¥ä¸Šçº¢è‰²æ ‡æ³¨å¤„æ˜¾ç¤ºä¿®æ”¹æˆåŠŸã€‚</p>
<h2 id="2-3-å…³äºssh"><a href="#2-3-å…³äºssh" class="headerlink" title="2.3.å…³äºssh"></a>2.3.å…³äºssh</h2><p>OpenWrt ä¸­é»˜è®¤è‡ªå¸¦çš„ SSH æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ˜¯ Dropbear</p>
<p>ä½¿ç”¨sshä»£ç†æ–¹æ³•ï¼Œå®ç°è‡ªåŠ¨ç™»å½•sshï¼Œç±»ä¼¼äºconvirtèŠ‚ç‚¹ç®¡ç†æ–¹æ³•ï¼š</p>
<p><a target="_blank" rel="noopener" href="http://talk.withme.me/?p=210#codesyntax_1">http://talk.withme.me/?p=210#codesyntax_1</a></p>
<h1 id="3-è½¯ä»¶å®‰è£…æ–¹æ³•"><a href="#3-è½¯ä»¶å®‰è£…æ–¹æ³•" class="headerlink" title="3.è½¯ä»¶å®‰è£…æ–¹æ³•"></a>3.è½¯ä»¶å®‰è£…æ–¹æ³•</h1><h2 id="3-1-æœ¬åœ°å®‰è£…ipkè½¯ä»¶åŒ…"><a href="#3-1-æœ¬åœ°å®‰è£…ipkè½¯ä»¶åŒ…" class="headerlink" title="3.1.æœ¬åœ°å®‰è£…ipkè½¯ä»¶åŒ…"></a>3.1.æœ¬åœ°å®‰è£…ipkè½¯ä»¶åŒ…</h2><p>ä½¿ç”¨å‘½ä»¤:opkg install softwall.ipk</p>
<p>ä¾‹å¦‚ï¼šå®‰è£…sftp</p>
<p>é¦–å…ˆä¸‹è½½è½¯ä»¶ï¼š</p>
<p>#cd &#x2F;root</p>
<p>#wget <a target="_blank" rel="noopener" href="http://downloads.openwrt.org/backfire/10.03.1/x86_generic/packages/openssh-sftp-server_5.8p2-2_x86.ipk">http://downloads.openwrt.org/backfire/10.03.1/x86_generic/packages/openssh-sftp-server_5.8p2-2_x86.ipk</a></p>
<p># opkg install openssh-sftp-server_5.8p2-2_x86.ipk</p>
<p>Installing openssh-sftp-server (5.8p2-2) to rootâ€¦</p>
<p>Configuring openssh-sftp-server.</p>
<h2 id="3-2-åœ¨çº¿å®‰è£…è½¯ä»¶åŠè®¾ç½®"><a href="#3-2-åœ¨çº¿å®‰è£…è½¯ä»¶åŠè®¾ç½®" class="headerlink" title="3.2.åœ¨çº¿å®‰è£…è½¯ä»¶åŠè®¾ç½®"></a>3.2.åœ¨çº¿å®‰è£…è½¯ä»¶åŠè®¾ç½®</h2><h3 id="3-2-1-è®¾ç½®è½¯ä»¶æº"><a href="#3-2-1-è®¾ç½®è½¯ä»¶æº" class="headerlink" title="3.2.1.è®¾ç½®è½¯ä»¶æº"></a>3.2.1.è®¾ç½®è½¯ä»¶æº</h3><p>#vim &#x2F;etc&#x2F;opkg.conf</p>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<p>dest root &#x2F;</p>
<p>dest ram &#x2F;tmp</p>
<p>lists_dir ext &#x2F;var&#x2F;opkg-lists</p>
<p>option overlay_root &#x2F;overlay</p>
<p>src&#x2F;gz barrier_breaker_base <a target="_blank" rel="noopener" href="http://downloads.openwrt.org/barrier_breaker/14.07/x86/generic/packages/base">http://downloads.openwrt.org/barrier_breaker/14.07/x86/generic/packages/base</a></p>
<p>æœ€åä¸€è¡Œurlä¸ºå®é™…å¯ä»¥ä¸‹è½½åˆ°ipkçš„åœ°å€ï¼Œé…ç½®å¥½åæ‰èƒ½ä½¿ç”¨åœ¨çº¿å®‰è£…åŠŸèƒ½ã€‚</p>
<h3 id="3-2-2-å®‰è£…è½¯ä»¶"><a href="#3-2-2-å®‰è£…è½¯ä»¶" class="headerlink" title="3.2.2.å®‰è£…è½¯ä»¶"></a>3.2.2.å®‰è£…è½¯ä»¶</h3><p>æ›´æ–°å¯ç”¨ipkè½¯ä»¶åŒ…åˆ—è¡¨ï¼š</p>
<p>#opkg update</p>
<p>æŸ¥çœ‹æ‰€æœ‰ipkåŒ…åˆ—è¡¨ï¼š</p>
<p>#opkg list</p>
<p>#opkg install software.ipkg</p>
<p>å®‰è£…è½¯ä»¶ï¼š</p>
<p>#opkg install software.ipk</p>
<h3 id="3-2-3-ç›´æ¥å®‰è£…"><a href="#3-2-3-ç›´æ¥å®‰è£…" class="headerlink" title="3.2.3.ç›´æ¥å®‰è£…"></a>3.2.3.ç›´æ¥å®‰è£…</h3><p>åœ¨3.1èŠ‚ä¸­ï¼Œæè¿°çš„å®‰è£…æœ¬åœ°è½¯ä»¶ï¼Œå®é™…ä¸Šæ˜¯å…ˆwgetä¸‹è½½ä¸€ä¸ªè½¯ä»¶åˆ°æœ¬åœ°ï¼Œç„¶åå†æ‰§è¡Œæœ¬åœ°å®‰è£…ï¼Œå®é™…ä¸Šå¯ä»¥ç›´æ¥ä½¿ç”¨opkg install URLçš„æ–¹å¼åœ¨çº¿å®‰è£…ã€‚å¦‚ä¸‹ï¼š</p>
<p>#opkg install <a target="_blank" rel="noopener" href="http://downloads.openwrt.org/backfire/10.03.1/x86_generic/packages/openssh-sftp-server_5.8p2-2_x86.ipk">http://downloads.openwrt.org/backfire/10.03.1/x86_generic/packages/openssh-sftp-server_5.8p2-2_x86.ipk</a></p>
<h2 id="3-3-ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨åšè½¯ä»¶æºä»¥å®‰è£…è‡ªå®šä¹‰è½¯ä»¶"><a href="#3-3-ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨åšè½¯ä»¶æºä»¥å®‰è£…è‡ªå®šä¹‰è½¯ä»¶" class="headerlink" title="3.3.ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨åšè½¯ä»¶æºä»¥å®‰è£…è‡ªå®šä¹‰è½¯ä»¶"></a>3.3.ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨åšè½¯ä»¶æºä»¥å®‰è£…è‡ªå®šä¹‰è½¯ä»¶</h2><p>å®‰è£…æœ¬åœ°è½¯ä»¶æœ‰ä¸¤ç§æ–¹æ³•ï¼šä¸€ç§æ˜¯å°†æœ¬åœ°è½¯ä»¶scpåˆ°openwrtç³»ç»Ÿä¸­ï¼Œé€šè¿‡opkgå®‰è£…å³å¯ï¼›ç¬¬äºŒç§å°±æ˜¯åœ¨æœ¬åœ°æœåŠ¡å™¨ä¸Šæ­å»ºä¸€ä¸ªftpæœåŠ¡å™¨ï¼Œ ç„¶ååœ¨openwrtç³»ç»Ÿè½¯ä»¶æºä¸­æ·»åŠ è¯¥æœåŠ¡å™¨çš„urlï¼Œç„¶åé€šè¿‡åœ¨çº¿å®‰è£…çš„æ–¹å¼å®‰è£…æœ¬åœ°æœåŠ¡å™¨ä¸Šåˆ¶ä½œçš„IpkåŒ…ã€‚ç°å°±ç¬¬äºŒç§æ–¹å¼åšä»‹ç»ã€‚</p>
<h3 id="3-3-1-åœ¨ç¼–è¯‘æœåŠ¡å™¨ä¸Šé…ç½®vsftpæœåŠ¡å™¨"><a href="#3-3-1-åœ¨ç¼–è¯‘æœåŠ¡å™¨ä¸Šé…ç½®vsftpæœåŠ¡å™¨" class="headerlink" title="3.3.1.åœ¨ç¼–è¯‘æœåŠ¡å™¨ä¸Šé…ç½®vsftpæœåŠ¡å™¨"></a>3.3.1.åœ¨ç¼–è¯‘æœåŠ¡å™¨ä¸Šé…ç½®vsftpæœåŠ¡å™¨</h3><p>2.11å®‰è£…ftpæœåŠ¡å™¨</p>
<p>#sudo apt-get install vsftpd</p>
<p># sudo gedit &#x2F;etc&#x2F;vsftpd.conf</p>
<p>åŸæ–‡ä»¶ä¸­ä¸å°‘æŒ‡ä»¤è¢«æ³¨é‡Šï¼Œåªè¦å¯ç”¨éƒ¨åˆ†å³å¯ï¼Œä¸€ä¸‹æ˜¯å¯ç”¨çš„å‘½ä»¤ï¼ˆé…ç½®æ–‡ä»¶ä¸­å¯¹æ¯ä¸€æ¡éƒ½æœ‰å…·ä½“è¯´æ˜ï¼‰</p>
<p>listen&#x3D;YES    # æœåŠ¡å™¨ç›‘å¬</p>
<p>anonymous_enable&#x3D;YES    # åŒ¿åè®¿é—®å…è®¸</p>
<p>local_enable&#x3D;YES  # æœ¬åœ°ä¸»æœºè®¿é—®å…è®¸</p>
<p>write_enable&#x3D;YES  # å†™å…è®¸</p>
<p>anon_upload_enable&#x3D;YES</p>
<p># åŒ¿åä¸Šä¼ å…è®¸ï¼Œé»˜è®¤æ˜¯NOï¼Œå«Œéº»çƒ¦çš„å¯ä»¥å¼€èµ·æ¥ã€‚å‡ºäº†é—®é¢˜æˆ‘ä¸è´Ÿè´£ï½</p>
<p>anon_mkdir_write_enable&#x3D;YES # åŒ¿ååˆ›å»ºæ–‡ä»¶å¤¹å…è®¸</p>
<p>dirmessage_enable&#x3D;YES # è¿›å…¥æ–‡ä»¶å¤¹å…è®¸</p>
<p>xferlog_enable&#x3D;YES  # ftp æ—¥å¿—è®°å½•å…è®¸</p>
<p>connect_from_port_20&#x3D;YES   # å…è®¸ä½¿ç”¨20å·ç«¯å£ä½œä¸ºæ•°æ®ä¼ é€çš„ç«¯å£</p>
<p>secure_chroot_dir&#x3D;&#x2F;var&#x2F;run&#x2F;vsftpd&#x2F;empty</p>
<p>pam_service_name&#x3D;vsftpd</p>
<p>rsa_cert_file&#x3D;&#x2F;etc&#x2F;ssl&#x2F;private&#x2F;vsftpd.pem</p>
<p>ä¿å­˜ã€‚</p>
<p>åˆ›å»ºåŒ¿åè®¿é—®ç›®å½•ä»¥ä¾›openwrtè®¿é—®</p>
<p>#mkdir &#x2F;srv&#x2F;ftp</p>
<p>ä¿®æ”¹ftpç›®å½•æƒé™ï¼š</p>
<p>#chmod 755 &#x2F;srv&#x2F;ftp</p>
<p>åˆ›å»ºupload downloadç›®å½•</p>
<p>#mkdir â€“p â€“m 777 &#x2F;srv&#x2F;ftp&#x2F;upload</p>
<p>#mkdir â€“p â€“m 755 &#x2F;srv&#x2F;ftp&#x2F;download</p>
<p>é‡å¯vsftpd</p>
<p>#service vsftpd restart</p>
<p>ç„¶åå°†&#x2F;home&#x2F;nickli&#x2F;openwrt_SDK&#x2F;barrier_breaker&#x2F;bin&#x2F;x86&#x2F;packages ç›®å½•ä¸‹æ‰€æœ‰çš„å†…å®¹éƒ½æ‹·è´åˆ°&#x2F;srv&#x2F;ftp&#x2F;downloadç›®å½•ä¸‹ï¼š</p>
<p>#scp -r &#x2F;home&#x2F;nickli&#x2F;openwrt_SDK&#x2F;barrier_breaker&#x2F;bin&#x2F;x86&#x2F;packages &#x2F;srv&#x2F;ftp&#x2F;download&#x2F;</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªç”¨æˆ·çš„å®¶ç›®å½•ä¼šè‡ªåŠ¨åšä¸ºvsftpæœåŠ¡çš„æ ¹ç›®å½•ã€‚ä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨ç”¨æˆ·Açš„æƒé™æ¥è®¿é—®è¯¥ftpæœåŠ¡å™¨æ—¶ï¼Œå…¶ç™»å½•åˆ°çš„ftpæ ¹ç›®å½•å°±æ˜¯è¯¥ç”¨æˆ·Aåœ¨è¯¥ftpæœåŠ¡å™¨å¯„å­˜çš„è¿™å°ä¸»æœºä¸Šè‡ªå·±çš„homeç›®å½•ã€‚</p>
<p>æœ¬æ–‡æ¡£åˆ¶ä½œæ—¶æœåŠ¡å™¨IPä¸º10.8.3.50çš„ubuntu-14.04ç³»ç»Ÿï¼ŒOpenWRTçš„SDKåœ¨&#x2F;home&#x2F;nickli &#x2F;openwrt_SDK&#x2F;barrier_breakerç›®å½•ä¸‹ã€‚ç¼–è¯‘å‡ºæ¥çš„æ‰€æœ‰æˆæœåœ¨è¯¥ç›®å½•çš„binç›®å½•ä¸‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ç¼–è¯‘å‡ºçš„packagesä½œä¸º æœ€ç»ˆçš„è½¯ä»¶æºã€‚</p>
<h3 id="3-3-2-ä¿®æ”¹openwrtåœ¨çº¿å®‰è£…è½¯ä»¶æº"><a href="#3-3-2-ä¿®æ”¹openwrtåœ¨çº¿å®‰è£…è½¯ä»¶æº" class="headerlink" title="3.3.2.ä¿®æ”¹openwrtåœ¨çº¿å®‰è£…è½¯ä»¶æº"></a>3.3.2.ä¿®æ”¹openwrtåœ¨çº¿å®‰è£…è½¯ä»¶æº</h3><p>openwrtç«¯ä¿®æ”¹opkg.confï¼Œæ·»åŠ ftpæœåŠ¡å™¨ipkåŒ…å­˜åœ¨åœ°å€ï¼Œæ³¨é‡Šæ‰ç³»ç»Ÿé»˜è®¤çš„urlåœ°å€å¦‚ä¸‹çº¢è‰²æ ‡æ³¨ï¼Œå¹¶æ·»åŠ ç»¿è‰²æ ‡æ³¨çš„æ–‡å­—ï¼š</p>
<p>src&#x2F;gz barrier_breaker_base <a href="ftp://10.8.3.50/download/packages/base">ftp://10.8.3.50/download/packages/base</a></p>
<p>(æˆ–è€…src&#x2F;gz packages <a href="ftp://10.8.3.50/download/packages/base">ftp://10.8.3.50/download/packages/base</a>)</p>
<p>dest root &#x2F;</p>
<p>dest ram &#x2F;tmp</p>
<p>lists_dir ext &#x2F;var&#x2F;opkg-lists</p>
<p>option overlay_root &#x2F;overlay</p>
<p>#src&#x2F;gz barrier_breaker_base <a target="_blank" rel="noopener" href="http://downloads.openwrt.org/barrier_breaker/14.07/x86/generic/packages/base">http://downloads.openwrt.org/barrier_breaker/14.07/x86/generic/packages/base</a></p>
<h3 id="3-3-3æ›´æ–°opkg"><a href="#3-3-3æ›´æ–°opkg" class="headerlink" title="3.3.3æ›´æ–°opkg"></a>3.3.3æ›´æ–°opkg</h3><p>#opkg update</p>
<p>è‹¥æ— é”™è¯¯æç¤ºï¼Œåˆ™è¡¨ç¤ºå¯ä»¥æ­£å¸¸ä½¿ç”¨opkgä»ftpä¸‹è½½ipkåŒ…äº†ã€‚</p>
<h3 id="3-3-3-é€šè¿‡å‘½ä»¤å®‰è£…ipkè½¯ä»¶"><a href="#3-3-3-é€šè¿‡å‘½ä»¤å®‰è£…ipkè½¯ä»¶" class="headerlink" title="3.3.3.é€šè¿‡å‘½ä»¤å®‰è£…ipkè½¯ä»¶"></a>3.3.3.é€šè¿‡å‘½ä»¤å®‰è£…ipkè½¯ä»¶</h3><p>#opkg install software.ipk</p>
<h1 id="4-openwrt-SDKæºç ç›®å½•ç»“æ„"><a href="#4-openwrt-SDKæºç ç›®å½•ç»“æ„" class="headerlink" title="4.openwrt SDKæºç ç›®å½•ç»“æ„"></a>4.openwrt SDKæºç ç›®å½•ç»“æ„</h1><h2 id="4-1-æºç ä¸‹è½½"><a href="#4-1-æºç ä¸‹è½½" class="headerlink" title="4.1.æºç ä¸‹è½½"></a>4.1.æºç ä¸‹è½½</h2><p>OpenWrtçš„æºä»£ç ç®¡ç†é»˜è®¤ç”¨çš„æ˜¯SVNä¸‹è½½ï¼š</p>
<p>svn co svn:&#x2F;&#x2F;svn.openwrt.org&#x2F;openwrt&#x2F;trunk&#x2F; .</p>
<p>è¿˜å¯ä»¥ç”¨Gitä¸‹è½½ï¼š</p>
<p>git clone git:&#x2F;&#x2F;git.openwrt.org&#x2F;openwrt.git</p>
<p>git clone git:&#x2F;&#x2F;git.openwrt.org&#x2F;packages.git</p>
<p>å‚è€ƒæ–¹æ³•ï¼š<a target="_blank" rel="noopener" href="https://dev.openwrt.org/wiki/GetSource">https://dev.openwrt.org/wiki/GetSource</a></p>
<h2 id="4-2-OpenWRTçš„feeds"><a href="#4-2-OpenWRTçš„feeds" class="headerlink" title="4.2.OpenWRTçš„feeds"></a>4.2.OpenWRTçš„feeds</h2><p>åŒ…æ‹¬ï¼š</p>
<p>packages â€“ æä¾›ä¼—å¤šåº“, å·¥å…·ç­‰åŸºæœ¬åŠŸèƒ½. ä¹Ÿæ˜¯å…¶ä»–feedæ‰€ä¾èµ–çš„è½¯ä»¶æº, å› æ­¤åœ¨å®‰è£…å…¶ä»–feedå‰ä¸€å®šè¦å…ˆå®‰è£…packages!</p>
<p>luci â€“ OpenWrté»˜è®¤çš„GUI(WEBç®¡ç†ç•Œé¢).</p>
<p>xwrt â€“ å¦ä¸€ç§å¯æ›¿æ¢LuCIçš„GUI</p>
<p>qpe â€“ DreamBoxç»´æŠ¤çš„åŸºäºQtçš„å›¾å½¢ç•Œé¢, åŒ…å«Qt2, Qt4, Qtopia, OPIE, SMPlayerç­‰ä¼—å¤šå›¾å½¢ç•Œé¢.</p>
<p>device â€“ DreamBoxç»´æŠ¤ä¸ç¡¬ä»¶å¯†åˆ‡ç›¸å…³çš„è½¯ä»¶, å¦‚uboot, qemuç­‰.</p>
<p>dreambox_packages â€“ DreamBoxç»´æŠ¤çš„å›½å†…å¸¸ç”¨ç½‘ç»œå·¥å…·, å¦‚oh3c, njit8021xclientç­‰.</p>
<p>desktop â€“ OpenWrtç”¨äºæ¡Œé¢çš„ä¸€äº›è½¯ä»¶åŒ….</p>
<p>xfce â€“ åŸºäºXorgçš„è‘—åè½»é‡çº§æ¡Œé¢ç¯å¢ƒ. Xfceå»ºåŸºåœ¨GTK+2.xä¹‹ä¸Š, å®ƒä½¿ç”¨Xfwmä½œä¸ºçª—å£ç®¡ç†å™¨.</p>
<p>efl â€“ é’ˆå¯¹enlightenment.</p>
<p>phone -é’ˆå¯¹fso, paroli.</p>
<p>trunkä¸­é»˜è®¤çš„feedsä¸‹è½½æœ‰packagesã€xwrtã€luciã€routingã€telephonyã€‚å¦‚è¦ä¸‹è½½å…¶ä»–çš„è½¯ä»¶åŒ…ï¼Œéœ€æ‰“å¼€æºç æ ¹ç›®å½•ä¸‹é¢çš„feeds.conf.defaultæ–‡ä»¶ï¼Œå»æ‰ç›¸åº”è½¯ä»¶åŒ…å‰é¢çš„#å·ï¼Œç„¶åæ›´æ–°æº:</p>
<p>.&#x2F;scripts&#x2F;feeds update -a</p>
<p>å®‰è£…ä¸‹è½½å¥½çš„åŒ…:</p>
<p>.&#x2F;scripts&#x2F;feeds install -a</p>
<h2 id="4-3-OpenWrtæºç ç›®å½•ç»“æ„"><a href="#4-3-OpenWrtæºç ç›®å½•ç»“æ„" class="headerlink" title="4.3.OpenWrtæºç ç›®å½•ç»“æ„"></a>4.3.OpenWrtæºç ç›®å½•ç»“æ„</h2><p><strong>tools</strong>å’Œ<strong>toolchain</strong>ç›®å½•ï¼šåŒ…å«äº†ä¸€äº›é€šç”¨å‘½ä»¤, ç”¨æ¥ç”Ÿæˆå›ºä»¶, ç¼–è¯‘å™¨, å’ŒCåº“.</p>
<p><strong>build dir&#x2F;host</strong>ç›®å½•ï¼šæ˜¯ä¸€ä¸ªä¸´æ—¶ç›®å½•, ç”¨æ¥å‚¨å­˜ä¸ä¾èµ–äºç›®æ ‡å¹³å°çš„å·¥å…·.</p>
<p><strong>build dir&#x2F;toolchain</strong>-ç›®å½•ï¼šç”¨æ¥å‚¨å­˜ä¾èµ–äºæŒ‡å®šå¹³å°çš„ç¼–è¯‘é“¾. åªæ˜¯ç¼–è¯‘æ–‡ä»¶å­˜æ”¾ç›®å½•æ— éœ€ä¿®æ”¹.</p>
<p><strong>build dir&#x2F;target</strong>-ç›®å½•ï¼šç”¨æ¥å‚¨å­˜ä¾èµ–äºæŒ‡å®šå¹³å°çš„è½¯ä»¶åŒ…çš„ç¼–è¯‘æ–‡ä»¶, å…¶ä¸­åŒ…æ‹¬linuxå†…æ ¸, u-boot, packages, åªæ˜¯ç¼–è¯‘æ–‡ä»¶å­˜æ”¾ç›®å½•æ— éœ€ä¿®æ”¹.</p>
<p><strong>staging_dir</strong>ç›®å½•ï¼šæ˜¯ç¼–è¯‘ç›®æ ‡çš„æœ€ç»ˆå®‰è£…ä½ç½®, å…¶ä¸­åŒ…æ‹¬rootfs, package, toolchain.</p>
<p><strong>package</strong>ç›®å½•ï¼šè½¯ä»¶åŒ…çš„ä¸‹è½½ç¼–è¯‘è§„åˆ™, åœ¨OpenWrtå›ºä»¶ä¸­, å‡ ä¹æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯.ipk, è¿™æ ·å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„å®‰è£…å’Œå¸è½½.</p>
<p><strong>target</strong>ç›®å½•ï¼šç›®æ ‡ç³»ç»ŸæŒ‡åµŒå…¥å¼è®¾å¤‡, é’ˆå¯¹ä¸åŒçš„å¹³å°æœ‰ä¸åŒçš„ç‰¹æ€§, é’ˆå¯¹è¿™äº›ç‰¹æ€§, â€œtarget&#x2F;linuxâ€ç›®å½•ä¸‹æŒ‰ç…§å¹³å°è¿›è¡Œç›®å½•åˆ’åˆ†, é‡Œé¢åŒ…æ‹¬äº†é’ˆå¯¹æ ‡å‡†å†…æ ¸çš„è¡¥ä¸, ç‰¹æ®Šé…ç½®ç­‰.</p>
<p><strong>bin</strong>ç›®å½•ï¼šç¼–è¯‘å®ŒOpenWrtçš„äºŒè¿›åˆ¶æ–‡ä»¶ç”Ÿæˆç›®å½•, å…¶ä¸­åŒ…æ‹¬sdk, uImage, u-boot, dts, rootfsæ„å»ºä¸€ä¸ªåµŒå…¥å¼ç³»ç»Ÿå®Œæ•´çš„äºŒè¿›åˆ¶æ–‡ä»¶.</p>
<p><strong>config</strong>ç›®å½•ï¼šå­˜æ”¾ç€æ•´ä¸ªç³»ç»Ÿçš„çš„é…ç½®æ–‡ä»¶.</p>
<p><strong>docs</strong>ç›®å½•ï¼šé‡Œé¢ä¸æ–­åŒ…å«äº†æ•´ä¸ªå®¿ä¸»æœºçš„æ–‡ä»¶æºç çš„ä»‹ç», é‡Œé¢è¿˜æœ‰Makefileä¸ºç›®æ ‡ç³»ç»Ÿç”Ÿæˆdocs.</p>
<p><strong>include</strong>ç›®å½•ï¼šé‡Œé¢åŒ…æ‹¬äº†æ•´ä¸ªç³»ç»Ÿçš„ç¼–è¯‘éœ€è¦çš„å¤´æ–‡ä»¶, ä½†æ˜¯æ˜¯ä»¥Makeè¿›è¡Œè¿æ¥çš„.</p>
<p><strong>feeds</strong>ç›®å½•ï¼šæ‰©å±•è½¯ä»¶åŒ…ç´¢å¼•ç›®å½•.</p>
<p><strong>scripts</strong>ç›®å½•ï¼šç»„ç»‡ç¼–è¯‘æ•´ä¸ªOpenWrtçš„è§„åˆ™.</p>
<p><strong>tmp</strong>ç›®å½•ï¼šç¼–è¯‘æ–‡ä»¶å¤¹, ä¸€èˆ¬æƒ…å†µä¸ºç©º.</p>
<p><strong>dl</strong>ç›®å½•ï¼šæ‰€æœ‰è½¯ä»¶çš„ä¸‹è½½ç›®å½•, åŒ…æ‹¬u-boot, kernel.</p>
<p><strong>logs</strong>ç›®å½•ï¼šå¦‚æœç¼–è¯‘å‡ºé”™, å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ç¼–è¯‘å‡ºé”™çš„log.</p>
<h2 id="4-4-åŸºæœ¬å‘½ä»¤ä»‹ç»"><a href="#4-4-åŸºæœ¬å‘½ä»¤ä»‹ç»" class="headerlink" title="4.4.åŸºæœ¬å‘½ä»¤ä»‹ç»"></a>4.4.åŸºæœ¬å‘½ä»¤ä»‹ç»</h2><p>#.&#x2F;scripts&#x2F;feeds update -a</p>
<p>#.&#x2F;scripts&#x2F;feeds install -a</p>
<p>#make prereq &#x2F;&#x2F;è¯¥å‘½ä»¤å¯ä»¥æ£€æŸ¥SDKä¸­targetå†…æ˜¯å¦æœ‰å­˜åœ¨é”™è¯¯çš„Makefileã€‚</p>
<p>#make defconfig</p>
<p>#make menuconfig</p>
<p>#make kernel_config</p>
<p>#make V&#x3D;99</p>
<p>#make package&#x2F;pacakge_name&#x2F;{clean,prepare,compile,install} V&#x3D;99</p>
<h1 id="5-ç”¨æˆ·å±‚æ¨¡å—å¼€å‘æ–¹æ³•"><a href="#5-ç”¨æˆ·å±‚æ¨¡å—å¼€å‘æ–¹æ³•" class="headerlink" title="5.ç”¨æˆ·å±‚æ¨¡å—å¼€å‘æ–¹æ³•"></a>5.ç”¨æˆ·å±‚æ¨¡å—å¼€å‘æ–¹æ³•</h1><h2 id="5-1-SDKå‡†å¤‡"><a href="#5-1-SDKå‡†å¤‡" class="headerlink" title="5.1.SDKå‡†å¤‡"></a>5.1.SDKå‡†å¤‡</h2><p>è¯·å‚è€ƒï¼š4.1å°èŠ‚å†…å®¹ã€‚</p>
<h2 id="5-2-æ·»åŠ æ¨¡å—ä»£ç "><a href="#5-2-æ·»åŠ æ¨¡å—ä»£ç " class="headerlink" title="5.2.æ·»åŠ æ¨¡å—ä»£ç "></a>5.2.æ·»åŠ æ¨¡å—ä»£ç </h2><p>ä¾‹å¦‚æ·»åŠ æ¨¡å—åå­—åŠ helloï¼Œå…¶ç›®å½•æ ‘å¦‚ä¸‹ï¼š</p>
<p>hello</p>
<p>â”œâ”€â”€ files   â€”â€”â€”â€”â€”â€”â€”â€“æ–‡ä»¶å¤¹ï¼šå­˜æ”¾æ–‡ä»¶å¦‚ï¼šæœåŠ¡é…ç½®æ–‡ä»¶&#x2F;å¯åŠ¨è„šæœ¬ç­‰</p>
<p>â”œâ”€â”€ Makefile â€”â€”â€”â€”â€”â€”â€”â€”æ–‡ä»¶ï¼šæ‰“åŒ…ç›¸å…³çš„Makefile</p>
<p>â””â”€â”€ src   â€”â€”â€”â€”â€”â€”â€”â€“æ–‡ä»¶å¤¹ï¼šå­˜æ”¾æ¨¡å—æºç æ–‡ä»¶</p>
<p>â”œâ”€â”€ hello.c â€”â€”â€”â€”â€”â€”â€”æ–‡ä»¶ï¼šæºä»£ç </p>
<p>â””â”€â”€ Makefile â€”â€”â€”â€”â€”â€”æ–‡ä»¶ï¼šæºç ç¼–è¯‘ç”¨çš„Makefile</p>
<h2 id="5-3-æ¨¡å—ç¨‹åºæºä»£ç "><a href="#5-3-æ¨¡å—ç¨‹åºæºä»£ç " class="headerlink" title="5.3.æ¨¡å—ç¨‹åºæºä»£ç "></a>5.3.æ¨¡å—ç¨‹åºæºä»£ç </h2><p>#include&lt;stdio.h&gt;</p>
<p>int main ()</p>
<p>{</p>
<p>printf(â€œhello world!\nâ€);</p>
<p>return 0;</p>
<p>}</p>
<h2 id="5-4-æºç ç¼–è¯‘Makefile"><a href="#5-4-æºç ç¼–è¯‘Makefile" class="headerlink" title="5.4.æºç ç¼–è¯‘Makefile"></a>5.4.æºç ç¼–è¯‘Makefile</h2><p>hello:hello.o</p>
<p>$(CC) -o $@ $^</p>
<p>hello.o:hello.c</p>
<p>$(CC) -c $&lt;</p>
<p>clean:</p>
<p>rm -rf *.o hello</p>
<h2 id="5-5-ipKåŒ…åˆ¶ä½œè§„åˆ™Makefile"><a href="#5-5-ipKåŒ…åˆ¶ä½œè§„åˆ™Makefile" class="headerlink" title="5.5.ipKåŒ…åˆ¶ä½œè§„åˆ™Makefile"></a>5.5.ipKåŒ…åˆ¶ä½œè§„åˆ™Makefile</h2><p>#</p>
<p># Copyright (C) 2006-2010 OpenWrt.org</p>
<p>#</p>
<p># This is free software, licensed under the GNU General Public License v2.</p>
<p># See &#x2F;LICENSE for more information.</p>
<p>#</p>
<p>include $(TOPDIR)&#x2F;rules.mk</p>
<p>PKG_NAME:&#x3D;hello</p>
<p>PKG_VERSION:&#x3D;1.0</p>
<p>PKG_RELEASE:&#x3D;1.0</p>
<p>PKG_BUILD_DIR :&#x3D; $(BUILD_DIR)&#x2F;$(PKG_NAME)</p>
<p>include $(INCLUDE_DIR)&#x2F;package.mk</p>
<p>define Package&#x2F;hello</p>
<p>SECTION:&#x3D;libs</p>
<p>CATEGORY:&#x3D;Libraries</p>
<p>TITLE:&#x3D;hello</p>
<p>endef</p>
<p>define Build&#x2F;Prepare</p>
<p>mkdir -p $(PKG_BUILD_DIR)</p>
<p>$(CP) .&#x2F;src&#x2F;* $(PKG_BUILD_DIR)&#x2F;</p>
<p>endef</p>
<p>define Package&#x2F;hello&#x2F;description</p>
<p>the hello is the base utils of the skysoftâ€™s smartrouter</p>
<p>endef</p>
<p>define Package&#x2F;hello&#x2F;install</p>
<p>$(INSTALL_DIR) $(1)&#x2F;usr&#x2F;lib&#x2F;</p>
<p>$(CP) $(PKG_BUILD_DIR)&#x2F;hello.so* $(1)&#x2F;usr&#x2F;lib&#x2F;</p>
<p>endef</p>
<p>$(eval $(call BuildPackage,hello))</p>
<p><strong>æ³¨æ„ä»¥ä¸Šçº¢è‰²æ ‡æ³¨éƒ¨åˆ†æ–‡å­—é¡»ä¿æŒä¸€è‡´ã€‚</strong></p>
<h2 id="5-6-ç¼–è¯‘æ¨¡å—"><a href="#5-6-ç¼–è¯‘æ¨¡å—" class="headerlink" title="5.6.ç¼–è¯‘æ¨¡å—"></a>5.6.ç¼–è¯‘æ¨¡å—</h2><p>$ make package&#x2F;libs&#x2F;hello&#x2F;compile V&#x3D;99</p>
<p>$ make package&#x2F;libs&#x2F;hello&#x2F;clean</p>
<p>$ make package&#x2F;skysoft_web_admin&#x2F;{clean,prepare,compile} V&#x3D;99</p>
<h2 id="5-7-ipkåŒ…åˆ¶ä½œ"><a href="#5-7-ipkåŒ…åˆ¶ä½œ" class="headerlink" title="5.7.ipkåŒ…åˆ¶ä½œ"></a>5.7.ipkåŒ…åˆ¶ä½œ</h2><p>åŠ å…¥installåä¼šå°†ç¼–è¯‘ç»“æœæ‰“åŒ…å®‰è£…åˆ°SDKç›®å½•ä¸‹binç›®å½•ä¸‹ç›¸åº”ä½ç½®ã€‚</p>
<p>$ make package&#x2F;skysoft_web_admin&#x2F;{clean,prepare,compile,install} V&#x3D;99</p>
<h2 id="5-8-å®‰è£…æµ‹è¯•"><a href="#5-8-å®‰è£…æµ‹è¯•" class="headerlink" title="5.8.å®‰è£…æµ‹è¯•"></a>5.8.å®‰è£…æµ‹è¯•</h2><p>ç¼–è¯‘å®Œæˆååœ¨SDKç›®å½•ä¸‹çš„&#x2F;bin&#x2F;x86&#x2F;package&#x2F;baseæ–‡ä»¶å¤¹ä¸‹å›æœ‰hello*.ipkæ–‡ä»¶ï¼Œå°†bin&#x2F;x86&#x2F;package æ•´ä¸ªç›®å½•æ‹·è´åˆ°ftpä¸‹è½½ç›®å½•&#x2F;srv&#x2F;ftp&#x2F;download&#x2F;ä¸‹ï¼Œé‡‡ç”¨åœ¨openwrtåœ¨çº¿å®‰è£…çš„æ–¹å¼ï¼Œæˆ–è€…ç›´æ¥è¿œç¨‹æ‹·è´åˆ°ç›®æ ‡openwrtç³»ç»Ÿ ä¸­å®‰è£…ã€‚</p>
<h1 id="6-å†…æ ¸æ¨¡å—å¼€å‘æ–¹æ³•"><a href="#6-å†…æ ¸æ¨¡å—å¼€å‘æ–¹æ³•" class="headerlink" title="6.å†…æ ¸æ¨¡å—å¼€å‘æ–¹æ³•"></a>6.å†…æ ¸æ¨¡å—å¼€å‘æ–¹æ³•</h1><p>OpenWrtå¼€å‘å†…æ ¸é©±åŠ¨æœ‰å¤šç§æ–¹å¼ï¼Œå‰é¢è®²åˆ°çš„åˆ¶ä½œå†…æ ¸è¡¥ä¸ä¹Ÿæ˜¯ä¸€ç§å¼€å‘æ–¹æ³•ã€‚è¿™é‡Œä»‹ç»ç›´æ¥åœ¨OpenWrtç³»ç»Ÿä¸Šå¼€å‘å†…æ ¸é©±åŠ¨ï¼ŒæŠŠå†…æ ¸é©±åŠ¨åšæˆipkè½¯ä»¶åŒ…çš„å½¢å¼ã€‚</p>
<h2 id="6-1-å»ºç«‹å·¥ä½œç›®å½•"><a href="#6-1-å»ºç«‹å·¥ä½œç›®å½•" class="headerlink" title="6.1.å»ºç«‹å·¥ä½œç›®å½•"></a>6.1.å»ºç«‹å·¥ä½œç›®å½•</h2><p><strong>$cd openwrt&#x2F;trunk&#x2F;package</strong></p>
<p><strong>$mkdir example</strong></p>
<h2 id="6-2-è¿›å…¥exampleç›®å½•ï¼Œåˆ›å»ºMakefileæ–‡ä»¶å’Œä»£ç è·¯å¾„"><a href="#6-2-è¿›å…¥exampleç›®å½•ï¼Œåˆ›å»ºMakefileæ–‡ä»¶å’Œä»£ç è·¯å¾„" class="headerlink" title="6.2.è¿›å…¥exampleç›®å½•ï¼Œåˆ›å»ºMakefileæ–‡ä»¶å’Œä»£ç è·¯å¾„"></a>6.2.è¿›å…¥exampleç›®å½•ï¼Œåˆ›å»ºMakefileæ–‡ä»¶å’Œä»£ç è·¯å¾„</h2><p><strong>$cd example</strong></p>
<p><strong>$mkdir src</strong></p>
<p><strong>$vim Makefile</strong></p>
<p><strong>æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</strong></p>
<p><strong># Kernel module example</strong></p>
<p><strong>include $(TOPDIR)&#x2F;rules.mk</strong></p>
<p><strong>include $(INCLUDE_DIR)&#x2F;kernel.mk</strong></p>
<p><strong>PKG_NAME:&#x3D;example</strong></p>
<p><strong>PKG_RELEASE:&#x3D;1</strong></p>
<p><strong>include $(INCLUDE_DIR)&#x2F;package.mk</strong></p>
<p><strong>define KernelPackage&#x2F;example</strong></p>
<p>ã€€ã€€<strong>SUBMENU:&#x3D;Other modules</strong></p>
<p>ã€€ã€€<strong>DEPENDS:&#x3D;@TARGET_octeon</strong></p>
<p>ã€€ã€€<strong>TITLE:&#x3D;Support Module for example</strong></p>
<p>ã€€ã€€<strong>AUTOLOAD:&#x3D;$(call AutoLoad,81,example)</strong></p>
<p>ã€€ã€€<strong>FILES:&#x3D;$(PKG_BUILD_DIR)&#x2F;example&#x2F;example.$(LINUX_KMOD_SUFFIX)</strong></p>
<p><strong>endef</strong></p>
<p><strong>define Build&#x2F;Prepare</strong></p>
<p>ã€€ã€€<strong>mkdir -p $(PKG_BUILD_DIR)</strong></p>
<p>ã€€ã€€<strong>$(CP) -R .&#x2F;src&#x2F;* $(PKG_BUILD_DIR)&#x2F;</strong></p>
<p><strong>endef</strong></p>
<p><strong>define Build&#x2F;Compile</strong></p>
<p>ã€€ã€€**$(MAKE) -C â€œ$(LINUX_DIR)â€ **</p>
<p>ã€€ã€€ã€€ã€€*<em>CROSS_COMPILE&#x3D;â€$(TARGET_CROSS)â€ *</em></p>
<p>ã€€ã€€ã€€ã€€*<em>ARCH&#x3D;â€$(LINUX_KARCH)â€ *</em></p>
<p>ã€€ã€€ã€€ã€€*<em>SUBDIRS&#x3D;â€$(PKG_BUILD_DIR)&#x2F;exampleâ€ *</em></p>
<p>ã€€ã€€ã€€ã€€*<em>EXTRA_CFLAGS&#x3D;â€-g $(BUILDFLAGS)â€ *</em></p>
<p>ã€€ã€€ã€€ã€€<strong>modules</strong></p>
<p><strong>endef</strong></p>
<p><strong>$(eval $(call KernelPackage,example))</strong></p>
<p>æ³¨é‡Šï¼šAUTOLOADï¼šå®šä¹‰äº†å†…æ ¸æ¨¡å—å¼€æœºè‡ªåŠ¨æŒ‚è½½çš„åŠ¨ä½œï¼Œ$(call AutoLoad,81,example)ï¼Œè¡¨ç¤ºå½“ç³»ç»Ÿå¯åŠ¨æ—¶åå«â€œexampleâ€çš„å†…æ ¸æ¨¡å—ä¼šåœ¨é¡ºåºä¸ºç¬¬81çš„ä½ç½®åŠ è½½åˆ°ç³»ç»Ÿä¸­ï¼Œä¸å¿…æ¯æ¬¡å¯åŠ¨ç³»ç»Ÿå æ‰‹åŠ¨çš„å»insmodåŠ è½½æ¨¡å—ã€‚å¦‚æœæ­£å¸¸ï¼Œæœ¬æ¨¡å—ipkåŒ…åˆ¶ä½œå¥½å¹¶å®‰è£…åˆ°ç›®æ ‡ç³»ç»Ÿä¸­åï¼Œä¼šåœ¨ç›®æ ‡ç³»ç»Ÿçš„&#x2F;etc&#x2F;modules.d&#x2F;ç›®å½•ä¸‹åˆ›å»ºä¸€ä»½åå« 81-exampleçš„åŠ è½½åºåˆ—æ–‡ä»¶ï¼Œå…¶å†…å®¹ä¸ºexampleã€‚è€Œæœ¬ipkå®‰è£…åä¼šåœ¨&#x2F;lib&#x2F;moudules&#x2F;$(KERNEL-VERSION) &#x2F;ç›®å½•ä¸‹æ”¾ç½®example.koæ–‡ä»¶ã€‚è€Œå¦‚æœæœ¬è½¯ä»¶åŒ…åŒ…å«äº†å¤šä¸ªå†…æ ¸æ¨¡å—æ–‡ä»¶ï¼Œæ¯”å¦‚å¤šä¸ªâ€œ.koâ€æ–‡ä»¶ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªä½ç½®å°±è¦åŠ å…¥å¤šä¸ªæ¨¡å—åï¼Œæ¨¡å—åä¹‹é—´ ä»¥â€œç©ºæ ¼â€éš”å¼€ï¼Œå¦‚ä¸‹ä¾‹ï¼š </p>
<p><strong>define KernelPackage&#x2F;exfat</strong></p>
<p> <strong>SUBMENU:&#x3D;Other modules</strong></p>
<p> <strong>TITLE:&#x3D;exfat driver</strong></p>
<p> <strong>DEPENDS:&#x3D;+kmod-nls-base @BUILD_PATENTED</strong></p>
<p> <strong>FILES:&#x3D;$(PKG_BUILD_DIR)&#x2F;*.$(LINUX_KMOD_SUFFIX)</strong></p>
<p> <strong>AUTOLOAD:&#x3D;$(call AutoLoad,82,exfat_core exfat_fs)</strong></p>
<p> <strong>KCONFIG:&#x3D;</strong></p>
<p><strong>endef</strong></p>
<p>å®šä¹‰çš„æ¨¡å—åç§°ä¸ºexfatï¼Œå…¶å†…éƒ¨æœ‰ä¸¤ä¸ªå†…æ ¸æ–‡ä»¶éœ€è¦æ·»åŠ ï¼Œåˆ†åˆ«ä¸ºexfat_core.ko,exfat_fs.koã€‚</p>
<h2 id="6-3-è¿›å…¥srcç›®å½•ï¼Œåˆ›å»ºä»£ç è·¯å¾„å’Œç›¸å…³æºæ–‡ä»¶"><a href="#6-3-è¿›å…¥srcç›®å½•ï¼Œåˆ›å»ºä»£ç è·¯å¾„å’Œç›¸å…³æºæ–‡ä»¶" class="headerlink" title="6.3.è¿›å…¥srcç›®å½•ï¼Œåˆ›å»ºä»£ç è·¯å¾„å’Œç›¸å…³æºæ–‡ä»¶"></a>6.3.è¿›å…¥srcç›®å½•ï¼Œåˆ›å»ºä»£ç è·¯å¾„å’Œç›¸å…³æºæ–‡ä»¶</h2><p><strong>$cd src</strong></p>
<p><strong>$mkdir example</strong></p>
<p><strong>$cd example</strong></p>
<p><strong>$vim example.c</strong></p>
<p><strong>ç¼–è¾‘å†…å®¹å¦‚ä¸‹ï¼š</strong></p>
<p><strong>#include &lt;linux&#x2F;init.h&gt;</strong></p>
<p><strong>#include &lt;linux&#x2F;module.h&gt;</strong></p>
<p><strong>#include &lt;linux&#x2F;kernel.h&gt;</strong></p>
<p><strong>&#x2F;* hello_init â€”-</strong> <strong>åˆå§‹åŒ–å‡½æ•°ï¼Œå½“æ¨¡å—è£…è½½æ—¶è¢«è°ƒç”¨ï¼Œå¦‚æœæˆåŠŸè£…è½½è¿”å›0</strong> <strong>å¦åˆ™è¿”å›é0****å€¼ *&#x2F;</strong></p>
<p><strong>static int __init hello_init(void)</strong></p>
<p><strong>{</strong></p>
<p>ã€€ã€€ã€€<strong>printk(â€œI bear a charmed life.\nâ€);</strong></p>
<p>ã€€ã€€ã€€<strong>return 0;</strong></p>
<p><strong>}</strong></p>
<p><strong>&#x2F; * hello_exit â€”-</strong> <strong>é€€å‡ºå‡½æ•°ï¼Œå½“æ¨¡å—å¸è½½æ—¶è¢«è°ƒç”¨ *&#x2F;</strong></p>
<p><strong>static void __exit hello_exit(void)</strong></p>
<p><strong>{</strong></p>
<p>ã€€ã€€ã€€<strong>printk(â€œOut, out, brief candle\nâ€);</strong></p>
<p><strong>}</strong></p>
<p><strong>module_init(hello_init);</strong></p>
<p><strong>module_exit(hello_exit);</strong></p>
<p><strong>MODULE_LICENSE(â€œGPLâ€);</strong></p>
<p><strong>MODULE_AUTHOR(â€œPillar_zuoâ€);</strong></p>
<p><strong>vim Kconfig</strong></p>
<p><strong>config EXAMPLE</strong></p>
<p>ã€€ã€€<strong>tristate â€œJust a exampleâ€</strong></p>
<p>ã€€ã€€<strong>default n</strong></p>
<p>ã€€ã€€<strong>help</strong></p>
<p>ã€€ã€€ã€€<strong>This is a example, for debugging kernel model.</strong></p>
<p>ã€€ã€€ã€€<strong>If unsure, say N.</strong></p>
<p><strong>ä¿å­˜å¹¶é€€å‡ºã€‚</strong></p>
<p><strong>å¢åŠ æºç ç¼–è¯‘Makefile****ï¼š</strong></p>
<p><strong>$vim Makefile</strong></p>
<p><strong>å†…å®¹å¦‚ä¸‹ï¼š</strong></p>
<p><strong>obj-m :&#x3D; example.o</strong></p>
<h2 id="6-4-å›åˆ°OpenWrtæºç æ ¹ç›®å½•ä¸‹"><a href="#6-4-å›åˆ°OpenWrtæºç æ ¹ç›®å½•ä¸‹" class="headerlink" title="6.4.å›åˆ°OpenWrtæºç æ ¹ç›®å½•ä¸‹"></a>6.4.å›åˆ°OpenWrtæºç æ ¹ç›®å½•ä¸‹</h2><p><strong>$make menuconfig</strong></p>
<p>ã€€ã€€<strong>Kernel modules â€”&gt;</strong></p>
<p>ã€€ã€€ã€€ã€€<strong>Other modules â€”&gt;</strong></p>
<p>ã€€ã€€ã€€ã€€ã€€ã€€<strong>kmod-example</strong></p>
<p>é€‰é¡¹è®¾ç½®ä¸ºMï¼Œä¿å­˜é€€å‡º</p>
<p>ç„¶åç¼–è¯‘è¯¥æ¨¡å—ï¼š</p>
<p><strong>$make package&#x2F;example&#x2F;compile</strong></p>
<p><strong>$make package&#x2F;index</strong></p>
<h2 id="6-5-åœ¨OpenWrtç³»ç»Ÿé‡Œé¢å°±å¯ä»¥ç”¨opkgä¸‹è½½ä½¿ç”¨äº†ã€‚"><a href="#6-5-åœ¨OpenWrtç³»ç»Ÿé‡Œé¢å°±å¯ä»¥ç”¨opkgä¸‹è½½ä½¿ç”¨äº†ã€‚" class="headerlink" title="6.5.åœ¨OpenWrtç³»ç»Ÿé‡Œé¢å°±å¯ä»¥ç”¨opkgä¸‹è½½ä½¿ç”¨äº†ã€‚"></a>6.5.åœ¨OpenWrtç³»ç»Ÿé‡Œé¢å°±å¯ä»¥ç”¨opkgä¸‹è½½ä½¿ç”¨äº†ã€‚</h2><p>æ–¹æ³•å‚è€ƒç¬¬ä¸‰èŠ‚å†…å®¹ã€‚</p>
<h1 id="7-openwrt-Makefileæ¡†æ¶åˆ†æ"><a href="#7-openwrt-Makefileæ¡†æ¶åˆ†æ" class="headerlink" title="7.openwrt Makefileæ¡†æ¶åˆ†æ"></a>7.openwrt Makefileæ¡†æ¶åˆ†æ</h1><p>æœ¬èŠ‚åŸæ–‡åœ°å€ï¼š<a target="_blank" rel="noopener" href="http://www.cnblogs.com/sammei/p/3968916.html">http://www.cnblogs.com/sammei/p/3968916.html</a></p>
<p>æœ¬ç¯‡çš„ä¸»è¦ç›®çš„æ˜¯æƒ³é€šè¿‡åˆ†æMakefileï¼Œäº†è§£openwrtç¼–è¯‘è¿‡ç¨‹ã€‚ç€é‡å…³æ³¨ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>openwrt****ç›®å½•ç»“æ„</strong></li>
<li><strong>ä¸»Makefile****çš„è§£æè¿‡ç¨‹ï¼Œå„å­ç›®å½•çš„ç›®æ ‡ç”Ÿæˆ</strong></li>
<li><strong>kernel****ç¼–è¯‘è¿‡ç¨‹</strong></li>
<li><strong>firmware****çš„ç”Ÿæˆè¿‡ç¨‹</strong></li>
<li><strong>è½¯ä»¶åŒ…çš„ç¼–è¯‘è¿‡ç¨‹</strong></li>
</ul>
<h2 id="7-1-openwrtç›®å½•ç»“æ„"><a href="#7-1-openwrtç›®å½•ç»“æ„" class="headerlink" title="7.1.openwrtç›®å½•ç»“æ„"></a>7.1.openwrtç›®å½•ç»“æ„</h2><p>å®˜æ–¹æºä¸‹è½½é€Ÿåº¦å¤ªæ…¢ï¼Œæˆ‘ä»githubä¸Šcloneäº†openwrtçš„ä»£ç ä»“åº“ã€‚</p>
<p>git clone <a target="_blank" rel="noopener" href="https://github.com/openwrt-mirror/openwrt.git">https://github.com/openwrt-mirror/openwrt.git</a></p>
<p>openwrtç›®å½•ç»“æ„</p>
<p>ä¸Šå›¾æ˜¯openwrtç›®å½•ç»“æ„ï¼Œå…¶ä¸­ç¬¬ä¸€è¡Œæ˜¯åŸå§‹ç›®å½•ï¼Œç¬¬äºŒè¡Œæ˜¯ç¼–è¯‘è¿‡ç¨‹ä¸­ç”Ÿæˆçš„ç›®å½•ã€‚å„ç›®å½•çš„ä½œç”¨æ˜¯ï¼š</p>
<p><strong>tools</strong> â€“ ç¼–è¯‘æ—¶éœ€è¦ä¸€äº›å·¥å…·ï¼Œ toolsé‡ŒåŒ…å«äº†è·å–å’Œç¼–è¯‘è¿™äº›å·¥å…·çš„å‘½ä»¤ã€‚é‡Œé¢æ˜¯ä¸€äº›Makefileï¼Œæœ‰çš„å¯èƒ½è¿˜æœ‰patchã€‚æ¯ä¸ªMakefileé‡Œéƒ½æœ‰ä¸€å¥ $(eval $(call HostBuild))ï¼Œè¡¨ç¤ºç¼–è¯‘è¿™ä¸ªå·¥å…·æ˜¯ä¸ºäº†åœ¨ä¸»æœºä¸Šä½¿ç”¨çš„ã€‚</p>
<p><strong>toolchain</strong> â€“ åŒ…å«ä¸€äº›å‘½ä»¤å»è·å–kernel headers, C library, bin-utils, compiler, debugger</p>
<p><strong>target</strong> â€“ å„å¹³å°åœ¨è¿™ä¸ªç›®å½•é‡Œå®šä¹‰äº†firmwareå’Œkernelçš„ç¼–è¯‘è¿‡ç¨‹ã€‚</p>
<p><strong>package</strong> â€“ åŒ…å«é’ˆå¯¹å„ä¸ªè½¯ä»¶åŒ…çš„Makefileã€‚openwrtå®šä¹‰äº†ä¸€å¥—Makefileæ¨¡æ¿ï¼Œå„è½¯ä»¶å‚ç…§è¿™ä¸ªæ¨¡æ¿å®šä¹‰äº†è‡ªå·±çš„ä¿¡æ¯ï¼Œå¦‚è½¯ä»¶åŒ…çš„ç‰ˆæœ¬ã€ä¸‹è½½åœ°å€ã€ç¼–è¯‘æ–¹å¼ã€å®‰è£…åœ°å€ç­‰ã€‚</p>
<p><strong>include</strong> â€“ openwrtçš„Makefileéƒ½å­˜æ”¾åœ¨è¿™é‡Œã€‚</p>
<p><strong>scripts</strong> â€“ ä¸€äº›perlè„šæœ¬ï¼Œç”¨äºè½¯ä»¶åŒ…ç®¡ç†ã€‚</p>
<p><strong>dl</strong> â€“ è½¯ä»¶åŒ…ä¸‹è½½åéƒ½æ”¾åˆ°è¿™ä¸ªç›®å½•é‡Œ</p>
<p><strong>build_dir</strong> â€“ è½¯ä»¶åŒ…éƒ½è§£å‹åˆ°build_dir&#x2F;é‡Œï¼Œç„¶ååœ¨æ­¤ç¼–è¯‘</p>
<p><strong>staging_dir</strong> â€“ æœ€ç»ˆå®‰è£…ç›®å½•ã€‚tools, toolchainè¢«å®‰è£…åˆ°è¿™é‡Œï¼Œrootfsä¹Ÿä¼šæ”¾åˆ°è¿™é‡Œã€‚ä¾‹å¦‚puma_SDKä¸­æ–‡ä»¶ç³»ç»Ÿç›®å½•ä¸ºï¼š</p>
<p>&#x2F;home&#x2F;nickli&#x2F;2015-Router_N01-PUMA_4x4&#x2F;trunk&#x2F;02.DevelopementRepository&#x2F;04.Coding&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;staging_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;root-ipq806x</p>
<p><strong>feeds</strong> â€“ æ‰©å±•è½¯ä»¶åŒ…ç´¢å¼•ç›®å½•ã€‚</p>
<p><strong>bin</strong> â€“ ç¼–è¯‘å®Œæˆä¹‹åï¼Œfirmwareå’Œå„ipkä¼šæ”¾åˆ°æ­¤ç›®å½•ä¸‹ã€‚</p>
<p><strong>æ¨èé˜…è¯»å®˜æ–¹èµ„æ–™</strong>ï¼š<a target="_blank" rel="noopener" href="http://www.ccs.neu.edu/home/noubir/Courses/CS6710/S12/material/OpenWrt_Dev_Tutorial.pdf">OpenWrt Development Guide</a></p>
<p><a target="_blank" rel="noopener" href="http://www.liwangmeng.com/wp-content/uploads/2016/01/OpenWrt_Dev_Tutorial.pdf">OpenWrt_Dev_Tutorial</a></p>
<h2 id="7-2-main-Makefile"><a href="#7-2-main-Makefile" class="headerlink" title="7.2.main Makefile"></a>7.2.main Makefile</h2><p>openwrtæ ¹ç›®å½•ä¸‹çš„Makefileæ˜¯æ‰§è¡Œmakeå‘½ä»¤æ—¶çš„å…¥å£ã€‚ä»è¿™é‡Œå¼€å§‹åˆ†æã€‚</p>
<p>world:</p>
<p>ifndef ($(OPENWRT_BUILD),1)</p>
<p># ç¬¬ä¸€ä¸ªé€»è¾‘</p>
<p>â€¦</p>
<p>else</p>
<p># ç¬¬äºŒä¸ªé€»è¾‘</p>
<p>â€¦</p>
<p>endif</p>
<p>ä¸Šé¢è¿™æ®µæ˜¯ä¸»Makefileçš„ç»“æ„ï¼Œå¯ä»¥å¾—çŸ¥ï¼š</p>
<p>æ‰§è¡Œmakeæ—¶ï¼Œè‹¥æ— ä»»ä½•ç›®æ ‡æŒ‡å®šï¼Œåˆ™é»˜è®¤ç›®æ ‡æ˜¯world</p>
<p>æ‰§è¡Œmakeæ—¶ï¼Œæ— å‚æ•°æŒ‡å®šï¼Œåˆ™ä¼šè¿›å…¥ç¬¬ä¸€ä¸ªé€»è¾‘ã€‚å¦‚æœæ‰§è¡Œå‘½ä»¤make OPENWRT_BUILD&#x3D;1ï¼Œåˆ™ç›´æ¥è¿›å…¥ç¬¬äºŒä¸ªé€»è¾‘ã€‚</p>
<p>ç¼–è¯‘æ—¶ä¸€èˆ¬ç›´æ¥ä½¿ç”¨make V&#x3D;s -j5è¿™æ ·çš„å‘½ä»¤ï¼Œä¸ä¼šæŒ‡å®šOPENWRT_BUILDå˜é‡</p>
<h3 id="ç¬¬ä¸€ä¸ªé€»è¾‘"><a href="#ç¬¬ä¸€ä¸ªé€»è¾‘" class="headerlink" title="ç¬¬ä¸€ä¸ªé€»è¾‘"></a>ç¬¬ä¸€ä¸ªé€»è¾‘</h3><p>override OPENWRT_BUILD&#x3D;1</p>
<p>export OPENWRT_BUILD</p>
<p>æ›´æ”¹äº†OPENWRT_BUILDå˜é‡çš„å€¼ã€‚è¿™é‡Œèµ·åˆ°çš„ä½œç”¨æ˜¯ä¸‹æ¬¡æ‰§è¡Œmakeæ—¶ï¼Œä¼šè¿›å…¥åˆ°ç¬¬äºŒé€»è¾‘ä¸­ã€‚</p>
<p>toplevel.mkä¸­çš„ %:: è§£é‡Šworldç›®æ ‡çš„è§„åˆ™ã€‚</p>
<p>prereq:: prepare-tmpinfo .config</p>
<p>@+$(MAKE) -r -s tmp&#x2F;.prereq-build $(PREP_MK)</p>
<p>@+$(NO_TRACE_MAKE) -r -s $@</p>
<p>%::</p>
<p>@+$(PREP_MK) $(NO_TRACE_MAKE) -r -s prereq</p>
<p>@( \</p>
<p>cp .config tmp&#x2F;.config; \</p>
<p>.&#x2F;scripts&#x2F;config&#x2F;conf â€“defconfig&#x3D;tmp&#x2F;.config -w tmp&#x2F;.config Config.in &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1; \</p>
<p>if .&#x2F;scripts&#x2F;kconfig.pl â€˜&gt;â€™ .config tmp&#x2F;.config | grep -q CONFIG; then \</p>
<p>printf â€œ$(_R)WARNING: your configuration is out of sync. Please run make menuconfig, oldconfig or defconfig!$(_N)\nâ€ &gt;&amp;2; \</p>
<p>fi \</p>
<p>)</p>
<p>@+$(ULIMIT_FIX) $(SUBMAKE) -r $@</p>
<p>æ‰§è¡Œ make V&#x3D;s æ—¶ï¼Œä¸Šé¢è¿™æ®µè§„åˆ™ç®€åŒ–ä¸ºï¼š</p>
<p>prereq:: prepare-tmpinfo .config</p>
<p>@make -r -s tmp&#x2F;.prereq-build</p>
<p>@make V&#x3D;ss -r -s prereq</p>
<p>%::</p>
<p>@make V&#x3D;s -r -s prereq</p>
<p>@make -w -r world</p>
<p>å¯è§å…¶ä¸­æœ€ç»ˆåˆæ‰§è¡Œäº†prereqå’Œworldç›®æ ‡ï¼Œè¿™ä¸¤ä¸ªç›®æ ‡éƒ½ä¼šè¿›å…¥åˆ°ç¬¬äºŒé€»è¾‘ä¸­ã€‚</p>
<h3 id="ç¬¬äºŒé€»è¾‘"><a href="#ç¬¬äºŒé€»è¾‘" class="headerlink" title="ç¬¬äºŒé€»è¾‘"></a>ç¬¬äºŒé€»è¾‘</h3><p>é¦–å…ˆå°±å¼•å…¥äº†target, package, tools, toolchainè¿™å››ä¸ªå…³é”®ç›®å½•é‡Œçš„Makefileæ–‡ä»¶</p>
<p>include target&#x2F;Makefile</p>
<p>include package&#x2F;Makefile</p>
<p>include tools&#x2F;Makefile</p>
<p>include toolchain&#x2F;Makefile</p>
<p>è¿™äº›å­ç›®å½•é‡Œçš„Makefileä½¿ç”¨include&#x2F;subdir.mké‡Œå®šä¹‰çš„ä¸¤ä¸ªå‡½æ•°æ¥åŠ¨æ€ç”Ÿæˆè§„åˆ™ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°æ˜¯subdirå’Œstampfile</p>
<h3 id="stampfile"><a href="#stampfile" class="headerlink" title="stampfile"></a>stampfile</h3><p>æ‹¿target&#x2F;Makefileä¸¾ä¾‹ï¼š</p>
<p>(eval(call stampfile,$(curdir),target,prereq,.config))</p>
<p>ä¼šç”Ÿæˆè§„åˆ™ï¼š</p>
<p>target&#x2F;stamp-prereq:&#x3D;$(STAGING_DIR)&#x2F;stamp&#x2F;.target_prereq</p>
<p>$$(target&#x2F;stamp-prereq): $(TMP_DIR)&#x2F;.build .config</p>
<p>@+$(SCRIPT_DIR)&#x2F;timestamp.pl -n $$(target&#x2F;stamp-prereq) target .config || \</p>
<p>make $$(target&#x2F;flags-prereq) target&#x2F;prereq</p>
<p>@mkdir -p $$$$(dirname $$(target&#x2F;stamp-prereq))</p>
<p>@touch $$(target&#x2F;stamp-prereq)</p>
<p>$$(if $(call debug,target,v),,.SILENT: $$(target&#x2F;stamp-prereq))</p>
<p>.PRECIOUS: $$(target&#x2F;stamp-prereq) # work around a make bug</p>
<p>target&#x2F;&#x2F;clean:&#x3D;target&#x2F;stamp-prereq&#x2F;clean</p>
<p>target&#x2F;stamp-prereq&#x2F;clean: FORCE</p>
<p>@rm -f $$(target&#x2F;stamp-prereq)</p>
<p>æ‰€ä»¥å¯ä»¥ç®€å•çš„çœ‹ä½œï¼š (eval(call stampfile,(curdir),target,prereq,.config))ç”Ÿæˆäº†ç›®æ ‡(target&#x2F;stamp-prereq)</p>
<p>å¯¹äºtargetåˆ†åˆ«ç”Ÿæˆäº†ï¼š(target&#x2F;stampâˆ’preq)ï¼Œ(target&#x2F;stamp-copile)ï¼Œ $(target&#x2F;stamp-install)</p>
<p>toolchain : $(toolchain&#x2F;stamp-install)</p>
<p>package : (package&#x2F;stampâˆ’preq),(package&#x2F;stamp-cleanup), (package&#x2F;stampâˆ’compile),(package&#x2F;stamp-install)</p>
<p>tools : $(tools&#x2F;stamp-install)</p>
<p>OpenWrtçš„ä¸»Makefileå·¥ä½œè¿‡ç¨‹</p>
<p>subdir</p>
<p>subdirè¿™ä¸ªå‡½æ•°å†™äº†ä¸€å¤§å †ä¸œè¥¿ï¼Œçœ‹èµ·æ¥å¾ˆå¤æ‚ ã€‚</p>
<p>$(call subdir, target) ä¼šéå†ä¸‹çš„å­ç›®å½•ï¼Œæ‰§è¡Œ make -C æ“ä½œã€‚è¿™æ ·å°±åˆ‡å…¥å­ç›®å½•ä¸­å»äº†ã€‚</p>
<h3 id="ç›®å½•å˜é‡"><a href="#ç›®å½•å˜é‡" class="headerlink" title="ç›®å½•å˜é‡"></a>ç›®å½•å˜é‡</h3><p>å‡ ä¸ªé‡è¦çš„ç›®å½•è·¯å¾„ï¼š</p>
<p><strong>KERNEL_BUILD_DIR</strong></p>
<p>build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;linux-ramips_mt7620a&#x2F;linux-3.14.18</p>
<p><strong>LINUX_DIR</strong></p>
<p>build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;linux-ramips_mt7620a&#x2F;linux-3.14.18</p>
<p><strong>KDIR</strong></p>
<p>build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;linux-ramips_mt7620a</p>
<p><strong>BIN_DIR</strong></p>
<p>bin&#x2F;ramips</p>
<p>Makefileä¸­åŒ…å«äº†rules.mk, target.mkç­‰.mkæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¸­å®šä¹‰äº†è®¸å¤šå˜é‡ï¼Œæœ‰äº›æ˜¯è·¯å¾„ç›¸å…³çš„ï¼Œæœ‰äº›æ˜¯è½¯ä»¶ç›¸å…³çš„ã€‚è¿™äº›å˜é‡åœ¨æ•´ä¸ªMakefileå·¥ç¨‹ä¸­ç»å¸¸è¢«ç”¨åˆ°ï¼Œ</p>
<p><strong>TARGET_ROOTFS_DIR</strong></p>
<p>build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2</p>
<p><strong>BUILD_DIR</strong></p>
<p>build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2</p>
<p><strong>STAGING_DIR_HOST</strong></p>
<p>staging_dir&#x2F;toolchain-mipsel_24kec+dsp_gcc-4.8-linaro_uClibc-0.9.33.2</p>
<p><strong>TARGET_DIR</strong></p>
<p>build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;root-ramips</p>
<h2 id="7-3-kernel-ç¼–è¯‘ï¼š"><a href="#7-3-kernel-ç¼–è¯‘ï¼š" class="headerlink" title="7.3.kernel ç¼–è¯‘ï¼š"></a>7.3.kernel ç¼–è¯‘ï¼š</h2><p>target&#x2F;linux&#x2F;ramips&#x2F;Makefile: $(eval $(call BuildTarget))</p>
<p>target&#x2F;linux&#x2F;Makefile : export TARGET_BUILD&#x3D;1</p>
<p>include&#x2F;target.mk:</p>
<p>ifeq ($(TARGET_BUILD),1)</p>
<p>include $(INCLUDE_DIR)&#x2F;kernel-build.mk</p>
<p>BuildTarget?&#x3D;$(BuildKernel)</p>
<p>endif</p>
<p>BuildKernelæ˜¯include&#x2F;kernel-build.mkå®šä¹‰çš„ä¸€ä¸ªå¤šè¡Œå˜é‡ï¼Œå…¶ä¸­æè¿°äº†å¦‚ä½•ç¼–è¯‘å†…æ ¸, ä¸»è¦å…³æ³¨å…¶ä¸­installè§„åˆ™çš„ä¾èµ–é“¾ï¼š</p>
<p>$(KERNEL_BUILD_DIR)&#x2F;symtab.h: FORCE</p>
<p>rm -f $(KERNEL_BUILD_DIR)&#x2F;symtab.h</p>
<p>touch $(KERNEL_BUILD_DIR)&#x2F;symtab.h</p>
<p>+$(MAKE) $(KERNEL_MAKEOPTS) vmlinux</p>
<p>â€¦</p>
<p>$(LINUX_DIR)&#x2F;.image: $(STAMP_CONFIGURED) $(if $(CONFIG_STRIP_KERNEL_EXPORTS),$(KERNEL_BUILD_DIR)&#x2F;symtab.h) FORCE</p>
<p>$(Kernel&#x2F;CompileImage)</p>
<p>$(Kernel&#x2F;CollectDebug)</p>
<p>touch $$@</p>
<p>install: $(LINUX_DIR)&#x2F;.image</p>
<p>+$(MAKE) -C image compile install TARGET_BUILD&#x3D;</p>
<ol>
<li><p>è§¦å‘make vmlinuxå‘½ä»¤ç”Ÿæˆvmlinuxï¼š install â€“&gt; $(LINUX_DIR)&#x2F;.image â€“&gt; $(KERNEL_BUILD_DIR)&#x2F;symtab.h â€“&gt; <code>$(MAKE) $(KERNEL_MAKEOPTS) vmlinux</code></p>
</li>
<li><p>å¯¹vmlinuxåšobjcopy, stripæ“ä½œ: $(LINUX_DIR)&#x2F;.image â€“&gt; $(Kernel&#x2F;CompileImage) â€“&gt; $(call Kernel&#x2F;CompileImage&#x2F;Default) â€“&gt; $(call Kernel&#x2F;CompileImage&#x2F;Default)</p>
</li>
</ol>
<p>$(KERNEL_CROSS)objcopy -O binary $(OBJCOPY_STRIP) -S $(LINUX_DIR)&#x2F;vmlinux $(LINUX_KERNEL)$(1)</p>
<p>â€“&gt; build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;linux-ramips_mt7620a&#x2F;vmlinux</p>
<p>$(KERNEL_CROSS)objcopy $(OBJCOPY_STRIP) -S $(LINUX_DIR)&#x2F;vmlinux $(KERNEL_BUILD_DIR)&#x2F;vmlinux$(1).elf</p>
<p>â€“&gt; build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;linux-ramips_mt7620a&#x2F;vmlinux.elf</p>
<p>$(CP) $(LINUX_DIR)&#x2F;vmlinux $(KERNEL_BUILD_DIR)&#x2F;vmlinux.debug</p>
<p>â€“&gt; build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;linux-ramips_mt7620a&#x2F;vmlinux.debug</p>
<h2 id="7-4-ç”Ÿæˆfirmware"><a href="#7-4-ç”Ÿæˆfirmware" class="headerlink" title="7.4.ç”Ÿæˆfirmware"></a>7.4.ç”Ÿæˆfirmware</h2><p>firmwareç”±kernelå’Œrootfsä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼Œè¦å¯¹ä¸¤ä¸ªéƒ¨åˆ†å…ˆåˆ†åˆ«å¤„ç†ï¼Œç„¶åå†åˆå¹¶æˆä¸€ä¸ª.binæ–‡ä»¶ã€‚å…ˆçœ‹ä¸€ä¸‹è¿™ä¸ªæµç¨‹ã€‚</p>
<p>â€œtarget&#x2F;linux&#x2F;ramips&#x2F;image&#x2F;Makefileâ€ æ–‡ä»¶ä¸­çš„æœ€åä¸€å¥ï¼š$(eval $(call BuildImage))ï¼Œå°†BuildImageå±•å¼€åœ¨è¿™é‡Œã€‚BuildImageå®šä¹‰åœ¨ include&#x2F;image.mk æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­å®šä¹‰äº†æ•°ä¸ªç›®æ ‡çš„è§„åˆ™ã€‚</p>
<p>define BuildImage</p>
<p>compile: compile-targets FORCE</p>
<p><strong>$(call Build&#x2F;Compile)</strong></p>
<p>install: compile install-targets FORCE</p>
<p>â€¦</p>
<p>$(call Image&#x2F;BuildKernel) ## å¤„ç†vmlinux</p>
<p>â€¦</p>
<p>$(call Image&#x2F;mkfs&#x2F;squashfs) ## ç”Ÿæˆsquashfsï¼Œå¹¶ä¸vmlinuxåˆå¹¶æˆä¸€ä¸ª.binæ–‡ä»¶</p>
<p>â€¦</p>
<p>endef</p>
<h3 id="å¤„ç†vmlinux-Image-x2F-BuildKernel"><a href="#å¤„ç†vmlinux-Image-x2F-BuildKernel" class="headerlink" title="å¤„ç†vmlinux: Image&#x2F;BuildKernel"></a>å¤„ç†vmlinux: Image&#x2F;BuildKernel</h3><p>target&#x2F;linux&#x2F;ramips&#x2F;image&#x2F;Makefile:</p>
<p>define Image&#x2F;BuildKernel</p>
<p>cp $(KDIR)&#x2F;vmlinux.elf $(BIN_DIR)&#x2F;$(VMLINUX).elf</p>
<p>cp $(KDIR)&#x2F;vmlinux $(BIN_DIR)&#x2F;$(VMLINUX).bin</p>
<p>$(call CompressLzma,$(KDIR)&#x2F;vmlinux,$(KDIR)&#x2F;vmlinux.bin.lzma)</p>
<p>$(call MkImage,lzma,$(KDIR)&#x2F;vmlinux.bin.lzma,$(KDIR)&#x2F;uImage.lzma)</p>
<p>cp $(KDIR)&#x2F;uImage.lzma $(BIN_DIR)&#x2F;$(UIMAGE).bin</p>
<p>ifneq ($(CONFIG_TARGET_ROOTFS_INITRAMFS),)</p>
<p>cp $(KDIR)&#x2F;vmlinux-initramfs.elf $(BIN_DIR)&#x2F;$(VMLINUX)-initramfs.elf</p>
<p>cp $(KDIR)&#x2F;vmlinux-initramfs $(BIN_DIR)&#x2F;$(VMLINUX)-initramfs.bin</p>
<p>$(call CompressLzma,$(KDIR)&#x2F;vmlinux-initramfs,$(KDIR)&#x2F;vmlinux-initramfs.bin.lzma)</p>
<p>$(call MkImage,lzma,$(KDIR)&#x2F;vmlinux-initramfs.bin.lzma,$(KDIR)&#x2F;uImage-initramfs.lzma)</p>
<p>cp $(KDIR)&#x2F;uImage-initramfs.lzma $(BIN_DIR)&#x2F;$(UIMAGE)-initramfs.bin</p>
<p>endif</p>
<p>$(call Image&#x2F;Build&#x2F;Initramfs)</p>
<p>endef</p>
<h3 id="lzmaå‹ç¼©å†…æ ¸"><a href="#lzmaå‹ç¼©å†…æ ¸" class="headerlink" title="lzmaå‹ç¼©å†…æ ¸"></a>lzmaå‹ç¼©å†…æ ¸</h3><p>build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;linux-ramips_mt7620a&#x2F; ç›®å½•ä¸­:</p>
<p>lzma e vmlinux -lc1 -lp2 -pb2 vmlinux.bin.lzma</p>
<h3 id="MkImage"><a href="#MkImage" class="headerlink" title="MkImage"></a>MkImage</h3><p>build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;linux-ramips_mt7620a&#x2F; ç›®å½•ä¸­ï¼š</p>
<p>mkimage -A mips -O linux -T kernel -C lzma -a 0x80000000 -e 0x80000000 -n â€œMIPS OpenWrt Linux-3.14.18â€ -d vmlinux.bin.lzma uImage.lzma</p>
<h3 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h3><p>VMLINUX:&#x3D;$(IMG_PREFIX)-vmlinux â€“&gt; openwrt-ramips-mt7620a-vmlinux</p>
<p>UIMAGE:&#x3D;$(IMG_PREFIX)-uImage â€“&gt; openwrt-ramips-mt7620a-uImage</p>
<p>cp $(KDIR)&#x2F;uImage.lzma $(BIN_DIR)&#x2F;$(UIMAGE).bin</p>
<p>æŠŠuImage.lzmaå¤åˆ¶åˆ°bin&#x2F;ramips&#x2F;ç›®å½•ä¸‹ï¼š</p>
<p>cp $(KDIR)&#x2F;uImage.lzma bin&#x2F;ramips&#x2F;openwrt-ramips-mt7620a-uImage</p>
<h2 id="7-5-åˆ¶ä½œsquashfsï¼Œç”Ÿæˆ-bin-call-Image-x2F-mkfs-x2F-squashfs"><a href="#7-5-åˆ¶ä½œsquashfsï¼Œç”Ÿæˆ-bin-call-Image-x2F-mkfs-x2F-squashfs" class="headerlink" title="7.5.åˆ¶ä½œsquashfsï¼Œç”Ÿæˆ.bin: $(call Image&#x2F;mkfs&#x2F;squashfs)"></a>7.5.åˆ¶ä½œsquashfsï¼Œç”Ÿæˆ.bin: $(call Image&#x2F;mkfs&#x2F;squashfs)</h2><p>define Image&#x2F;mkfs&#x2F;squashfs</p>
<p>@mkdir -p $(TARGET_DIR)&#x2F;overlay</p>
<p>$(STAGING_DIR_HOST)&#x2F;bin&#x2F;mksquashfs4 $(TARGET_DIR) $(KDIR)&#x2F;root.squashfs -nopad -noappend -root-owned -comp $(SQUASHFSCOMP) $(SQUASHFSOPT) -processors $(if $(CONFIG_PKG_BUILD_JOBS),$(CONFIG_PKG_BUILD_JOBS),1)</p>
<p>$(call Image&#x2F;Build,squashfs)</p>
<p>endif</p>
<p>mkdir -p $(TARGET_DIR)&#x2F;overlay</p>
<p>mkdir -p build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;root-ramips&#x2F;overlay</p>
<p>mksquashfs4</p>
<p>$(STAGING_DIR_HOST)&#x2F;bin&#x2F;mksquashfs4 $(TARGET_DIR) $(KDIR)&#x2F;root.squashfs -nopad -noappend -root-owned -comp $(SQUASHFSCOMP) $(SQUASHFSOPT) -processors $(if $(CONFIG_PKG_BUILD_JOBS),$(CONFIG_PKG_BUILD_JOBS),1)</p>
<p>åˆ¶ä½œsquashfsæ–‡ä»¶ç³»ç»Ÿï¼Œç”Ÿæˆroot.squashfs:</p>
<p>mksquashfs4 root-ramips root.squashfs -nopad -noappend -root-owned -comp gzip -b 256k -p â€˜&#x2F;dev d 755 0 0â€™ -p â€˜&#x2F;dev&#x2F;console c 600 0 0 5 1â€™ -processors 1</p>
<p>$(call Image&#x2F;Build,squashfs)</p>
<p>åœ¨ target&#x2F;linux&#x2F;ramips&#x2F;image&#x2F;Makefile ä¸­ï¼š</p>
<p>define Image&#x2F;Build</p>
<p>$(call Image&#x2F;Build&#x2F;$(1))</p>
<p>dd if&#x3D;$(KDIR)&#x2F;root.$(1) of&#x3D;$(BIN_DIR)&#x2F;$(IMG_PREFIX)-root.$(1) bs&#x3D;128k conv&#x3D;sync</p>
<p>$(call Image&#x2F;Build&#x2F;Profile&#x2F;$(PROFILE),$(1))</p>
<p>endef</p>
<p>dd if&#x3D;(KDIR)&#x2F;root.squashfsof&#x3D;(BIN_DIR)&#x2F;$(IMG_PREFIX)-root.squashfs bs&#x3D;128k conv&#x3D;sync</p>
<p>dd if&#x3D;build_dir&#x2F;target-mipsel_24kec+dsp_uClibc-0.9.33.2&#x2F;linux-ramips_mt7620a&#x2F;root.squashfs of&#x3D;bin&#x2F;ramips&#x2F;openwrt-ramips-mt7620-root.squashfs bs&#x3D;128k conv&#x3D;sync</p>
<p>(callImage&#x2F;Build&#x2F;Profile&#x2F;(PROFILE),squashfs)</p>
<p>target&#x2F;linux&#x2F;ramips&#x2F;mt7620a&#x2F;profiles&#x2F;00-default.mk, ä¸­è°ƒç”¨ Profile å‡½æ•°ï¼š$(eval $(call Profile,Default))</p>
<p>include&#x2F;target.mk ä¸­å®šä¹‰äº† Profile å‡½æ•°ï¼Œ å…¶ä¸­ä»¤ PROFILE&#x3D;Default</p>
<p>define Image&#x2F;Build&#x2F;Profile&#x2F;Default</p>
<p>$(call Image&#x2F;Build&#x2F;Profile&#x2F;MT7620a,$(1))</p>
<p>â€¦</p>
<p>endef</p>
<p>è§„åˆ™ä¾èµ–åºåˆ—å¦‚ä¸‹ï¼š</p>
<p>$(call Image&#x2F;Build&#x2F;Profile&#x2F;$(PROFILE),squashfs)</p>
<p>â€“&gt; $(call BuildFirmware&#x2F;Default8M&#x2F;squashfs,squashfs,mt7620a,MT7620a)</p>
<p>â€“&gt; $(call BuildFirmware&#x2F;OF,squashfs,mt7620a,MT7620a,8060928)</p>
<p>â€“&gt; $(call MkImageLzmaDtb,mt7620a,MT7620a)</p>
<p>â€“&gt; $(call PatchKernelLzmaDtb,mt7620a,MT7620a)</p>
<p>â€“&gt; $(call MkImage,lzma,$(KDIR)&#x2F;vmlinux-mt7620a.bin.lzma,$(KDIR)&#x2F;vmlinux-mt7620a.uImage)</p>
<p>â€“&gt; $(call MkImageSysupgrade&#x2F;squashfs,squashfs,mt7620a,8060928)</p>
<p>å…¶ä¸­çš„ä¸»è¦æ­¥éª¤ï¼š</p>
<p>å¤åˆ¶ï¼š cp (KDIR)&#x2F;vmlinux(KDIR)&#x2F;vmlinux-mt7620a</p>
<p>ç”Ÿæˆdtbæ–‡ä»¶ï¼š (LINUXDIR)&#x2F;scripts&#x2F;dtc&#x2F;dtcâˆ’Odtbâˆ’o(KDIR)&#x2F;MT7620a.dtb ..&#x2F;dts&#x2F;MT7620a.dts</p>
<p>å°†å†…æ ¸ä¸dtbæ–‡ä»¶åˆå¹¶ï¼š(STAGINGDIRHOST)&#x2F;bin&#x2F;patchâˆ’dtb(KDIR)&#x2F;vmlinux-mt7620a $(KDIR)&#x2F;MT7620a.dtb</p>
<p>ä½¿ç”¨lzmaå‹ç¼©ï¼š(callCompressLzma,(KDIR)&#x2F;vmlinux-mt7620a,$(KDIR)&#x2F;vmlinux-mt7620a.bin.lzma)</p>
<p>å°†lzmaå‹ç¼©åçš„æ–‡ä»¶ç»è¿‡mkimageå·¥å…·å¤„ç†ï¼Œå³åœ¨å¤´éƒ¨æ·»åŠ ubootå¯è¯†åˆ«çš„ä¿¡æ¯ã€‚</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯åˆå¹¶ç”Ÿæˆfirmwareå›ºä»¶äº†ï¼š</p>
<p>MkImageSysupgrade&#x2F;squashfs, squashfs, mt7620a,8060928</p>
<p>cat vmlinux-mt7620a.uImage root.squashfs &gt; openwrt-ramips-mt7620-mt7620a-squashfs-sysupgrade.bin</p>
<p>â€“&gt; åˆ¶ä½œsquashfs binæ–‡æ¡£, å¹¶ç¡®è®¤å®ƒçš„å¤§å° &lt; 8060928 æ‰æ˜¯æœ‰æ•ˆçš„ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p>
<p>æ€»ç»“ï¼š æ•´ä¸ªæµç¨‹ä¸‹æ¥ï¼Œå…¶å®æœ€çƒ¦ç´¢çš„è¿˜æ˜¯å¯¹å†…æ ¸ç”Ÿæˆæ–‡ä»¶vmlinuxçš„æ“ä½œï¼Œç»è¿‡äº†objcopy, patch-dtb, lzma, mkimage ç­‰è¿‡ç¨‹ç”Ÿæˆä¸€ä¸ªuImageï¼Œå†ä¸mksquashfså·¥å…·åˆ¶ä½œçš„æ–‡ä»¶ç³»ç»Ÿrootfs.squashfsåˆå¹¶ã€‚</p>
<h2 id="7-6-Openwrt-SDKä¸­Makefileç›¸å…³æ€»ç»“"><a href="#7-6-Openwrt-SDKä¸­Makefileç›¸å…³æ€»ç»“" class="headerlink" title="7.6.Openwrt_SDKä¸­Makefileç›¸å…³æ€»ç»“"></a>7.6.Openwrt_SDKä¸­Makefileç›¸å…³æ€»ç»“</h2><h3 id="7-6-1CURDIRå˜é‡"><a href="#7-6-1CURDIRå˜é‡" class="headerlink" title="7.6.1CURDIRå˜é‡"></a>7.6.1CURDIRå˜é‡</h3><p>åœ¨makefileä¸­è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œæ•ˆæœç­‰åŒäºshellå‘½ä»¤pwd.</p>
<h3 id="7-6-2ç©ºæ ¼çš„è¡¨ç¤ºæ–¹æ³•ï¼š"><a href="#7-6-2ç©ºæ ¼çš„è¡¨ç¤ºæ–¹æ³•ï¼š" class="headerlink" title="7.6.2ç©ºæ ¼çš„è¡¨ç¤ºæ–¹æ³•ï¼š"></a>7.6.2ç©ºæ ¼çš„è¡¨ç¤ºæ–¹æ³•ï¼š</h3><p>empty:&#x3D;</p>
<p>space:&#x3D;$(empty) $(empty)</p>
<p>åœ¨openwrtSDKä¸­è¯¥å˜é‡ç”¨ä»¥æ£€æŸ¥SDKç›®å½•æ˜¯å¦å«æœ‰ç©ºæ ¼ï¼Œè¦æ±‚æ‰€æœ‰è·¯å¾„ä¸­ä¸å¾—æœ‰å«ç©ºæ ¼çš„æ–‡ä»¶å¤¹</p>
<h3 id="7-6-3è°ƒç”¨makefileä¸­çš„å‡½æ•°"><a href="#7-6-3è°ƒç”¨makefileä¸­çš„å‡½æ•°" class="headerlink" title="7.6.3è°ƒç”¨makefileä¸­çš„å‡½æ•°"></a>7.6.3è°ƒç”¨makefileä¸­çš„å‡½æ•°</h3><p>ifåˆ¤æ–­å‡½æ•°ï¼Œç”¨æ³•ï¼š</p>
<p>$(if <condition>,<then-part>)</p>
<p>æˆ–è€…ï¼š</p>
<p>$(if <condition>,<then-part>,<else-part>)</p>
<p>findstringæŸ¥æ‰¾å­—ç¬¦ä¸²å‡½æ•°ï¼Œç”¨æ³•ï¼š</p>
<p>$(findstring <find>,<in>)åœ¨å­—ä¸²<in>ä¸­æŸ¥æ‰¾<find>å­—ä¸²</p>
<p>erroræ§åˆ¶makefileè¿è¡Œçš„å‡½æ•°ï¼Œç”¨æ³•ï¼š</p>
<h3 id="7-6-4-å…¶ä»–ç›¸å…³å†…å®¹"><a href="#7-6-4-å…¶ä»–ç›¸å…³å†…å®¹" class="headerlink" title="7.6.4.å…¶ä»–ç›¸å…³å†…å®¹"></a>7.6.4.å…¶ä»–ç›¸å…³å†…å®¹</h3><h4 id="2-1make-çš„å‚æ•°"><a href="#2-1make-çš„å‚æ•°" class="headerlink" title="2.1make çš„å‚æ•°"></a>2.1make çš„å‚æ•°</h4><p>-i æˆ–è€…â€â€“ignore-errorsâ€:å¿½ç•¥Makefileä¸­æ‰€æœ‰çš„å‘½ä»¤é”™è¯¯ï¼›</p>
<p>-kæˆ–è€…â€œâ€“keep-goingâ€œï¼šç»ˆæ­¢å‡ºé”™å‘½ä»¤ï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶ä»–å‘½ä»¤ï¼›</p>
<p>-wæˆ–è€…â€â€“print-directoryâ€œï¼šåµŒå¥—æ‰§è¡Œmakeæ—¶ï¼Œä¼šè¾“å‡ºå½“å‰å·¥ä½œç›®å½•ä¿¡æ¯ï¼Œè¯¥é€‰é¡¹çš„åä½œç”¨é¡¹æ˜¯â€-sâ€œï¼›</p>
<h4 id="2-2åµŒå¥—æ‰§è¡Œmake"><a href="#2-2åµŒå¥—æ‰§è¡Œmake" class="headerlink" title="2.2åµŒå¥—æ‰§è¡Œmake"></a>2.2åµŒå¥—æ‰§è¡Œmake</h4><p>æˆ‘ä»¬æœ‰ä¸€ä¸ªå­ç›®å½•å« subdirï¼Œè¿™ä¸ªç›®å½•ä¸‹æœ‰ä¸ª Makefile æ–‡ä»¶ï¼Œæ¥æŒ‡æ˜äº†è¿™ä¸ªç›®å½•ä¸‹æ–‡ä»¶çš„ç¼–è¯‘è§„åˆ™ã€‚é‚£ä¹ˆæˆ‘ä»¬æ€»æ§çš„ Makefile å¯ä»¥è¿™æ ·ä¹¦å†™ï¼š</p>
<p>subsystem:</p>
<p>cd subdir &amp;&amp; $(MAKE)</p>
<p>å…¶ç­‰ä»·äºï¼š</p>
<p>subsystem:</p>
<p>$(MAKE) -C subdir</p>
<p>å®šä¹‰$(MAKE)å®å˜é‡çš„æ„æ€æ˜¯ï¼Œä¹Ÿè®¸æˆ‘ä»¬çš„ make éœ€è¦ä¸€äº›å‚æ•°ï¼Œæ‰€ä»¥å®šä¹‰æˆä¸€ä¸ªå˜é‡æ¯”è¾ƒåˆ©äºç»´æŠ¤ã€‚è¿™ä¸¤ä¸ªä¾‹å­çš„æ„æ€éƒ½æ˜¯å…ˆè¿›å…¥â€œsubdirâ€ç›®å½•ï¼Œç„¶åæ‰§è¡Œ make å‘½ä»¤ã€‚</p>
<p>æˆ‘ä»¬æŠŠè¿™ä¸ª Makefile å«åšâ€œæ€»æ§ Makefileâ€ï¼Œæ€»æ§ Makefile çš„å˜é‡å¯ä»¥ä¼ é€’åˆ°ä¸‹çº§çš„ Makefile ä¸­ï¼ˆå¦‚æœä½ æ˜¾ç¤ºçš„å£°æ˜ï¼‰ï¼Œä½†æ˜¯ä¸ä¼šè¦†ç›–ä¸‹å±‚çš„ Makefile ä¸­æ‰€å®šä¹‰çš„å˜é‡ï¼Œé™¤éæŒ‡å®šäº†â€œ-eâ€å‚æ•°ã€‚</p>
<p>å¦‚æœä½ è¦ä¼ é€’å˜é‡åˆ°ä¸‹çº§ Makefile ä¸­ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨è¿™æ ·çš„å£°æ˜ï¼š</p>
<p>export &lt;variable â€¦&gt;</p>
<p>å¦‚æœä½ ä¸æƒ³è®©æŸäº›å˜é‡ä¼ é€’åˆ°ä¸‹çº§ Makefile ä¸­ï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿™æ ·å£°æ˜ï¼š</p>
<p>unexport &lt;variable â€¦&gt;</p>
<h4 id="2-åœ¨packageç›®å½•ä¸­çš„Makefile"><a href="#2-åœ¨packageç›®å½•ä¸­çš„Makefile" class="headerlink" title="2.åœ¨packageç›®å½•ä¸­çš„Makefile:"></a>2.åœ¨packageç›®å½•ä¸­çš„Makefile:</h4><h5 id="2-1-callå‡½æ•°"><a href="#2-1-callå‡½æ•°" class="headerlink" title="2.1.callå‡½æ•°"></a>2.1.callå‡½æ•°</h5><p>call å‡½æ•°æ˜¯å”¯ä¸€ä¸€ä¸ªå¯ä»¥ç”¨æ¥åˆ›å»ºæ–°çš„å‚æ•°åŒ–çš„å‡½æ•°ã€‚ä½ å¯ä»¥å†™ä¸€ä¸ªéå¸¸å¤æ‚çš„è¡¨è¾¾å¼ï¼Œè¿™ä¸ªè¡¨è¾¾å¼ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰è®¸å¤šå‚æ•°ï¼Œç„¶åä½ å¯ä»¥ç”¨ call å‡½æ•°æ¥å‘è¿™ä¸ªè¡¨è¾¾å¼ä¼ é€’å‚æ•°ã€‚å…¶è¯­æ³•æ˜¯ï¼š</p>
<p>$(call <expression>,<parm1>,<parm2>,<parm3>â€¦)</p>
<p>å½“ make æ‰§è¡Œè¿™ä¸ªå‡½æ•°æ—¶ï¼Œ<expression>å‚æ•°ä¸­çš„å˜é‡ï¼Œå¦‚$(1)ï¼Œ$(2)ï¼Œ$(3)ç­‰ï¼Œä¼šè¢«å‚ æ•°<parm1>ï¼Œ<parm2>ï¼Œ<parm3>ä¾æ¬¡å–ä»£ã€‚è€Œ<expression>çš„è¿”å›å€¼å°±æ˜¯ call å‡½æ•°çš„è¿”å›å€¼ã€‚</p>
<h5 id="2-2-evalå‡½æ•°"><a href="#2-2-evalå‡½æ•°" class="headerlink" title="2.2.evalå‡½æ•°"></a>2.2.evalå‡½æ•°</h5><p>å‡½æ•°â€œevalâ€æ˜¯ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å‡½æ•°ã€‚ä½¿ç”¨å®ƒå¯ä»¥åœ¨Makefileä¸­æ„é€ ä¸€ä¸ªå¯å˜çš„è§„åˆ™ç»“æ„å…³ç³»ï¼ˆä¾èµ–å…³ç³»é“¾ï¼‰ï¼Œå…¶ä¸­å¯ä»¥ä½¿ç”¨å…¶å®ƒå˜é‡å’Œå‡½æ•°ã€‚</p>
<p>å‡½æ•°â€œevalâ€å¯¹å®ƒçš„å‚æ•°è¿›è¡Œå±•å¼€ï¼Œå±•å¼€çš„ç»“æœä½œä¸ºMakefileçš„ä¸€éƒ¨åˆ†ï¼Œmakeå¯ä»¥å¯¹å±•å¼€å†…å®¹è¿›è¡Œè¯­æ³•è§£æã€‚å±•å¼€çš„ç»“æœå¯ä»¥åŒ…å«ä¸€ä¸ªæ–°å˜é‡ã€ç›®æ ‡ã€éšå«è§„åˆ™æˆ–è€…æ˜¯æ˜ç¡®è§„åˆ™ç­‰ã€‚ä¹Ÿå°±æ˜¯è¯´æ­¤å‡½æ•°çš„åŠŸèƒ½ä¸»è¦æ˜¯ï¼šæ ¹æ®å…¶å‚æ•°çš„å…³ç³»ã€ç»“æ„ï¼Œå¯¹å®ƒä»¬è¿›è¡Œæ›¿æ¢å±•å¼€ã€‚</p>
<p>Ã˜    <strong>è¿”å›å€¼ï¼š</strong>å‡½æ•°â€œevalâ€çš„è¿”å›å€¼æ˜¯ç©ºï¼Œä¹Ÿå¯ä»¥è¯´æ²¡æœ‰è¿”å›å€¼ã€‚</p>
<p>Ã˜    <strong>å‡½æ•°è¯´æ˜ï¼š</strong>â€œevalâ€ å‡½æ•°æ‰§è¡Œæ—¶ä¼šå¯¹å®ƒçš„å‚æ•°è¿›è¡Œä¸¤æ¬¡å±•å¼€ã€‚ç¬¬ä¸€æ¬¡å±•å¼€è¿‡ç¨‹å‘æ˜¯ç”±å‡½æ•°æœ¬èº«å®Œæˆçš„ï¼Œç¬¬äºŒæ¬¡æ˜¯å‡½æ•°å±•å¼€åçš„ç»“æœè¢«ä½œä¸ºMakefileå†…å®¹æ—¶ç”±makeè§£ææ—¶å±•å¼€ çš„ã€‚æ˜ç¡®è¿™ä¸€è¿‡ç¨‹å¯¹äºä½¿ç”¨â€œevalâ€å‡½æ•°éå¸¸é‡è¦ã€‚ç†è§£äº†å‡½æ•°â€œevalâ€äºŒæ¬¡å±•å¼€çš„è¿‡ç¨‹åã€‚å®é™…ä½¿ç”¨æ—¶ï¼Œå¦‚æœåœ¨å‡½æ•°çš„å±•å¼€ç»“æœä¸­å­˜åœ¨å¼•ç”¨ï¼ˆæ ¼å¼ ä¸ºï¼š$(x)ï¼‰ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°çš„å‚æ•°ä¸­åº”è¯¥ä½¿ç”¨â€œ$$â€æ¥ä»£æ›¿â€œ$â€ã€‚å› ä¸ºè¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥é€šå¸¸å®ƒçš„å‚æ•°ä¸­ä¼šä½¿ç”¨å‡½æ•°â€œvalueâ€æ¥å–ä¸€ä¸ªå˜é‡çš„æ–‡æœ¬å€¼ã€‚</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ã€‚ä¾‹å­çœ‹èµ·æ¥ä¼¼ä¹éå¸¸å¤æ‚ï¼Œå› ä¸ºå®ƒç»¼åˆäº†å…¶å®ƒçš„ä¸€äº›æ¦‚å¿µå’Œå‡½æ•°ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸¤ç‚¹ï¼šå…¶ä¸€ï¼Œé€šå¸¸å®é™…ä¸€ä¸ªæ¨¡æ¿çš„å®šä¹‰å¯èƒ½æ¯”ä¾‹å­ä¸­çš„ æ›´ä¸ºå¤æ‚ï¼›å…¶äºŒï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªå¤æ‚é€šç”¨çš„æ¨¡æ¿ï¼Œåœ¨æ‰€æœ‰Makefileä¸­åŒ…å«å®ƒï¼Œäº¦å¯ä½œåˆ°ä¸€åŠ³æ°¸é€¸ã€‚ç›¸ä¿¡è¿™ä¸€ç‚¹å¯èƒ½æ˜¯å¤§å¤šæ•°ç¨‹åºå‘˜æ‰€æ¨å´‡çš„ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<p>***# sample Makefile***</p>
<p>*<strong>PROGRAMS  &#x3D; server client*</strong></p>
<p> *<strong>server_OBJS &#x3D; server.o server_priv.o server_access.o*</strong></p>
<p>*<strong>server_LIBS &#x3D; priv protocol*</strong></p>
<p>*<strong>client_OBJS &#x3D; client.o client_api.o client_mem.o*</strong></p>
<p>*<strong>client_LIBS &#x3D; protocol*</strong></p>
<p> ***# Everything after this is generic***</p>
<p>***.PHONY: all***</p>
<p>*<strong>all: $(PROGRAMS)*</strong></p>
<p> *<strong>define PROGRAM_template*</strong></p>
<p>***$(1): $$($(1)_OBJ) $$($(1)_LIBS:%&#x3D;-l%)***</p>
<p>  *<strong>ALL_OBJS  +&#x3D; $$($(1)_OBJS)*</strong></p>
<p>*<strong>endef*</strong></p>
<p>â€‹        ***$(foreach prog,$(PROGRAMS),$(eval $(call PROGRAM_template,$(prog))))***</p>
<p>â€‹        ***$(PROGRAMS):***</p>
<p>â€‹        ***$(LINK.o) $^ $(LDLIBS) -o $@***</p>
<p>â€‹        *<strong>clean:*</strong></p>
<p>â€‹        *<strong>rm -f $(ALL_OBJS) $(PROGRAMS)*</strong></p>
<p>æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ï¼šå®ƒå®ç°çš„åŠŸèƒ½æ˜¯å®Œæˆâ€œPROGRAMSâ€çš„ç¼–è¯‘é“¾æ¥ã€‚ä¾‹å­ä¸­â€œ$(LINK.o)â€ä¸ºâ€œ$(CC) $(LDFLAGS)â€ï¼Œæ„æ€æ˜¯å¯¹æ‰€æœ‰çš„.oæ–‡ä»¶å’ŒæŒ‡å®šçš„åº“æ–‡ä»¶è¿›è¡Œé“¾æ¥ã€‚</p>
<p>â€‹        ***â€œ$(foreach prog,$(PROGRAM),$(eval $(call PROGRAM_template,$(prog))))â€***å±•å¼€ä¸ºï¼š</p>
<p>â€‹        *<strong>server : $(server_OBJS) â€“l$(server_LIBS)*</strong></p>
<p>â€‹        *<strong>client : $(client_OBJS) â€“l$(client_LIBS)*</strong></p>
<h1 id="8-è½¯ä»¶åŒ…Makefileè§£æ"><a href="#8-è½¯ä»¶åŒ…Makefileè§£æ" class="headerlink" title="8.è½¯ä»¶åŒ…Makefileè§£æ"></a>8.è½¯ä»¶åŒ…Makefileè§£æ</h1><p>ä¸Šé¢ä¸€ç¯‡åšæ–‡ä¸­ï¼Œåšä¸»å°è¯•åˆ›å»ºä¸€ä¸ªéå¸¸ç®€å•çš„helloworldåŒ…ï¼Œè¿‡ç¨‹è¯¦è§åšæ–‡ï¼š<a target="_blank" rel="noopener" href="http://my.oschina.net/hevakelcj/blog/410633">http://my.oschina.net/hevakelcj/blog/410633</a></p>
<p>æœ¬æ–‡å°†å¸¦å¤§å®¶ä¸€èµ·æ·±å…¥åœ°å­¦ä¹ ä¸€ä¸‹OpenWrtåŒ…çš„ Makefileã€‚æˆ‘ä»¬ä¸ä»…è¦çŸ¥å…¶ç„¶ï¼Œè¿˜è¦çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚åœ¨ä¸Šç¯‡åšæ–‡é‡Œï¼ŒåŒ…é‡Œçš„ Makefile å†…å®¹å¦‚ä¸‹ï¼š</p>
<p>include $(TOPDIR)&#x2F;rules.mk PKG_NAME:&#x3D;helloworldPKG_RELEASE:&#x3D;1PKG_BUILD_DIR:&#x3D;$(BUILD_DIR)&#x2F;$(PKG_NAME) include $(INCLUDE_DIR)&#x2F;package.mk define Package&#x2F;helloworldSECTION:&#x3D;utilsCATEGORY:&#x3D;UtilitiesTITLE:&#x3D;Helloworld â€” prints a snarky messageendef define Package&#x2F;helloworld&#x2F;descriptionItâ€™s my first package demo.endef define Build&#x2F;Prepareecho â€œHere is Package&#x2F;Prepareâ€mkdir -p $(PKG_BUILD_DIR)$(CP) .&#x2F;src&#x2F;* $(PKG_BUILD_DIR)&#x2F;endef define Package&#x2F;helloworld&#x2F;installecho â€œHere is Package&#x2F;installâ€$(INSTALL_DIR) $(1)&#x2F;bin$(INSTALL_BIN) $(PKG_BUILD_DIR)&#x2F;helloworld $(1)&#x2F;bin&#x2F;endef $(eval $(call BuildPackage,helloworld))</p>
<p>å¤§æ¦‚æˆ‘ä»¬å¯ä»¥å°†ç®€ä»£ä¸ºå¦‚ä¸‹çš„ç»“æ„ï¼š</p>
<p>include $(TOPDIR)&#x2F;rules.mk # è¿™é‡Œå®šä¹‰ä¸€ç³»åˆ—çš„ PKG_XX include $(INCLUDE_DIR)&#x2F;package.mk # å®šä¹‰å„ç§ Package, Build å® $(eval $(call BuildPackage,åŒ…å))</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥ä¸€ä¸€æ‹†è§£ã€‚</p>
<h2 id="8-1-include-TOPDIR-x2F-rules-mk"><a href="#8-1-include-TOPDIR-x2F-rules-mk" class="headerlink" title="8.1.include $(TOPDIR)&#x2F;rules.mk"></a>8.1.include $(TOPDIR)&#x2F;rules.mk</h2><p>é¦–å…ˆï¼Œinclude $(TOPDIR)&#x2F;rules.mkï¼Œä¹Ÿå°±æ˜¯å°† SDK&#x2F;rules.mk æ–‡ä»¶ä¸­çš„å†…å®¹å¯¼å…¥è¿›æ¥ã€‚</p>
<p>TOPDIRå°±æ˜¯SDKçš„è·¯å¾„ã€‚</p>
<p>åœ¨ SDK&#x2F;rules.mk æ–‡ä»¶ä¸­ï¼Œå®šä¹‰äº†è®¸å¤šå˜é‡ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œåœ¨Makefileä¸­ï¼Œèµ‹å€¼æ˜¯ç”¨ :&#x3D; ï¼Œè€Œä¸æ˜¯ç­‰å·ã€‚</p>
<p>æ¯”å¦‚ä¸Šé¢çš„ BUILD_DIR, INCLUDE_DIR ç­‰ï¼Œéƒ½åœ¨è¿™é‡Œå®šä¹‰ã€‚è¿˜æœ‰ï¼š</p>
<p>è¿˜æœ‰å…³äº TARGET_CC, TARGET_CXX ç­‰éå¸¸æœ‰ç”¨çš„å˜é‡å®šä¹‰ã€‚</p>
<p>è¿˜æœ‰ TARï¼Œ FINDï¼Œ INSTALL_BIN, INSTALL_DIR, INSTALL_DATAç­‰ç­‰éå¸¸é‡è¦çš„å˜é‡å®šä¹‰ã€‚</p>
<h2 id="8-2-è‡ªå®šä¹‰-PKG-XXXX-å˜é‡"><a href="#8-2-è‡ªå®šä¹‰-PKG-XXXX-å˜é‡" class="headerlink" title="8.2.è‡ªå®šä¹‰ PKG_XXXX å˜é‡"></a>8.2.è‡ªå®šä¹‰ PKG_XXXX å˜é‡</h2><p>å®˜ç½‘ä¸ŠæŒ‡å®šæœ‰å¦‚ä¸‹å˜é‡éœ€è¦è®¾ç½®ï¼š</p>
<p>PKG_NAME     â€“ The name of the package, as seen via menuconfig and ipkg</p>
<p>PKG_VERSION   â€“ The upstream version number that weâ€™re downloading</p>
<p>PKG_RELEASE   â€“ The version of this package Makefile</p>
<p>PKG_LICENSE   â€“ The license(s) the package is available under, SPDX form.</p>
<p>PKG_LICENSE_FILE- file containing the license text</p>
<p>PKG_BUILD_DIR  â€“ Where to compile the package</p>
<p>PKG_SOURCE    â€“ The filename of the original sources</p>
<p>PKG_SOURCE_URL- Where to download the sources from (directory)</p>
<p>PKG_MD5SUM    â€“ A checksum to validate the download</p>
<p>PKG_CAT     â€“ How to decompress the sources (zcat, bzcat, unzip)</p>
<p>PKG_BUILD_DEPENDS â€“ Packages that need to be built before this package, but are not required at runtime. Uses the same syntax as DEPENDS below.</p>
<p>PKG_INSTALL   â€“ Setting it to â€œ1â€ will call the packageâ€™s original â€œmake installâ€ with prefix set to PKG_INSTALL_DIR</p>
<p>PKG_INSTALL_DIR â€“ Where â€œmake installâ€ copies the compiled files</p>
<p>PKG_FIXUP    â€“ ???</p>
<p>PKG_SOURCE_PROTO â€“ the protocol to use for fetching the sources (git, svn)</p>
<p>PKG_REV     â€“ the svn revision to use, must be specified if proto is â€œsvnâ€</p>
<p>PKG_SOURCE_SUBDIR â€“ must be specified if proto is â€œsvnâ€ or â€œgitâ€, e.g. â€œPKG_SOURCE_SUBDIR:&#x3D;$(PKG_NAME)-$(PKG_VERSION)â€</p>
<p>PKG_SOURCE_VERSION â€“ must be specified if proto is â€œgitâ€, the commit hash to check out</p>
<p>PKG_CONFIG_DEPENDS â€“ specifies which config options depend on this package being selected</p>
<h2 id="8-3-include-INCLUDE-DIR-x2F-package-mk"><a href="#8-3-include-INCLUDE-DIR-x2F-package-mk" class="headerlink" title="8.3.include $(INCLUDE_DIR)&#x2F;package.mk"></a>8.3.include $(INCLUDE_DIR)&#x2F;package.mk</h2><p>è·Ÿä¸Šé¢çš„ include $(TOPDIR)&#x2F;rules.mk æ˜¯ä¸€æ ·çš„ã€‚å°±æ˜¯æŠŠè¿™ä¸ªæ–‡ä»¶åŒ…å«è¿›æ¥ã€‚</p>
<p>INCLUDE_DIRè¿™ä¸ªå˜é‡åœ¨ rules.mk é‡Œå·²ç»å®šä¹‰äº†ï¼š</p>
<p>é‚£å°±æ˜¯ SDK&#x2F;include&#x2F;package.mk æ–‡ä»¶äº†ï¼Œæ‰“å¼€çœ‹çœ‹ã€‚</p>
<p>ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½ï¼š</p>
<h3 id="ï¼ˆ1ï¼‰å®ƒä¼šé…ç½®é»˜è®¤çš„å˜é‡"><a href="#ï¼ˆ1ï¼‰å®ƒä¼šé…ç½®é»˜è®¤çš„å˜é‡" class="headerlink" title="ï¼ˆ1ï¼‰å®ƒä¼šé…ç½®é»˜è®¤çš„å˜é‡"></a>ï¼ˆ1ï¼‰å®ƒä¼šé…ç½®é»˜è®¤çš„å˜é‡</h3><p>å¦‚æœæŸä¸ªå˜é‡æˆ‘ä»¬æ²¡æœ‰åœ¨ä¸Šä¸€éƒ¨åˆ†é‡Œå®šä¹‰ï¼Œé‚£é‡Œåœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼Œå®ƒå°±ä¼šè¢«æŒ‡å®šä¸ºé»˜è®¤å€¼ï¼Œæ¯”å¦‚ï¼š</p>
<p>ä¸Šé¢çš„ç”¨ ?&#x3D; æ¥è¡¨ç¤ºç»™æœªå®šä¹‰çš„å˜é‡èµ‹é»˜è®¤å€¼ã€‚æ¯”å¦‚ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®š PKG_MD5SUMï¼Œé‚£ä¹ˆå°±é»˜è®¤ä¸º unknowã€‚</p>
<h3 id="ï¼ˆ2ï¼‰æ¨å¯¼å…¶å®ƒå˜é‡"><a href="#ï¼ˆ2ï¼‰æ¨å¯¼å…¶å®ƒå˜é‡" class="headerlink" title="ï¼ˆ2ï¼‰æ¨å¯¼å…¶å®ƒå˜é‡"></a>ï¼ˆ2ï¼‰æ¨å¯¼å…¶å®ƒå˜é‡</h3><p>æ ¹æ®ä¸Šéƒ¨åˆ†ç”¨æˆ·è‡ªå®šä¹‰çš„ PKG_XXXX å˜é‡æ¨å¯¼å‡ºæ›´å¤šç›¸å…³çš„å˜é‡ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<p>è™½ç„¶æˆ‘æ²¡æœ‰çœ‹è¿‡ç›¸å…³çš„æ‰‹å†Œï¼Œæ ¹æ®å¤šå¹´çš„ä»ä¸šç»éªŒä¹Ÿèƒ½çœ‹å‡ºä¸Šé¢çš„æ„æ€æ¥ã€‚</p>
<p>#å¦‚æœå®šä¹‰äº†å®ï¼Œå°±â€¦ifdef å®åâ€¦endif #å¦‚æœå®ç›¸ç­‰ifeq (å®1,å®2)â€¦endif strip $å®å   #å°†å®å¯¹åº”çš„å€¼å»é™¤å‰åçš„ç©ºç™½å­—ç¬¦ VAR +&#x3D; xxxx  #åœ¨å˜é‡ VAR åé¢è¿½åŠ  xxxx</p>
<p>æˆ‘çŒœå¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼Œå¦‚æœä¸å¯¹è¯·æŒ‡æ­£ã€‚</p>
<p>å†æ¯”å¦‚å¦‚ä¸‹ï¼š</p>
<p>å°±è¿™æ ·ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†å¤§é‡æœ‰ä»·å€¼çš„å˜é‡ã€‚</p>
<h3 id="ï¼ˆ3ï¼‰åŒ…å«å…¶å®ƒmkæ–‡ä»¶"><a href="#ï¼ˆ3ï¼‰åŒ…å«å…¶å®ƒmkæ–‡ä»¶" class="headerlink" title="ï¼ˆ3ï¼‰åŒ…å«å…¶å®ƒmkæ–‡ä»¶"></a>ï¼ˆ3ï¼‰åŒ…å«å…¶å®ƒmkæ–‡ä»¶</h3><h3 id="ï¼ˆ4ï¼‰å®šä¹‰é»˜è®¤å®"><a href="#ï¼ˆ4ï¼‰å®šä¹‰é»˜è®¤å®" class="headerlink" title="ï¼ˆ4ï¼‰å®šä¹‰é»˜è®¤å®"></a>ï¼ˆ4ï¼‰å®šä¹‰é»˜è®¤å®</h3><p>åœ¨ Makefile ä¸­ï¼Œå®çš„å®šä¹‰æ ¼å¼æ˜¯ï¼š</p>
<p>define XXX&#x2F;xxxx&lt;å®çš„å®ä½“â€¦&gt;endef</p>
<p>package.mkä¼šæŠŠå¤§éƒ¨åˆ†éœ€è¦çš„å®éƒ½å®šä¹‰å¥½ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œç”¨æˆ·åªéœ€è¦å®šä¹‰å¥½äº† PKG_XXX ä¹‹åï¼Œä¸éœ€è¦å†è‡ªå®šä¹‰å®ï¼Œé»˜è®¤çš„å®å°±å¯ä»¥æ»¡è¶³éœ€æ±‚ã€‚</p>
<p>æ¯”å¦‚Build&#x2F;Prepare&#x2F;Defaultçš„å®šä¹‰ï¼š</p>
<p>Build&#x2F;Prepareå®æ˜¯åœ¨ç¼–è¯‘å‰è¿›è¡Œçš„ï¼Œæ˜¯å‡†å¤‡å·¥ä½œã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œå®ƒåˆ†äº†ä¸¤ç§æƒ…å†µï¼š</p>
<p>Aï¼Œå®šä¹‰äº† USE_GIT_TREEï¼Œåˆ™æŒ‰gitçš„æ–¹å¼å®šä¹‰ã€‚</p>
<p>Bï¼Œå®šä¹‰äº† USB_SOURCE_DIRï¼Œåˆ™æŒ‰æºç åœ¨æœ¬åœ°çš„æ–¹æ¡ˆå®šä¹‰ã€‚</p>
<h3 id="ï¼ˆ5ï¼‰BuildPackageå®"><a href="#ï¼ˆ5ï¼‰BuildPackageå®" class="headerlink" title="ï¼ˆ5ï¼‰BuildPackageå®"></a>ï¼ˆ5ï¼‰BuildPackageå®</h3><p>æœ€é‡è¦çš„ä¸€ä¸ªå®æ˜¯ BuildPackageã€‚å®ƒä¼šåœ¨ Makefile çš„æœ€åä¸€è¡Œè¢«å¼•ç”¨ã€‚å®ƒçš„å®ç°ä¹Ÿå°±æ˜¯åœ¨ package.mk æ–‡ä»¶é‡Œã€‚å¦‚ä¸‹ä¸ºå…¶æºç ï¼š</p>
<p>define BuildPackage$(Build&#x2F;IncludeOverlay)$(eval $(Package&#x2F;Default))  #å®šä¹‰åœ¨package-defaults.mkæ–‡ä»¶é‡Œ$(eval $(Package&#x2F;$(1)))    #è°ƒç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„ Package&#x2F;&lt;åŒ…å&gt; å® ifdef DESCRIPTION$$(error DESCRIPTION:&#x3D; is obsolete, use Package&#x2F;PKG_NAME&#x2F;description)endif #æ£€æŸ¥æœ‰æ²¡æœ‰å®šä¹‰ Package&#x2F;&lt;åŒ…å&gt;&#x2F;descriptionå®ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ï¼Œåˆ™ä»¥TITLEé»˜è®¤å®šä¹‰ä¸€ä¸ªifndef Package&#x2F;$(1)&#x2F;descriptiondefine Package&#x2F;$(1)&#x2F;description$(TITLE)endefendif BUILD_PACKAGES +&#x3D; $(1)$(STAMP_PREPARED): $$(if $(QUILT)$(DUMP),,$(call find_library_dependencies,$(DEPENDS))) #æ£€æŸ¥ TITLE, CATEGORY, SECTION, VERSION æ˜¯å¦å®šä¹‰ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰åˆ™æŠ¥é”™$(foreach FIELD, TITLE CATEGORY SECTION VERSION,ifeq ($($(FIELD)),)$$(error Package&#x2F;$(1) is missing the $(FIELD) field)endif) #å¦‚æœæœ‰å®šä¹‰DUMPï¼Œé‚£å°±å¼•å…¥Dumpinfo&#x2F;Packageå®çš„å†…éƒ¨ã€‚#å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆå°±å¼•ç”¨ Packaget&#x2F;&lt;åŒ…å&gt;&#x2F;targetsé‡Œé¢çš„æ¯ä¸€ä¸ªtargetï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰Packaget&#x2F;&lt;åŒ…å&gt;&#x2F;targetså®ï¼Œé‚£ä¹ˆå°†PKG_TARGETSé‡Œçš„æ¯ä¸ªtargetå–å‡ºæ¥ï¼Œ#å¦‚æœä¹Ÿæ²¡æœ‰å®šä¹‰PKG_TARGETSï¼Œé‚£å°±é»˜è®¤ipkgä½œä¸ºtargetã€‚å°†æ¯ä¸€ä¸ªtargetï¼Œå¼•ç”¨ BuildTarget&#x2F;$(target)ã€‚$(if $(DUMP), $(Dumpinfo&#x2F;Package), $(foreach target, $(if $(Package&#x2F;$(1)&#x2F;targets),$(Package&#x2F;$(1)&#x2F;targets), $(if $(PKG_TARGETS),$(PKG_TARGETS), ipkg) ), $(BuildTarget&#x2F;$(target)) ) )$(if $(PKG_HOST_ONLY)$(DUMP),,$(call Build&#x2F;DefaultTargets,$(1)))endef</p>
<p>æ€»ç»“ä¸€ä¸‹è¯­æ³•ï¼š</p>
<p>$() è¡¨ç¤ºè¦æ‰§è¡Œçš„ä¸€æ¡è¯­å¥</p>
<p>$(if æ¡ä»¶, æˆç«‹æ‰§è¡Œ, å¤±è´¥æ‰§è¡Œ)    ifæ¡ä»¶åˆ†æ”¯</p>
<p>$(foreach å˜é‡, æˆå‘˜åˆ—è¡¨, æ‰§è¡Œä½“)  æˆå‘˜éå†è¯­å¥</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œè¯­å¥æ˜¯å¯ä»¥åµŒå¥—ä½¿ç”¨çš„ã€‚</p>
<p>$(N) è¡¨ç¤ºç¬¬Nä¸ªå‚æ•°</p>
<h2 id="8-4-è‡ªå®šä¹‰å®"><a href="#8-4-è‡ªå®šä¹‰å®" class="headerlink" title="8.4.è‡ªå®šä¹‰å®"></a>8.4.è‡ªå®šä¹‰å®</h2><h3 id="å¿…é¡»å®šä¹‰çš„å®"><a href="#å¿…é¡»å®šä¹‰çš„å®" class="headerlink" title="å¿…é¡»å®šä¹‰çš„å®"></a>å¿…é¡»å®šä¹‰çš„å®</h3><p>æˆ‘å®šè¦ä¸ºæˆ‘ä»¬çš„packageå®šä¹‰ç‰¹å®šçš„å®ï¼š</p>
<p>Package&#x2F;&lt;åŒ…å&gt;  #åŒ…çš„å‚æ•°</p>
<p>åœ¨ Package&#x2F;&lt;åŒ…å&gt; å®ä¸­å®šä¹‰ä¸åŒ…ç›¸å…³çš„ä¿¡æ¯ã€‚</p>
<p>å¦‚Package&#x2F;helloworldå®ï¼š</p>
<table>
<thead>
<tr>
<th>12345</th>
<th>define Package&#x2F;helloworldSECTION:&#x3D;utilsCATEGORY:&#x3D;UtilitiesTITLE:&#x3D;Helloworld â€” prints a snarky messageendef</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>é™¤äº†ä¸Šé¢æ‰€åˆ—çš„ SECTIONï¼ŒCATEGORYï¼ŒTITLEå˜é‡å¤–ï¼Œè¿˜å¯ä»¥å®šä¹‰ï¼š</p>
<p>SECTION   â€“ åŒ…çš„ç§ç±»</p>
<p>CATEGORY   â€“ æ˜¾ç¤ºåœ¨menuconfigçš„å“ªä¸ªç›®å½•ä¸‹</p>
<p>TITLE    â€“ ç®€å•çš„ä»‹ç»</p>
<p>DESCRIPTION â€“ (deprecated) å¯¹åŒ…è¯¦ç»†çš„ä»‹ç»</p>
<p>URL â€“ æºç æ‰€åœ¨çš„ç½‘ç»œè·¯å¾„</p>
<p>MAINTAINER  â€“ (required for new packages) ç»´æŠ¤è€…æ˜¯è°ï¼ˆå‡ºé”™äº†è”ç³»è°ï¼‰</p>
<p>DEPENDS   â€“ (optional) éœ€è¦ä¾äº‹çš„åŒ…ï¼ŒSee <a target="_blank" rel="noopener" href="http://wiki.openwrt.org/doc/devel/packages#dependencytypes">below</a> for the syntax.</p>
<p>USERID    â€“ (optional) a username:groupname pair to create at package installation time.</p>
<p>ã€PKG_VERSIONå®ç¼ºå¤±æ—¶æŠ¥é”™ã€‘ï¼š</p>
<p>OpenWrt Developers Team <a href="mailto:&#111;&#112;&#101;&#x6e;&#119;&#114;&#116;&#x2d;&#x64;&#x65;&#118;&#101;&#108;&#64;&#111;&#x70;&#101;&#x6e;&#119;&#x72;&#116;&#46;&#x6f;&#x72;&#x67;">&#111;&#112;&#101;&#x6e;&#119;&#114;&#116;&#x2d;&#x64;&#x65;&#118;&#101;&#108;&#64;&#111;&#x70;&#101;&#x6e;&#119;&#x72;&#116;&#46;&#x6f;&#x72;&#x67;</a></p>
<p>@@</p>
<p>Makefile:53: *** Package&#x2F;exfat is missing the VERSION field. Stop.</p>
<h3 id="å¯é€‰å®šä¹‰çš„å®"><a href="#å¯é€‰å®šä¹‰çš„å®" class="headerlink" title="å¯é€‰å®šä¹‰çš„å®"></a>å¯é€‰å®šä¹‰çš„å®</h3><p>å…¶å®ƒçš„å®å¯ä»¥é€‰æ‹©æ€§åœ°å®šä¹‰ï¼Œé€šå¸¸æ²¡å¿…è¦è‡ªå·±é‡å†™ã€‚ä½†æœ‰äº›æƒ…å†µï¼Œpackage.mkä¸­é»˜è®¤çš„å®ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦è‡ªå·±é‡å®šä¹‰å®ã€‚</p>
<p>æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨ä¸ºhelloworldå†™Makefileæ—¶ï¼Œæˆ‘ä»¬è¦æ±‚åœ¨ç¼–è¯‘ä¹‹å‰ï¼Œå°† SDK&#x2F;package&#x2F;helloworld&#x2F;src&#x2F; è·¯å¾„ä¸‹çš„æ–‡ä»¶å¤åˆ¶åˆ° PKG_BUILD_DIR æ‰€æŒ‡å®šçš„ç›®å½•ä¸‹ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬é‡æ–°å®šä¹‰Build&#x2F;Prepareå®ï¼š</p>
<p><a target="_blank" rel="noopener" href="http://my.oschina.net/hevakelcj/blog/411942">?</a></p>
<table>
<thead>
<tr>
<th>1234</th>
<th>define Build&#x2F;Preparemkdir -p $(PKG_BUILD_DIR)$(CP) .&#x2F;src&#x2F;* $(PKG_BUILD_DIR)&#x2F;endef</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>å¦‚æ­¤ä»¥æ¥ï¼Œåœ¨æˆ‘ä»¬ make V&#x3D;s æ—¶ï¼Œmakeå·¥å…·ä¼šåœ¨ç¼–è¯‘ä¹‹å‰æ‰§è¡Œ Build&#x2F;Prepare å®é‡Œçš„å‘½ä»¤ã€‚</p>
<p>å†æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦æŒ‡å®šåŒ…çš„å®‰è£…æ–¹æ³•ï¼š</p>
<p><a target="_blank" rel="noopener" href="http://my.oschina.net/hevakelcj/blog/411942">?</a></p>
<table>
<thead>
<tr>
<th>1234</th>
<th>define Package&#x2F;helloworld&#x2F;install$(INSTALL_DIR) $(1)&#x2F;bin$(INSTALL_BIN) $(PKG_BUILD_DIR)&#x2F;helloworld $(1)&#x2F;bin&#x2F;endef</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>ä¸Šé¢çš„è¿™ä¸ªå®å°±æ˜¯æŒ‡å®šäº†åŒ…çš„å®‰è£…è¿‡ç¨‹ã€‚å…¶ä¸­ INSTALL_DIR å®šä¹‰åœ¨ rules.mk æ–‡ä»¶é‡Œã€‚</p>
<p>INSTALL_DIR &#x3D; install -d -m0755</p>
<p>INSTALL_BIN &#x3D; install -m0755</p>
<p>$(1)ä¸ºç¬¬ä¸€ä¸ªå‚æ•°æ˜¯.&#x2F;configureæ—¶çš„â€“prefixå‚æ•°ï¼Œé€šå¸¸ä¸ºâ€â€</p>
<p>å±•å¼€ä¹‹åå°±æ˜¯ï¼š</p>
<p>define Package&#x2F;helloworld&#x2F;installinstall -d -m0755 &#x2F;bininstall -m0755 $(PKG_BUILD_DIR)&#x2F;helloworld &#x2F;bin&#x2F;endef</p>
<p>å®ƒçš„æ„æ€å°±ä¸€ç›®äº†ç„¶äº†ã€‚</p>
<p>é™¤äº†ä¸Šé¢æ‰€åˆ—ä¸¾çš„è¿™ä¸¤ä¸ªå®å¤–ï¼Œåœ¨å®˜ç½‘ä¸Šä¹Ÿè¯´æ˜äº†å…¶å®ƒå¯é€‰çš„å®ï¼š</p>
<h5 id="Package-x2F-conffiles-optional"><a href="#Package-x2F-conffiles-optional" class="headerlink" title="Package&#x2F;conffiles (optional)"></a>Package&#x2F;conffiles (optional)</h5><p>ç”±è¯¥åŒ…å®‰è£…çš„é…ç½®æ–‡ä»¶çš„åˆ—è¡¨ï¼Œä¸€è¡Œä¸€ä¸ªæ–‡ä»¶ã€‚</p>
<h5 id="Package-x2F-description"><a href="#Package-x2F-description" class="headerlink" title="Package&#x2F;description"></a>Package&#x2F;description</h5><p>å¯¹åŒ…æè¿°çš„çº¯æ–‡æœ¬</p>
<h5 id="Build-x2F-Prepare-optional"><a href="#Build-x2F-Prepare-optional" class="headerlink" title="Build&#x2F;Prepare (optional)"></a>Build&#x2F;Prepare (optional)</h5><p>A set of commands to unpack and patch the sources. You may safely leave this undefined.</p>
<h5 id="Build-x2F-Configure-optional"><a href="#Build-x2F-Configure-optional" class="headerlink" title="Build&#x2F;Configure (optional)"></a>Build&#x2F;Configure (optional)</h5><p>You can leave this undefined if the source doesnâ€™t use configure or has a normal config script, otherwise you can put your own commands here or use â€œ$(call Build&#x2F;Configure&#x2F;Default,)â€ as above to pass in additional arguments for a standard configure script.</p>
<h5 id="Build-x2F-Compile-optional"><a href="#Build-x2F-Compile-optional" class="headerlink" title="Build&#x2F;Compile (optional)"></a>Build&#x2F;Compile (optional)</h5><p>How to compile the source; in most cases you should leave this undefined, because then the default is used, which calls make. If you want to pass special arguments to make, use e.g. â€œ$(call Build&#x2F;Compile&#x2F;Default,FOO&#x3D;bar)</p>
<h5 id="Build-x2F-Install-optional"><a href="#Build-x2F-Install-optional" class="headerlink" title="Build&#x2F;Install (optional)"></a>Build&#x2F;Install (optional)</h5><p>How to install the compiled source. The default is to call make install. Again, to pass special arguments or targets, use $(call Build&#x2F;Install&#x2F;Default,install install-foo) Note that you need put all the needed make arguments here. If you just need to add something to the â€œinstallâ€ argument, donâ€™t forget the â€˜installâ€™ itself.</p>
<h5 id="Build-x2F-InstallDev-optional"><a href="#Build-x2F-InstallDev-optional" class="headerlink" title="Build&#x2F;InstallDev (optional)"></a>Build&#x2F;InstallDev (optional)</h5><p>For things needed to compile packages against it (static libs, header files), but that are of no use on the target device.</p>
<h5 id="Package-x2F-install"><a href="#Package-x2F-install" class="headerlink" title="Package&#x2F;install"></a>Package&#x2F;install</h5><p>A set of commands to copy files into the ipkg which is represented by the $(1) directory. As source you can use relative paths which will install from the unpacked and compiled source, or $(PKG_INSTALL_DIR) which is where the files in the Build&#x2F;Install step above end up.</p>
<h5 id="Package-x2F-preinst"><a href="#Package-x2F-preinst" class="headerlink" title="Package&#x2F;preinst"></a>Package&#x2F;preinst</h5><p>The actual text of the script which is to be executed before installation. Dont forget to include the #!&#x2F;bin&#x2F;sh. If you need to abort installation have the script return false.</p>
<h5 id="Package-x2F-postinst"><a href="#Package-x2F-postinst" class="headerlink" title="Package&#x2F;postinst"></a>Package&#x2F;postinst</h5><p>The actual text of the script which is to be executed after installation. Dont forget to include the #!&#x2F;bin&#x2F;sh.</p>
<h5 id="Package-x2F-prerm"><a href="#Package-x2F-prerm" class="headerlink" title="Package&#x2F;prerm"></a>Package&#x2F;prerm</h5><p>The actual text of the script which is to be executed before removal. Dont forget to include the #!&#x2F;bin&#x2F;sh. If you need to abort removal have the script return false.</p>
<h5 id="Package-x2F-postrm"><a href="#Package-x2F-postrm" class="headerlink" title="Package&#x2F;postrm"></a>Package&#x2F;postrm</h5><p>The actual text of the script which is to be executed after removal. Dont forget to include the #!&#x2F;bin&#x2F;sh.</p>
<p>ä¹‹æ‰€ä»¥æœ‰äº›å®æ˜¯ä»¥â€Package&#x2F;â€å¼€å¤´ï¼Œæœ‰çš„åˆä»¥â€Build&#x2F;â€ï¼Œæ˜¯å› ä¸ºåœ¨ä¸€ä¸ªMakefileé‡Œç”Ÿæˆå¤šä¸ªåŒ…ã€‚OpenWrté»˜è®¤è®¤ä¸ºä¸€ä¸ª Makefileé‡Œå®šä¹‰ä¸€ä¸ªåŒ…ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦å°†å…¶æ‹†åˆ†æˆå¤šä¸ªã€‚æ‰€ä»¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬åªå¸Œæœ›ç¼–è¯‘ä¸€æ¬¡ï¼Œé‚£ä¹ˆåªè¦æœ‰ä¸€ç³»åˆ—çš„â€Build&#x2F;â€çš„å®å®šä¹‰å°±å¯ ä»¥äº†ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ å¤šä¸ªâ€Package&#x2F;â€å®å®šä¹‰ï¼Œå¹¶è°ƒç”¨ BuildPackageï¼Œæ¥åˆ›å»ºå¤šä¸ªåŒ…ã€‚</p>
<h2 id="8-5-ä½¿ä¹‹ç”Ÿæ•ˆ"><a href="#8-5-ä½¿ä¹‹ç”Ÿæ•ˆ" class="headerlink" title="8.5.ä½¿ä¹‹ç”Ÿæ•ˆ"></a>8.5.ä½¿ä¹‹ç”Ÿæ•ˆ</h2><p>åœ¨Makefileçš„æœ€åä¸€è¡Œæ˜¯ï¼š</p>
<p>$(eval $(call BuildPackage,helloworld))</p>
<p>æœ€é‡è¦çš„ BuildPackageå®šä¹‰åœ¨ package.mk æ–‡ä»¶é‡Œã€‚è§ä¸Šé¢ BuildPackage å®å®šä¹‰ã€‚</p>
<h2 id="8-6-æ·»åŠ æ–°ç¼–è¯‘é€‰é¡¹"><a href="#8-6-æ·»åŠ æ–°ç¼–è¯‘é€‰é¡¹" class="headerlink" title="8.6.æ·»åŠ æ–°ç¼–è¯‘é€‰é¡¹"></a>8.6.æ·»åŠ æ–°ç¼–è¯‘é€‰é¡¹</h2><p>æ¯”å¦‚dibblerè½¯ä»¶åŒ…çš„ç¼–è¯‘ï¼Œéœ€è¦ç¼–è¯‘C++ä»£ç ï¼Œéœ€è¦ä½¿ç”¨-Istdc++é€‰é¡¹ï¼Œå¯ä»¥åœ¨dibblerç¼–è¯‘Makefileä¸­æ·»åŠ TAGET_CXXFLAGS +&#x3D;-Istdc++ å³å¯ã€‚</p>
<h1 id="9-openwrtä¸»Makafileè§£æ"><a href="#9-openwrtä¸»Makafileè§£æ" class="headerlink" title="9.openwrtä¸»Makafileè§£æ"></a>9.openwrtä¸»Makafileè§£æ</h1><p>å…¶ä»–ç›¸å…³å‚è€ƒï¼š<a target="_blank" rel="noopener" href="http://blog.csdn.net/suiyuan19840208/article/details/25737323/">http://blog.csdn.net/suiyuan19840208/article/details/25737323/</a></p>
<p>åŸæ–‡åœ°å€ï¼š<a target="_blank" rel="noopener" href="http://www.right.com.cn/forum/thread-73443-1-1.html">http://www.right.com.cn/forum/thread-73443-1-1.html</a></p>
<p>æœ¬æ–‡æ˜¯æœ¬äººå¯¹OpenWrtçš„Makefileçš„ç†è§£ï¼Œå¹¶éè½¬è½½ã€‚<br>OpenWrtæ˜¯ä¸€ä¸ªå…¸å‹çš„åµŒå…¥å¼Linuxå·¥ç¨‹ï¼Œäº†è§£OpenWrtçš„Makefileçš„å·¥ä½œè¿‡ç¨‹å¯¹æé«˜åµŒå…¥å¼Linuxå·¥ç¨‹çš„å¼€å‘èƒ½åŠ›æœ‰æå…¶é‡è¦æ„ä¹‰ã€‚<br>OpenWrtçš„ä¸»Makefileæ–‡ä»¶åªæœ‰100è¡Œï¼Œå¯ä»¥ç®€å•åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œ1<del>17è¡Œä¸ºå‰å¯¼éƒ¨åˆ†ï¼Œ19</del>31ä¸ºé¦–æ¬¡æ‰§è¡Œéƒ¨åˆ†ï¼Œ33~101ä¸ºå†æ¬¡æ‰§è¡Œéƒ¨åˆ†ã€‚<br>å‰å¯¼éƒ¨åˆ†<br>CURDIRä¸ºmakeé»˜è®¤å˜é‡ï¼Œé»˜è®¤å€¼ä¸ºå½“å‰ç›®å½•ã€‚<br>å‰å¯¼éƒ¨åˆ†ä¸»è¦æŠŠå˜é‡TOPDIRèµ‹å€¼ä¸ºå½“å‰ç›®å½•ï¼ŒæŠŠå˜é‡LC_ALLã€LANGèµ‹å€¼ä¸ºCï¼Œå¹¶ä½¿ç”¨å˜é‡å»¶ä¼¸æŒ‡ç¤ºç¬¦exportï¼ŒæŠŠä¸Šè¿°ä¸‰ä¸ªå˜é‡å»¶ä¼¸åˆ°ä¸‹å±‚Makefileã€‚<br>ä½¿ç”¨æ–‡ä»¶ä½¿ç”¨æŒ‡ç¤ºç¬¦includeå¼•å…¥$(TOPDIR)&#x2F;include&#x2F;host.mkã€‚åœ¨OpenWrtçš„ä¸»Makefileæ–‡ä»¶ä½¿ç”¨äº†å¤šæ¬¡ includeæŒ‡ç¤ºç¬¦ï¼Œè¯´æ˜ä¸»Makefileæ–‡ä»¶è¢«æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œè¢«æ‹†åˆ†çš„æ–‡ä»¶æ”¾åœ¨ä¸åŒçš„ç›®å½•ã€‚æ‹†åˆ†çš„ç›®çš„æ˜¯æ˜ç¡®å„éƒ¨åˆ†çš„åŠŸèƒ½ï¼Œè€Œä¸”å¢åŠ å…¶çµæ´»æ€§ã€‚<br>åœ¨å‰å¯¼éƒ¨åˆ†æ¯”è¾ƒè´¹è§£çš„æ˜¯ä½¿ç”¨worldç›®æ ‡ï¼Œåœ¨makefileä¸­åŸºæœ¬è§„åˆ™ä¸ºï¼š<br>TARGETS : PREREQUISITES<br>COMMAND<br>â€¦<br>å³makefileè§„åˆ™ç”±ç›®æ ‡ã€ä¾èµ–ã€å‘½ä»¤ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåœ¨OpenWrtçš„ä¸»Makefileæ–‡ä»¶çš„ç¬¬ä¸€ä¸ªç›®æ ‡worldæ²¡æœ‰ä¾èµ–å’Œå‘½ä»¤ã€‚å®ƒä¸»è¦èµ·åˆ°æŒ‡ç¤º å½“makeå‘½ä»¤ä¸å¸¦ç›®æ ‡æ—¶æ‰€è¦æ‰§è¡Œçš„ç›®æ ‡ï¼Œæ²¡æœ‰è®¾å®šä¾èµ–å’Œå‘½ä»¤éƒ¨åˆ†è¡¨æ˜æ­¤ç›®æ ‡åœ¨æ­¤åå°†ä¼šæœ‰å…¶ä»–ä¾èµ–å…³ç³»æˆ–å‘½ä»¤ã€‚worldç›®æ ‡çš„å‘½ä»¤éœ€è¦è¿›ä¸€æ­¥å‚ è€ƒ$(TOPDIR)&#x2F;include&#x2F;toplevel.mkå’Œä¸»Makefileæ–‡ä»¶çš„å†æ¬¡æ‰§è¡Œéƒ¨åˆ†ã€‚<br>é¦–æ¬¡æ‰§è¡Œéƒ¨åˆ†<br>OPENWRT_BUILDæ˜¯åŒºåˆ†é¦–æ¬¡æ‰§è¡Œä¸å†æ¬¡æ‰§è¡Œçš„å˜é‡ã€‚åœ¨é¦–æ¬¡æ‰§è¡Œæ—¶ä½¿ç”¨å¼ºåˆ¶èµ‹å€¼æŒ‡ç¤ºç¬¦overrideæŠŠOPENWRT_BUILDèµ‹å€¼ä¸º1ï¼Œå¹¶ ä½¿ç”¨å˜é‡å»¶ä¼¸æŒ‡ç¤ºç¬¦exportæŠŠOPENWRT_BUILDå»¶ä¼¸ã€‚åœ¨OPENWRT_BUILDä½¿ç”¨å¼ºåˆ¶èµ‹å€¼æŒ‡ç¤ºç¬¦overrideæ„å‘³ç€makeå‘½ä»¤ è¡Œå¯èƒ½å¼•å…¥OPENWRT_BUILDå‚æ•°ã€‚<br>å¼•å…¥$(TOPDIR)&#x2F;include&#x2F;debug.mkã€$(TOPDIR)&#x2F;include&#x2F;depends.mkã€$(TOPDIR) &#x2F;include&#x2F;toplevel.mkä¸‰ä¸ªæ–‡ä»¶ï¼Œç”±äºTOPDIRæ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ä¸‰ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯å›ºå®šçš„ã€‚å…¶ä¸­$(TOPDIR)&#x2F;include &#x2F;toplevel.mkçš„135è¡Œ%::æœ‰æ•ˆè§£é‡Šé¦–æ¬¡æ‰§è¡Œæ—¶worldç›®æ ‡çš„è§„åˆ™ã€‚<br>å†æ¬¡æ‰§è¡Œéƒ¨åˆ†<br>å¼•å…¥rules.mkã€$(INCLUDE_DIR)&#x2F;depends.mkã€$(INCLUDE_DIR)&#x2F;subdir.mkã€target &#x2F;Makefileã€package&#x2F;Makefileã€tools&#x2F;Makefileã€toolchain&#x2F;Makefileä¸ƒä¸ªæ–‡ ä»¶ï¼Œrules.mkæ²¡æœ‰ç›®å½•åï¼Œå³å¼•å…¥ä¸ä¸»Makefileæ–‡ä»¶ç›®å½•ç›¸åŒçš„rules.mkã€‚åœ¨rules.mkå®šä¹‰äº†INCLUDE_DIR ä¸º$(TOPDIR)&#x2F;includeï¼Œæ‰€ä»¥$(INCLUDE_DIR)&#x2F;depends.mkå®é™…ä¸Šä¸é¦–æ¬¡æ‰§è¡Œæ—¶å¼•å…¥çš„$(TOPDIR) &#x2F;include&#x2F;depends.mkæ˜¯åŒä¸€ä¸ªæ–‡ä»¶ã€‚<br>å››ä¸ªå­ç›®å½•ä¸‹çš„Makefileå®é™…ä¸Šæ˜¯ä¸èƒ½ç‹¬ç«‹æ‰§è¡Œã€‚ä¸»è¦åˆ©ç”¨$(INCLUDE_DIR)&#x2F;subdir.mkåŠ¨æ€å»ºç«‹è§„åˆ™ï¼Œè¯¸ å¦‚$(toolchain&#x2F;stamp-install)ç›®æ ‡æ˜¯é $(INCLUDE_DIR)&#x2F;subdir.mkçš„stampfileå‡½æ•°åŠ¨æ€å»ºç«‹ã€‚ åœ¨package&#x2F;MakefileåŠ¨æ€å»ºç«‹äº†$(package&#x2F; stamp-prereq)ã€$(package&#x2F; stamp-cleanup)ã€$(package&#x2F; stamp-compile)ã€$(package&#x2F; stamp-install)ã€$(package&#x2F; stamp-rootfs-prepare)ç›®æ ‡ã€‚<br>å®šä¹‰ä¸€äº›ä½¿ç”¨å˜é‡å‘½åçš„ç›®æ ‡ï¼Œå…¶å˜é‡çš„èµ‹å€¼ä½ç½®åœ¨$(INCLUDE_DIR)&#x2F;subdir.mkçš„stampfileå‡½æ•°ä¸­ã€‚ç›®æ ‡åªæœ‰ä¾èµ–å…³ç³»ï¼Œå¯èƒ½ è¯´æ˜å…¶å·¥ä½œé¡ºåºï¼Œåœ¨$(INCLUDE_DIR)&#x2F;subdir.mkçš„stampfileå‡½æ•°ä¸­æœ‰è¿›ä¸€æ­¥è¯´æ˜å…¶ç›®æ ‡æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¹¶ä¸ºç›®æ ‡å»ºç«‹ä¸€ä¸ªç©ºæ–‡ ä»¶ï¼Œå³ä½¿ç”¨å˜é‡å‘½åçš„ç›®æ ‡ä¸ºçœŸå®çš„æ–‡ä»¶ã€‚<br>å®šä¹‰ä¸€äº›ä½¿ç”¨å›ºå®šçš„ç›®æ ‡è§„åˆ™ã€‚<br>å…¶ä¸­ï¼šcleanæ˜¯æ¸…é™¤ç¼–è¯‘ç»“æœçš„ç›®æ ‡ï¼Œæ¸…é™¤$(BUILD_DIR) $(BIN_DIR) $(BUILD_LOG_DIR)ä¸‰ä¸ªç›®å½•çš„ç”¨æ„æ˜¯ååˆ†æ˜ç¡®ã€‚æš‚æ—¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ‰§è¡Œmake target&#x2F;linux&#x2F;cleanã€‚<br>dircleanæ˜¯åˆ é™¤æ‰€æœ‰ç¼–è¯‘è¿‡ç¨‹äº§ç”Ÿçš„ç›®å½•å’Œæ–‡ä»¶çš„ç›®æ ‡ï¼Œæ‰§è¡Œdircleanç›®æ ‡ä¾èµ–äºcleanï¼Œå› æ­¤å°†æ‰§è¡Œcleanç›®æ ‡æ‰€æ‰§è¡Œçš„å‘½ä»¤ï¼Œç„¶ååˆ  é™¤$(STAGING_DIR) $(STAGING_DIR_HOST) $(STAGING_DIR_TOOLCHAIN) $(TOOLCHAIN_DIR) $(BUILD_DIR_HOST) $(BUILD_DIR_TOOLCHAIN)ç›®å½•ï¼Œä»¥åŠåˆ é™¤$(TMP_DIR)ç›®å½•ã€‚ä¸Šè¿°ç›®å½•çš„å˜é‡å‡åœ¨rules.mkå®šä¹‰ã€‚å¥½åƒåˆ é™¤ staging_dirç›®å½•å°±æ„å‘³ç€åˆ é™¤staging_dirç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦å¼ºè°ƒåˆ é™¤$(STAGING_DIR_HOST) $(STAGING_DIR_TOOLCHAIN) $(TOOLCHAIN_DIR)ç›®å½•ã€‚åŒæ ·åˆ é™¤builde_dirç›®å½•å°±æ„å‘³ç€åˆ é™¤builde_dirç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦å¼ºè°ƒåˆ  é™¤$(BUILD_DIR_TOOLCHAIN)ç›®å½•ã€‚<br>tmp&#x2F;.prereq_packagesç›®æ ‡æ˜¯å¯¹æ‰€éœ€è½¯ä»¶åŒ…çš„é¢„å¤„ç†ã€‚ç›®æ ‡ä¾èµ–äº.configï¼Œå³æ‰§è¡Œmake menuconfigåå°†ä¼šè¿›è¡Œä¸€æ¬¡æ‰€éœ€è½¯ä»¶åŒ…çš„é¢„å¤„ç†ã€‚ä¸çŸ¥ä»€ä¹ˆåŸå› åœ¨ç¼–è¯‘å‰åˆ é™¤tmpç›®å½•ï¼Œæ‰§è¡Œæ—¶æ— æ³•å»ºç«‹tmp&#x2F;.prereq_packages æ–‡ä»¶ã€‚<br>prereqåº”è¯¥æ˜¯é¢„è¯·æ±‚ç›®æ ‡ï¼Œåœ¨OpenWrtæ‰§è¡ŒMakefileæ—¶å¥½åƒéƒ½è¦å…ˆæ‰§è¡Œprereqç›®æ ‡ã€‚<br>prepareåº”è¯¥æ˜¯å‡†å¤‡ç›®æ ‡ï¼Œæ˜¯worldä¾èµ–çš„ä¸€ä¸ªä¼ªç›®æ ‡ã€‚ä¾èµ–äºæ–‡ä»¶.configå’Œ$(tools&#x2F;stamp-install) $(toolchain&#x2F;stamp-install)ç›®æ ‡ã€‚<br>worldå°±æ˜¯ç¼–è¯‘çš„ç›®æ ‡ã€‚ä¾èµ–äºprepareä¸ºç›®æ ‡å’Œå‰é¢æåˆ°çš„å˜é‡å‘½åç›®æ ‡ã€‚é‡‡ç”¨å–æ¶ˆéšå«è§„åˆ™æ–¹å¼æ‰§è¡Œpackage&#x2F;indexç›®æ ‡ã€‚package&#x2F;indexç›®æ ‡åœ¨package&#x2F;Makefileçš„92è¡Œå®šä¹‰ã€‚<br>package&#x2F;symlinkså’Œpackage&#x2F;symlinks-installæ˜¯æ›´æ–°æˆ–å®‰è£…è½¯ä»¶åŒ…æ¥æºçš„ç›®æ ‡ï¼Œä½¿ç”¨$(SCRIPT_DIR)&#x2F;feedsè„šæœ¬æ–‡ä»¶å®Œæˆã€‚<br>package&#x2F;symlinks-cleanæ˜¯æ¸…é™¤è½¯ä»¶åŒ…æ¥æºçš„ç›®æ ‡ï¼Œä¹Ÿæ˜¯ä½¿ç”¨$(SCRIPT_DIR)&#x2F;feedsè„šæœ¬æ–‡ä»¶å®Œæˆã€‚<br>æœ€åä½¿ç”¨ä¼ªç›®æ ‡.PHONYè¯´æ˜clean dirclean prereq prepare world package&#x2F;symlinks package&#x2F;symlinks-install package&#x2F;symlinks-cleanå±äºä¼ªç›®æ ‡ã€‚é€šè¿‡ä¼ªç›®æ ‡è¯´æ˜å¯ä»¥çŸ¥é“å¯ä»¥æ‰§è¡Œçš„ç›®æ ‡ã€‚</p>
<h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p>Openwrtå®˜ç½‘<a target="_blank" rel="noopener" href="http://wiki.openwrt.org/start">http://wiki.openwrt.org/start</a></p>
<p>è½¯ä»¶åŒ…ç›¸å…³ï¼š<a target="_blank" rel="noopener" href="https://dev.openwrt.org/browser/branches/packages_10.03.2?order=name">https://dev.openwrt.org/browser/branches/packages_10.03.2?order=name</a></p>
<p>å…³äºåŒ…çš„ä¾èµ–é—®é¢˜ï¼š<a target="_blank" rel="noopener" href="http://wiki.openwrt.org/doc/devel/dependencies">http://wiki.openwrt.org/doc/devel/dependencies</a></p>
<h1 id="é—®é¢˜è®°å½•ï¼š"><a href="#é—®é¢˜è®°å½•ï¼š" class="headerlink" title="é—®é¢˜è®°å½•ï¼š"></a>é—®é¢˜è®°å½•ï¼š</h1><h2 id="ï¼ˆ1ï¼‰ã€closeã€‘åœ¨ç§»æ¤exfaté©±åŠ¨åˆ°openwrtæ—¶é‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š"><a href="#ï¼ˆ1ï¼‰ã€closeã€‘åœ¨ç§»æ¤exfaté©±åŠ¨åˆ°openwrtæ—¶é‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š" class="headerlink" title="ï¼ˆ1ï¼‰ã€closeã€‘åœ¨ç§»æ¤exfaté©±åŠ¨åˆ°openwrtæ—¶é‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š"></a>ï¼ˆ1ï¼‰ã€closeã€‘åœ¨ç§»æ¤exfaté©±åŠ¨åˆ°openwrtæ—¶é‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š</h2><p>nickli@NewRouterDev:qsdk$ make package&#x2F;exfat&#x2F;{clean,prepare,compile,install} V&#x3D;99</p>
<p>Collecting package info: done</p>
<p>make[1]: Entering directory &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdkâ€™</p>
<p>make[2]: Entering directory &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;package&#x2F;exfatâ€™</p>
<p>Makefile:56: warning: overriding commands for target &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;exfatâ€™</p>
<p>Makefile:56: warning: ignoring old commands for target &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;exfatâ€™</p>
<p>Makefile:56: warning: overriding commands for target &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;exfatâ€™</p>
<p>Makefile:56: warning: ignoring old commands for target &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;exfatâ€™</p>
<p>rm -f &#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;staging_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;stamp&#x2F;.exfat _installed</p>
<p>bash: line 2: [: packages&#x2F;exfat: binary operator expected</p>
<p>rm -f &#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;bin&#x2F;ipq806x&#x2F;packages&#x2F;exfat_*</p>
<p>rm -f &#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;staging_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;packages&#x2F;exfat .list &#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;staging_dir&#x2F;host&#x2F;packages&#x2F;exfat .list</p>
<p>rm -rf &#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;exfat</p>
<p>make[2]: Leaving directory &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;package&#x2F;exfatâ€™</p>
<p>make[1]: Leaving directory &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdkâ€™</p>
<p>make[1]: Entering directory &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdkâ€™</p>
<p>make[2]: Entering directory &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;package&#x2F;exfatâ€™</p>
<p>Makefile:56: *** target file &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;exfatâ€™ has both : and :: entries. Stop.</p>
<p>make[2]: Leaving directory &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;package&#x2F;exfatâ€™</p>
<p>make[1]: *** [package&#x2F;exfat&#x2F;prepare] Error 2</p>
<p>make[1]: Leaving directory &#96;&#x2F;home&#x2F;nickli&#x2F;puma_sdk&#x2F;qualcomm_sdk&#x2F;qsdkâ€™</p>
<p>make: *** [package&#x2F;exfat&#x2F;prepare] Error 2</p>
<p>é—®é¢˜åŸå› ï¼šåœ¨Makefileä¸­ç‰ˆæœ¬å·å˜é‡åé¢å¤šäº†ä¸ªç©ºæ ¼ã€‚</p>
<p>PKG_NAME:&#x3D;exfat</p>
<p>PKG_VERSION:&#x3D;0.9.5$space_char</p>
<p>PKG_RELEASE:&#x3D;1</p>
<p>è§£å†³æ–¹æ³•ï¼šå°†ç‰ˆæœ¬å·åé¢çš„ç©ºæ ¼å»æ‰</p>
<p>ç»“æœï¼šé—®é¢˜è§£å†³ã€‚</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://forum.openwrt.org/viewtopic.php?id=20353">https://forum.openwrt.org/viewtopic.php?id=20353</a></p>
<h2 id="ï¼ˆ2ï¼‰ã€closeã€‘SDKä¿®æ”¹ç›®å½•åç§°åæ— æ³•ç»§ç»­ç¼–è¯‘é—®é¢˜è§£å†³"><a href="#ï¼ˆ2ï¼‰ã€closeã€‘SDKä¿®æ”¹ç›®å½•åç§°åæ— æ³•ç»§ç»­ç¼–è¯‘é—®é¢˜è§£å†³" class="headerlink" title="ï¼ˆ2ï¼‰ã€closeã€‘SDKä¿®æ”¹ç›®å½•åç§°åæ— æ³•ç»§ç»­ç¼–è¯‘é—®é¢˜è§£å†³"></a>ï¼ˆ2ï¼‰ã€closeã€‘SDKä¿®æ”¹ç›®å½•åç§°åæ— æ³•ç»§ç»­ç¼–è¯‘é—®é¢˜è§£å†³</h2><p>é—®é¢˜ç°è±¡ï¼šcheck äº†ä¸€ä»½openwrtçš„SDKï¼Œæ‰§è¡Œç¼–è¯‘ä¹‹ååˆé‡æ–°ä¿®æ”¹äº†è¯¥SDKçš„åç§°ï¼Œå¯¼è‡´åç»­å†ç¼–è¯‘æ—¶æ— æ³•ç¼–è¯‘ã€‚</p>
<p>åŸå› ï¼šæœ‰äº›ç¼–è¯‘å™¨æ˜¯åŠ¨æ€ç¼–è¯‘ç”Ÿæˆçš„ï¼Œä½†æ˜¯make cleanä¹‹åç¼–è¯‘å™¨ä¸ä¼šé‡æ–°ç¼–è¯‘ï¼Œå…¶è·¯å¾„ä¸ç»å¯¹è·¯å¾„æœ‰å…³ï¼Œä¿®æ”¹åç§°åæ— æ³•æ‰¾åˆ°ç›¸å…³ç¼–è¯‘å™¨ã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼šè¿›å…¥SDKæ ¹ç›®å½•æ‰§è¡Œmake distcleanï¼Œå°†æ‰€æœ‰ç¼–è¯‘è®°å½•å®Œæ•´æ¸…é™¤å³å¯ã€‚</p>
<p>ç»“æœï¼šé—®é¢˜è§£å†³ï¼ˆåº”è¯¥æœ‰æ›´åŠ ä¼˜åŒ–çš„æ–¹æ³•ï¼Œå³åˆ é™¤å…¶ä¸­äº¤å‰ç¼–è¯‘é“¾ç›¸å…³å†…å®¹ï¼Œåç»­æœ‰æ—¶é—´å†è§£å†³ï¼‰</p>
<h2 id="ï¼ˆ3ï¼‰ã€closeã€‘ç¼–è¯‘å•ä¸ªæ¨¡å—è½¯ä»¶æ—¶ï¼Œæç¤ºç¼ºå°‘Cåº“"><a href="#ï¼ˆ3ï¼‰ã€closeã€‘ç¼–è¯‘å•ä¸ªæ¨¡å—è½¯ä»¶æ—¶ï¼Œæç¤ºç¼ºå°‘Cåº“" class="headerlink" title="ï¼ˆ3ï¼‰ã€closeã€‘ç¼–è¯‘å•ä¸ªæ¨¡å—è½¯ä»¶æ—¶ï¼Œæç¤ºç¼ºå°‘Cåº“"></a>ï¼ˆ3ï¼‰ã€closeã€‘ç¼–è¯‘å•ä¸ªæ¨¡å—è½¯ä»¶æ—¶ï¼Œæç¤ºç¼ºå°‘Cåº“</h2><p>ç¼–è¯‘å•ä¸ªæ¨¡å—è½¯ä»¶æ—¶ï¼Œåœ¨æœ€åä¸€æ­¥æ‰§è¡Œæ‰“åŒ…æ“ä½œæ—¶æç¤ºç¼ºå°‘libc.so.6è€Œæ— æ³•æ‰“åŒ…ï¼Œä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<p>Package skysoft_net6scan is missing dependencies for the following libraries:</p>
<p>libc.so.6</p>
<p>åŸå› ï¼šç¼–è¯‘å•ä¸ªæ¨¡å—æ—¶ï¼Œç¼ºå°‘ç›®æ ‡å¹³å°ç›¸åŒçš„libc.so.6æ–‡ä»¶ã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="http://my.oschina.net/hevakelcj/blog/411944">http://my.oschina.net/hevakelcj/blog/411944</a></p>
<p>çœŸæ­£è§£å†³é—®é¢˜çš„å‚è€ƒï¼š<a target="_blank" rel="noopener" href="http://www.cnblogs.com/liushannet/p/3895092.html">http://www.cnblogs.com/liushannet/p/3895092.html</a></p>
<p>æŸ¥çœ‹ä¾èµ–æ–‡ä»¶ï¼š</p>
<p>nickli@NewRouterDev:qsdk$ readelf -d build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;skysoft_net6scan&#x2F;net6scan</p>
<p>Dynamic section at offset 0x2e28 contains 24 entries:</p>
<p>Tag    Type             Name&#x2F;Value</p>
<p>0x0000000000000001 (NEEDED)       Shared library: [libc.so.6]</p>
<p>0x000000000000000c (INIT)        0x400c28</p>
<p>0x000000000000000d (FINI)        0x401ad0</p>
<p>0x0000000000000019 (INIT_ARRAY)     0x602e10</p>
<p>0x000000000000001b (INIT_ARRAYSZ)    8 (bytes)</p>
<p>0x000000000000001a (FINI_ARRAY)     0x602e18</p>
<p>0x000000000000001c (FINI_ARRAYSZ)    8 (bytes)</p>
<p>0x000000006ffffef5 (GNU_HASH)      0x400298</p>
<p>å®é™…è§£å†³æ–¹æ³•ï¼š</p>
<p>å…ˆæ£€æŸ¥ç³»ç»Ÿé‡Œé¢æœ‰æ²¡æœ‰è¿™ä¸ªåº“å­˜åœ¨,å¦‚æœæ²¡æœ‰,å®‰è£… (åœ¨&#x2F;lib &#x2F;lib64 ç­‰ç›®å½•æ‰¾)<br>ä¹‹åæ·»åŠ åº“openwrtçš„ç¼–è¯‘ç¯å¢ƒ<br>ä¿®æ”¹ libc.provides å¹³å°ä¸åŒ,å¯èƒ½ç›®å½•ä¸åŒ,find .&#x2F;stagging_dir -name libc.provides ä¸‹<br>ä¸€èˆ¬åœ¨ stagging_dir&#x2F;target-mipsel_r2_uClibc-0.9.33.2&#x2F;pkginfo&#x2F;libc.provides<br>åº•éƒ¨æ·»åŠ <br>libc.so.6<br>æˆ–å…¶ä»–éœ€è¦çš„åº“,ç¼–è¯‘æ—¶å€™ä¼šæŠŠè¿™ä¸ªsoè½¬ä¸ºopenwrtå¹³å°çš„åº“</p>
<p>ç›¸å…³å‘½ä»¤ï¼š</p>
<p>1332 find &#x2F;lib* -name â€œlibc.so.6â€</p>
<p>1333 find .&#x2F;staging_dir&#x2F; -name libc.provides</p>
<p>1334 vim .&#x2F;staging_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;pkginfo&#x2F;libc.provides</p>
<p>åœ¨è¯¥æ–‡ä»¶æœ«å°¾æ·»åŠ libc.so.6åä¿å­˜å¹¶é€€å‡ºï¼Œä¹‹åæ‰§è¡Œç¼–è¯‘ï¼š</p>
<p>1335 make package&#x2F;skysoft_net6scan&#x2F;{clean,prepare,compile,install} V&#x3D;99</p>
<p>èƒ½æ­£å¸¸æ‰“åŒ…äº†ï¼</p>
<p>ç»“æœï¼šé—®é¢˜è§£å†³ã€‚</p>
<h2 id="ï¼ˆ4ï¼‰ã€closeã€‘ç¼–è¯‘çš„æ¨¡å—æ— æ³•åœ¨opentwrç³»ç»Ÿä¸­è¿è¡Œ"><a href="#ï¼ˆ4ï¼‰ã€closeã€‘ç¼–è¯‘çš„æ¨¡å—æ— æ³•åœ¨opentwrç³»ç»Ÿä¸­è¿è¡Œ" class="headerlink" title="ï¼ˆ4ï¼‰ã€closeã€‘ç¼–è¯‘çš„æ¨¡å—æ— æ³•åœ¨opentwrç³»ç»Ÿä¸­è¿è¡Œ"></a>ï¼ˆ4ï¼‰ã€closeã€‘ç¼–è¯‘çš„æ¨¡å—æ— æ³•åœ¨opentwrç³»ç»Ÿä¸­è¿è¡Œ</h2><p>root@rt4230w:~# &#x2F;sbin&#x2F;net6scan</p>
<p>&#x2F;sbin&#x2F;net6scan: line 1: syntax error: unexpected â€œ(â€</p>
<p>é—®é¢˜åŸå› ï¼šåœ¨ç¼–è¯‘çš„æ¨¡å—Makefileä¸­å°†ç¼–è¯‘å™¨å†™æ­»æˆäº†gccï¼Œè€Œå®é™…ä¸Šç›®æ ‡å¹³å°ä¸ºarméœ€è¦ä½¿ç”¨äº¤å‰ç¼–è¯‘å™¨ã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼šä¿®æ”¹æºç å†…çš„makefileï¼Œå°†gcc æ”¹æˆ$(CC)ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<p>CFLAGS +&#x3D; -Wall -D_GNU_SOURCE net6scan : main.o func.o$(CC) $(CFLAGS) -o net6scan main.o func.omain.o : main.c$(CC) $(CFLAGS) -c main.cfunc.o : func.c$(CC) $(CFLAGS) -c func.cclean:rm -rf ip6scan *.o</p>
<p>ç»“æœï¼šé—®é¢˜è§£å†³</p>
<h2 id="ï¼ˆ5ï¼‰ã€closeã€‘åœ¨åŸodhcp6cæºç ä¸­å¢åŠ äº†log-c-log-hæ–‡ä»¶åï¼Œç¼–è¯‘æ—¶å‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š"><a href="#ï¼ˆ5ï¼‰ã€closeã€‘åœ¨åŸodhcp6cæºç ä¸­å¢åŠ äº†log-c-log-hæ–‡ä»¶åï¼Œç¼–è¯‘æ—¶å‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š" class="headerlink" title="ï¼ˆ5ï¼‰ã€closeã€‘åœ¨åŸodhcp6cæºç ä¸­å¢åŠ äº†log.c log.hæ–‡ä»¶åï¼Œç¼–è¯‘æ—¶å‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š"></a>ï¼ˆ5ï¼‰ã€closeã€‘åœ¨åŸodhcp6cæºç ä¸­å¢åŠ äº†log.c log.hæ–‡ä»¶åï¼Œç¼–è¯‘æ—¶å‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š</h2><p>make[3]: Entering directory &#96;&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13â€²</p>
<p>make[4]: Entering directory &#96;&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13â€²</p>
<p>make[5]: Entering directory &#96;&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13â€²</p>
<p>make[5]: Leaving directory &#96;&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13â€²</p>
<p>make[5]: Entering directory &#96;&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13â€²</p>
<p>[ 16%] Building C object CMakeFiles&#x2F;odhcp6c.dir&#x2F;src&#x2F;odhcp6c.c.o</p>
<p>[ 33%] Building C object CMakeFiles&#x2F;odhcp6c.dir&#x2F;src&#x2F;log.c.o</p>
<p>&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13&#x2F;src&#x2F;log.c: In function â€˜_get_timeâ€™:</p>
<p>&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13&#x2F;src&#x2F;log.c:117:9: error: missing initializer [-Werror&#x3D;missing-field-initializers]</p>
<p>&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13&#x2F;src&#x2F;log.c:117:9: error: (near initialization for â€˜tv.tv_usecâ€™) [-Werror&#x3D;missing-field-initializers]</p>
<p>&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13&#x2F;src&#x2F;log.c:118:9: error: missing initializer [-Werror&#x3D;missing-field-initializers]</p>
<p>&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13&#x2F;src&#x2F;log.c:118:9: error: (near initialization for â€˜time_value.tm_minâ€™) [-Werror&#x3D;missing-field-initializers]</p>
<p>&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13&#x2F;src&#x2F;log.c: In function â€˜debug_log_printâ€™:</p>
<p>&#x2F;home&#x2F;nickli&#x2F;cascade_sdk_new_platform&#x2F;qualcomm_sdk&#x2F;qsdk&#x2F;build_dir&#x2F;target-arm_v7-a_uClibc-0.9.33.2_eabi&#x2F;odhcp6c-2015-07-13&#x2F;src&#x2F;log.c:140:51: error: comparison between signed and unsigned integer expressions [-Werror&#x3D;sign-compare]</p>
<p>cc1: all warnings being treated as errors</p>
<p>åˆ†æï¼šerror: missing initializer [-Werror&#x3D;missing-field-initializers]ï¼Œåº”è¯¥æ˜¯ç¼–è¯‘ç¨‹åºæ—¶å°†è­¦å‘Šå½“é”™è¯¯äº†ï¼Œæç¤ºè¿™é‡Œéœ€è¦åˆå§‹åŒ–ï¼Œè€Œå®é™…ä¸Šä¸€æ—¶é—´æ²¡æœ‰ çœ‹å‡ºå“ªå„¿æ¥æ‰§è¡Œæ­£ç¡®çš„åˆå§‹åŒ–ï¼Œæ‰€ä»¥ä»å–æ¶ˆæ‰è¿™ç§è­¦å‘Šæœºåˆ¶ç€æ‰‹è§£å†³ã€‚</p>
<p>è§£å†³åŠæ³•ï¼šä¿®æ”¹ç¼–è¯‘ç›®å½•å†…çš„(build_dirvim) CMakeLists.txtæ–‡ä»¶ï¼Œå°†-Werroræ”¹ä¸º-Wno-missing-field-initializersï¼Œå¦‚ä¸‹ï¼š</p>
<p>8 #add_definitions(-D_GNU_SOURCE -Wall -Werror -Wextra -pedantic)</p>
<p>9 add_definitions(-D_GNU_SOURCE -Wall â€“Wno-missing-field-initializers -Wextra -pedantic)</p>
<p>ç»“æœï¼šé—®é¢˜è§£å†³ã€‚</p>
<p>å°ç»“ï¼š</p>
<p>ï¼ˆ1ï¼‰-Werror é€‰çº¿ä¼šå°†è­¦å‘Šå‡çº§ä¸ºé”™è¯¯æ¥æŠ¥å‘Š</p>
<p>ï¼ˆ2ï¼‰odhcp6cæºç ç¼–è¯‘é‡‡ç”¨äº†Cmakeè€Œæ²¡æœ‰ä½¿ç”¨æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„æ–¹å¼â€”â€”åœ¨srcç›®å½•å†…å†™ä¸€ä»½Makefileæ–‡ä»¶æ¥ç¼–è¯‘æ–‡ä»¶ï¼Œæ‰€ä»¥å…¶è§„åˆ™æ–‡ä»¶éƒ½åœ¨å’Œsrcç›®å½•åŒçº§çš„CMakeLists.txtæ–‡ä»¶ä¸­ã€‚å¯ä»¥å­¦ä¹ äº†è§£ä¸€ä¸‹CMakeæœºåˆ¶ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://blog.wwang.pw">XiaoWanğŸ’¦</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://blog.wwang.pw/post/openwrt-docs.html">https://blog.wwang.pw/post/openwrt-docs.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://blog.wwang.pw" target="_blank">æ—¶å…‰'s Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/OpenWRT/">OpenWRT</a></div><div class="post_share"><div class="social-share" data-image="https://jsd.cdn.zzko.cn/gh/xiaowansm5/img@master/ecy/982257.1hk8iymuua80.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/hiwifi.html"><img class="prev-cover" src="https://jsd.cdn.zzko.cn/gh/xiaowansm5/img@master/ecy/saonv.1j87964cttz4.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">æè·¯ç”±ç³»åˆ—åˆ·è€æ¯›å­å›ºä»¶åæœä¸åˆ°WiFiçš„è§£å†³åŠæ³•</div></div></a></div><div class="next-post pull-right"><a href="/post/openwrt-docs1.html"><img class="next-cover" src="https://jsd.cdn.zzko.cn/gh/xiaowansm5/img@master/ecy/949379.2eki0la5kps0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">OpenWrtå¸¸ç”¨å‘½ä»¤è¯¦è§£</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://jsd.cdn.zzko.cn/gh/xiaowansm5/img@master/æ—¶å…‰.54dv9r8g4dk0.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">XiaoWanğŸ’¦</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">118</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">106</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xiaowansm5/"><i class="fab fa-github"></i><span>å…³æ³¨æˆ‘</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xiaowansm5/" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:wwang.pw@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://wpa.qq.com/msgrd?v=3&amp;uin=85151535" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://t.me/xiaowan_sm" target="_blank" title="Telegram"><i class="fab fa-telegram"></i></a><a class="social-icon" href="https://pan.wwang.pw/" target="_blank" title="ç½‘ç›˜"><i class="fa-solid fa-cloud-arrow-down"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">å¦‚æœä½ åœ¨ä½¿ç”¨ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥åŠ QQç¾¤æˆ–TGç¾¤è¿›è¡Œåé¦ˆ<div class="social-button"><a class="button--animated" href="https://ai.wwang.eu.org/" rel="external nofollow noreferrer" target="_blank">ChatGPTé•œåƒç«™ğŸ¤–</a> <a class="button--animated" href="https://jq.qq.com/?_wv=1027&k=iChIlJ4q" rel="external nofollow noreferrer" target="_blank">QQ2ç¾¤ğŸ‘</a><a class="button--animated" href="https://t.me/xiaowansm" rel="external nofollow noreferrer" target="_blank">TGç¾¤ğŸ‘</a></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#OpenWRT%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">OpenWRTåŸºæœ¬çŸ¥è¯†æ•´ç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-OpenWRT%E8%99%9A%E6%8B%9F%E7%B3%BB%E7%BB%9F%E5%87%86%E5%A4%87"><span class="toc-number">2.</span> <span class="toc-text">1.OpenWRTè™šæ‹Ÿç³»ç»Ÿå‡†å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E7%BC%96%E8%AF%91openwrt%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.1.</span> <span class="toc-text">1.1.ç¼–è¯‘openwrtè™šæ‹Ÿæœºç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-%E5%87%86%E5%A4%87%E6%BA%90%E7%A0%81"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.1.1 å‡†å¤‡æºç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-%E5%87%86%E5%A4%87%E6%BA%90%E7%A0%81%E5%8C%85"><span class="toc-number">2.1.2.</span> <span class="toc-text">1.1.2 å‡†å¤‡æºç åŒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-3-%E7%BC%96%E8%AF%91%E9%85%8D%E7%BD%AE"><span class="toc-number">2.1.3.</span> <span class="toc-text">1.1.3 ç¼–è¯‘é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-4-%E7%BC%96%E8%AF%91"><span class="toc-number">2.1.4.</span> <span class="toc-text">1.1.4 ç¼–è¯‘</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">2.2.</span> <span class="toc-text">1.2.å®‰è£…è™šæ‹Ÿæœº</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-%E6%96%B0%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.2.1.æ–°å»ºè™šæ‹Ÿæœº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-%E4%BF%AE%E6%94%B9%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-number">2.2.2.</span> <span class="toc-text">1.2.2.ä¿®æ”¹è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶ï¼š</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">2.é…ç½®ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E8%AE%BE%E7%BD%AEroot%E5%AF%86%E7%A0%81"><span class="toc-number">3.1.</span> <span class="toc-text">2.1.è®¾ç½®rootå¯†ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="toc-number">3.2.</span> <span class="toc-text">2.2.ç½‘ç»œé…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E5%85%B3%E4%BA%8Essh"><span class="toc-number">3.3.</span> <span class="toc-text">2.3.å…³äºssh</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">3.è½¯ä»¶å®‰è£…æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85ipk%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="toc-number">4.1.</span> <span class="toc-text">3.1.æœ¬åœ°å®‰è£…ipkè½¯ä»¶åŒ…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%8F%8A%E8%AE%BE%E7%BD%AE"><span class="toc-number">4.2.</span> <span class="toc-text">3.2.åœ¨çº¿å®‰è£…è½¯ä»¶åŠè®¾ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E8%AE%BE%E7%BD%AE%E8%BD%AF%E4%BB%B6%E6%BA%90"><span class="toc-number">4.2.1.</span> <span class="toc-text">3.2.1.è®¾ç½®è½¯ä»¶æº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6"><span class="toc-number">4.2.2.</span> <span class="toc-text">3.2.2.å®‰è£…è½¯ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-%E7%9B%B4%E6%8E%A5%E5%AE%89%E8%A3%85"><span class="toc-number">4.2.3.</span> <span class="toc-text">3.2.3.ç›´æ¥å®‰è£…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E4%BD%BF%E7%94%A8%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%81%9A%E8%BD%AF%E4%BB%B6%E6%BA%90%E4%BB%A5%E5%AE%89%E8%A3%85%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BD%AF%E4%BB%B6"><span class="toc-number">4.3.</span> <span class="toc-text">3.3.ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨åšè½¯ä»¶æºä»¥å®‰è£…è‡ªå®šä¹‰è½¯ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1-%E5%9C%A8%E7%BC%96%E8%AF%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%85%8D%E7%BD%AEvsftp%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">4.3.1.</span> <span class="toc-text">3.3.1.åœ¨ç¼–è¯‘æœåŠ¡å™¨ä¸Šé…ç½®vsftpæœåŠ¡å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2-%E4%BF%AE%E6%94%B9openwrt%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E6%BA%90"><span class="toc-number">4.3.2.</span> <span class="toc-text">3.3.2.ä¿®æ”¹openwrtåœ¨çº¿å®‰è£…è½¯ä»¶æº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-3%E6%9B%B4%E6%96%B0opkg"><span class="toc-number">4.3.3.</span> <span class="toc-text">3.3.3æ›´æ–°opkg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-3-%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E5%AE%89%E8%A3%85ipk%E8%BD%AF%E4%BB%B6"><span class="toc-number">4.3.4.</span> <span class="toc-text">3.3.3.é€šè¿‡å‘½ä»¤å®‰è£…ipkè½¯ä»¶</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-openwrt-SDK%E6%BA%90%E7%A0%81%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">5.</span> <span class="toc-text">4.openwrt SDKæºç ç›®å½•ç»“æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD"><span class="toc-number">5.1.</span> <span class="toc-text">4.1.æºç ä¸‹è½½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-OpenWRT%E7%9A%84feeds"><span class="toc-number">5.2.</span> <span class="toc-text">4.2.OpenWRTçš„feeds</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-OpenWrt%E6%BA%90%E7%A0%81%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">5.3.</span> <span class="toc-text">4.3.OpenWrtæºç ç›®å½•ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D"><span class="toc-number">5.4.</span> <span class="toc-text">4.4.åŸºæœ¬å‘½ä»¤ä»‹ç»</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E7%94%A8%E6%88%B7%E5%B1%82%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91%E6%96%B9%E6%B3%95"><span class="toc-number">6.</span> <span class="toc-text">5.ç”¨æˆ·å±‚æ¨¡å—å¼€å‘æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-SDK%E5%87%86%E5%A4%87"><span class="toc-number">6.1.</span> <span class="toc-text">5.1.SDKå‡†å¤‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E6%B7%BB%E5%8A%A0%E6%A8%A1%E5%9D%97%E4%BB%A3%E7%A0%81"><span class="toc-number">6.2.</span> <span class="toc-text">5.2.æ·»åŠ æ¨¡å—ä»£ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E6%A8%A1%E5%9D%97%E7%A8%8B%E5%BA%8F%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">6.3.</span> <span class="toc-text">5.3.æ¨¡å—ç¨‹åºæºä»£ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91Makefile"><span class="toc-number">6.4.</span> <span class="toc-text">5.4.æºç ç¼–è¯‘Makefile</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-ipK%E5%8C%85%E5%88%B6%E4%BD%9C%E8%A7%84%E5%88%99Makefile"><span class="toc-number">6.5.</span> <span class="toc-text">5.5.ipKåŒ…åˆ¶ä½œè§„åˆ™Makefile</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6-%E7%BC%96%E8%AF%91%E6%A8%A1%E5%9D%97"><span class="toc-number">6.6.</span> <span class="toc-text">5.6.ç¼–è¯‘æ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-7-ipk%E5%8C%85%E5%88%B6%E4%BD%9C"><span class="toc-number">6.7.</span> <span class="toc-text">5.7.ipkåŒ…åˆ¶ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-8-%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95"><span class="toc-number">6.8.</span> <span class="toc-text">5.8.å®‰è£…æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91%E6%96%B9%E6%B3%95"><span class="toc-number">7.</span> <span class="toc-text">6.å†…æ ¸æ¨¡å—å¼€å‘æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E5%BB%BA%E7%AB%8B%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95"><span class="toc-number">7.1.</span> <span class="toc-text">6.1.å»ºç«‹å·¥ä½œç›®å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E8%BF%9B%E5%85%A5example%E7%9B%AE%E5%BD%95%EF%BC%8C%E5%88%9B%E5%BB%BAMakefile%E6%96%87%E4%BB%B6%E5%92%8C%E4%BB%A3%E7%A0%81%E8%B7%AF%E5%BE%84"><span class="toc-number">7.2.</span> <span class="toc-text">6.2.è¿›å…¥exampleç›®å½•ï¼Œåˆ›å»ºMakefileæ–‡ä»¶å’Œä»£ç è·¯å¾„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E8%BF%9B%E5%85%A5src%E7%9B%AE%E5%BD%95%EF%BC%8C%E5%88%9B%E5%BB%BA%E4%BB%A3%E7%A0%81%E8%B7%AF%E5%BE%84%E5%92%8C%E7%9B%B8%E5%85%B3%E6%BA%90%E6%96%87%E4%BB%B6"><span class="toc-number">7.3.</span> <span class="toc-text">6.3.è¿›å…¥srcç›®å½•ï¼Œåˆ›å»ºä»£ç è·¯å¾„å’Œç›¸å…³æºæ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-%E5%9B%9E%E5%88%B0OpenWrt%E6%BA%90%E7%A0%81%E6%A0%B9%E7%9B%AE%E5%BD%95%E4%B8%8B"><span class="toc-number">7.4.</span> <span class="toc-text">6.4.å›åˆ°OpenWrtæºç æ ¹ç›®å½•ä¸‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-%E5%9C%A8OpenWrt%E7%B3%BB%E7%BB%9F%E9%87%8C%E9%9D%A2%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%94%A8opkg%E4%B8%8B%E8%BD%BD%E4%BD%BF%E7%94%A8%E4%BA%86%E3%80%82"><span class="toc-number">7.5.</span> <span class="toc-text">6.5.åœ¨OpenWrtç³»ç»Ÿé‡Œé¢å°±å¯ä»¥ç”¨opkgä¸‹è½½ä½¿ç”¨äº†ã€‚</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-openwrt-Makefile%E6%A1%86%E6%9E%B6%E5%88%86%E6%9E%90"><span class="toc-number">8.</span> <span class="toc-text">7.openwrt Makefileæ¡†æ¶åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-openwrt%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">8.1.</span> <span class="toc-text">7.1.openwrtç›®å½•ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-main-Makefile"><span class="toc-number">8.2.</span> <span class="toc-text">7.2.main Makefile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AA%E9%80%BB%E8%BE%91"><span class="toc-number">8.2.1.</span> <span class="toc-text">ç¬¬ä¸€ä¸ªé€»è¾‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%80%BB%E8%BE%91"><span class="toc-number">8.2.2.</span> <span class="toc-text">ç¬¬äºŒé€»è¾‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stampfile"><span class="toc-number">8.2.3.</span> <span class="toc-text">stampfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E5%8F%98%E9%87%8F"><span class="toc-number">8.2.4.</span> <span class="toc-text">ç›®å½•å˜é‡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-kernel-%E7%BC%96%E8%AF%91%EF%BC%9A"><span class="toc-number">8.3.</span> <span class="toc-text">7.3.kernel ç¼–è¯‘ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-%E7%94%9F%E6%88%90firmware"><span class="toc-number">8.4.</span> <span class="toc-text">7.4.ç”Ÿæˆfirmware</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86vmlinux-Image-x2F-BuildKernel"><span class="toc-number">8.4.1.</span> <span class="toc-text">å¤„ç†vmlinux: Image&#x2F;BuildKernel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lzma%E5%8E%8B%E7%BC%A9%E5%86%85%E6%A0%B8"><span class="toc-number">8.4.2.</span> <span class="toc-text">lzmaå‹ç¼©å†…æ ¸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MkImage"><span class="toc-number">8.4.3.</span> <span class="toc-text">MkImage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#copy"><span class="toc-number">8.4.4.</span> <span class="toc-text">copy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-5-%E5%88%B6%E4%BD%9Csquashfs%EF%BC%8C%E7%94%9F%E6%88%90-bin-call-Image-x2F-mkfs-x2F-squashfs"><span class="toc-number">8.5.</span> <span class="toc-text">7.5.åˆ¶ä½œsquashfsï¼Œç”Ÿæˆ.bin: $(call Image&#x2F;mkfs&#x2F;squashfs)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-6-Openwrt-SDK%E4%B8%ADMakefile%E7%9B%B8%E5%85%B3%E6%80%BB%E7%BB%93"><span class="toc-number">8.6.</span> <span class="toc-text">7.6.Openwrt_SDKä¸­Makefileç›¸å…³æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-1CURDIR%E5%8F%98%E9%87%8F"><span class="toc-number">8.6.1.</span> <span class="toc-text">7.6.1CURDIRå˜é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-2%E7%A9%BA%E6%A0%BC%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-number">8.6.2.</span> <span class="toc-text">7.6.2ç©ºæ ¼çš„è¡¨ç¤ºæ–¹æ³•ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-3%E8%B0%83%E7%94%A8makefile%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-number">8.6.3.</span> <span class="toc-text">7.6.3è°ƒç”¨makefileä¸­çš„å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-4-%E5%85%B6%E4%BB%96%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9"><span class="toc-number">8.6.4.</span> <span class="toc-text">7.6.4.å…¶ä»–ç›¸å…³å†…å®¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1make-%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-number">8.6.4.1.</span> <span class="toc-text">2.1make çš„å‚æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2%E5%B5%8C%E5%A5%97%E6%89%A7%E8%A1%8Cmake"><span class="toc-number">8.6.4.2.</span> <span class="toc-text">2.2åµŒå¥—æ‰§è¡Œmake</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%9C%A8package%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84Makefile"><span class="toc-number">8.6.4.3.</span> <span class="toc-text">2.åœ¨packageç›®å½•ä¸­çš„Makefile:</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-call%E5%87%BD%E6%95%B0"><span class="toc-number">8.6.4.3.1.</span> <span class="toc-text">2.1.callå‡½æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-eval%E5%87%BD%E6%95%B0"><span class="toc-number">8.6.4.3.2.</span> <span class="toc-text">2.2.evalå‡½æ•°</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E8%BD%AF%E4%BB%B6%E5%8C%85Makefile%E8%A7%A3%E6%9E%90"><span class="toc-number">9.</span> <span class="toc-text">8.è½¯ä»¶åŒ…Makefileè§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-include-TOPDIR-x2F-rules-mk"><span class="toc-number">9.1.</span> <span class="toc-text">8.1.include $(TOPDIR)&#x2F;rules.mk</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-%E8%87%AA%E5%AE%9A%E4%B9%89-PKG-XXXX-%E5%8F%98%E9%87%8F"><span class="toc-number">9.2.</span> <span class="toc-text">8.2.è‡ªå®šä¹‰ PKG_XXXX å˜é‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-include-INCLUDE-DIR-x2F-package-mk"><span class="toc-number">9.3.</span> <span class="toc-text">8.3.include $(INCLUDE_DIR)&#x2F;package.mk</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E5%AE%83%E4%BC%9A%E9%85%8D%E7%BD%AE%E9%BB%98%E8%AE%A4%E7%9A%84%E5%8F%98%E9%87%8F"><span class="toc-number">9.3.1.</span> <span class="toc-text">ï¼ˆ1ï¼‰å®ƒä¼šé…ç½®é»˜è®¤çš„å˜é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E6%8E%A8%E5%AF%BC%E5%85%B6%E5%AE%83%E5%8F%98%E9%87%8F"><span class="toc-number">9.3.2.</span> <span class="toc-text">ï¼ˆ2ï¼‰æ¨å¯¼å…¶å®ƒå˜é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E5%8C%85%E5%90%AB%E5%85%B6%E5%AE%83mk%E6%96%87%E4%BB%B6"><span class="toc-number">9.3.3.</span> <span class="toc-text">ï¼ˆ3ï¼‰åŒ…å«å…¶å®ƒmkæ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E5%AE%9A%E4%B9%89%E9%BB%98%E8%AE%A4%E5%AE%8F"><span class="toc-number">9.3.4.</span> <span class="toc-text">ï¼ˆ4ï¼‰å®šä¹‰é»˜è®¤å®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%885%EF%BC%89BuildPackage%E5%AE%8F"><span class="toc-number">9.3.5.</span> <span class="toc-text">ï¼ˆ5ï¼‰BuildPackageå®</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-4-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AE%8F"><span class="toc-number">9.4.</span> <span class="toc-text">8.4.è‡ªå®šä¹‰å®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%85%E9%A1%BB%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AE%8F"><span class="toc-number">9.4.1.</span> <span class="toc-text">å¿…é¡»å®šä¹‰çš„å®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E9%80%89%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AE%8F"><span class="toc-number">9.4.2.</span> <span class="toc-text">å¯é€‰å®šä¹‰çš„å®</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Package-x2F-conffiles-optional"><span class="toc-number">9.4.2.0.1.</span> <span class="toc-text">Package&#x2F;conffiles (optional)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Package-x2F-description"><span class="toc-number">9.4.2.0.2.</span> <span class="toc-text">Package&#x2F;description</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Build-x2F-Prepare-optional"><span class="toc-number">9.4.2.0.3.</span> <span class="toc-text">Build&#x2F;Prepare (optional)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Build-x2F-Configure-optional"><span class="toc-number">9.4.2.0.4.</span> <span class="toc-text">Build&#x2F;Configure (optional)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Build-x2F-Compile-optional"><span class="toc-number">9.4.2.0.5.</span> <span class="toc-text">Build&#x2F;Compile (optional)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Build-x2F-Install-optional"><span class="toc-number">9.4.2.0.6.</span> <span class="toc-text">Build&#x2F;Install (optional)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Build-x2F-InstallDev-optional"><span class="toc-number">9.4.2.0.7.</span> <span class="toc-text">Build&#x2F;InstallDev (optional)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Package-x2F-install"><span class="toc-number">9.4.2.0.8.</span> <span class="toc-text">Package&#x2F;install</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Package-x2F-preinst"><span class="toc-number">9.4.2.0.9.</span> <span class="toc-text">Package&#x2F;preinst</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Package-x2F-postinst"><span class="toc-number">9.4.2.0.10.</span> <span class="toc-text">Package&#x2F;postinst</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Package-x2F-prerm"><span class="toc-number">9.4.2.0.11.</span> <span class="toc-text">Package&#x2F;prerm</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Package-x2F-postrm"><span class="toc-number">9.4.2.0.12.</span> <span class="toc-text">Package&#x2F;postrm</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-5-%E4%BD%BF%E4%B9%8B%E7%94%9F%E6%95%88"><span class="toc-number">9.5.</span> <span class="toc-text">8.5.ä½¿ä¹‹ç”Ÿæ•ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-6-%E6%B7%BB%E5%8A%A0%E6%96%B0%E7%BC%96%E8%AF%91%E9%80%89%E9%A1%B9"><span class="toc-number">9.6.</span> <span class="toc-text">8.6.æ·»åŠ æ–°ç¼–è¯‘é€‰é¡¹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-openwrt%E4%B8%BBMakafile%E8%A7%A3%E6%9E%90"><span class="toc-number">10.</span> <span class="toc-text">9.openwrtä¸»Makafileè§£æ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">11.</span> <span class="toc-text">å‚è€ƒèµ„æ–™</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95%EF%BC%9A"><span class="toc-number">12.</span> <span class="toc-text">é—®é¢˜è®°å½•ï¼š</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E3%80%90close%E3%80%91%E5%9C%A8%E7%A7%BB%E6%A4%8Dexfat%E9%A9%B1%E5%8A%A8%E5%88%B0openwrt%E6%97%B6%E9%81%87%E5%88%B0%E5%A6%82%E4%B8%8B%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-number">12.1.</span> <span class="toc-text">ï¼ˆ1ï¼‰ã€closeã€‘åœ¨ç§»æ¤exfaté©±åŠ¨åˆ°openwrtæ—¶é‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E3%80%90close%E3%80%91SDK%E4%BF%AE%E6%94%B9%E7%9B%AE%E5%BD%95%E5%90%8D%E7%A7%B0%E5%90%8E%E6%97%A0%E6%B3%95%E7%BB%A7%E7%BB%AD%E7%BC%96%E8%AF%91%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="toc-number">12.2.</span> <span class="toc-text">ï¼ˆ2ï¼‰ã€closeã€‘SDKä¿®æ”¹ç›®å½•åç§°åæ— æ³•ç»§ç»­ç¼–è¯‘é—®é¢˜è§£å†³</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E3%80%90close%E3%80%91%E7%BC%96%E8%AF%91%E5%8D%95%E4%B8%AA%E6%A8%A1%E5%9D%97%E8%BD%AF%E4%BB%B6%E6%97%B6%EF%BC%8C%E6%8F%90%E7%A4%BA%E7%BC%BA%E5%B0%91C%E5%BA%93"><span class="toc-number">12.3.</span> <span class="toc-text">ï¼ˆ3ï¼‰ã€closeã€‘ç¼–è¯‘å•ä¸ªæ¨¡å—è½¯ä»¶æ—¶ï¼Œæç¤ºç¼ºå°‘Cåº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E3%80%90close%E3%80%91%E7%BC%96%E8%AF%91%E7%9A%84%E6%A8%A1%E5%9D%97%E6%97%A0%E6%B3%95%E5%9C%A8opentwr%E7%B3%BB%E7%BB%9F%E4%B8%AD%E8%BF%90%E8%A1%8C"><span class="toc-number">12.4.</span> <span class="toc-text">ï¼ˆ4ï¼‰ã€closeã€‘ç¼–è¯‘çš„æ¨¡å—æ— æ³•åœ¨opentwrç³»ç»Ÿä¸­è¿è¡Œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%885%EF%BC%89%E3%80%90close%E3%80%91%E5%9C%A8%E5%8E%9Fodhcp6c%E6%BA%90%E7%A0%81%E4%B8%AD%E5%A2%9E%E5%8A%A0%E4%BA%86log-c-log-h%E6%96%87%E4%BB%B6%E5%90%8E%EF%BC%8C%E7%BC%96%E8%AF%91%E6%97%B6%E5%87%BA%E7%8E%B0%E5%A6%82%E4%B8%8B%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-number">12.5.</span> <span class="toc-text">ï¼ˆ5ï¼‰ã€closeã€‘åœ¨åŸodhcp6cæºç ä¸­å¢åŠ äº†log.c log.hæ–‡ä»¶åï¼Œç¼–è¯‘æ—¶å‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/ax3000t.html" title="å°ç±³AX3000Tåˆ·ä¸æ­»uboot+åˆ·openwrtç³»ç»Ÿæ•™ç¨‹"><img src="https://gitlab.com/xiaowansm/img/-/raw/main/pictures/2022/08/12_7_37_16_202208120737684.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å°ç±³AX3000Tåˆ·ä¸æ­»uboot+åˆ·openwrtç³»ç»Ÿæ•™ç¨‹"/></a><div class="content"><a class="title" href="/post/ax3000t.html" title="å°ç±³AX3000Tåˆ·ä¸æ­»uboot+åˆ·openwrtç³»ç»Ÿæ•™ç¨‹">å°ç±³AX3000Tåˆ·ä¸æ­»uboot+åˆ·openwrtç³»ç»Ÿæ•™ç¨‹</a><time datetime="2023-12-12T02:21:16.000Z" title="å‘è¡¨äº 2023-12-12 10:21:16">2023-12-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/ax6000-boot.html" title="çº¢ç±³ax6000åˆ·ä¸æ­»uboot+åˆ·openwrt+åˆ·å›åŸå‚ç³»ç»Ÿæ•™ç¨‹"><img src="https://gitlab.com/xiaowansm/img/-/raw/main/pictures/2022/08/12_7_39_11_202208120739884.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="çº¢ç±³ax6000åˆ·ä¸æ­»uboot+åˆ·openwrt+åˆ·å›åŸå‚ç³»ç»Ÿæ•™ç¨‹"/></a><div class="content"><a class="title" href="/post/ax6000-boot.html" title="çº¢ç±³ax6000åˆ·ä¸æ­»uboot+åˆ·openwrt+åˆ·å›åŸå‚ç³»ç»Ÿæ•™ç¨‹">çº¢ç±³ax6000åˆ·ä¸æ­»uboot+åˆ·openwrt+åˆ·å›åŸå‚ç³»ç»Ÿæ•™ç¨‹</a><time datetime="2023-12-01T10:21:16.000Z" title="å‘è¡¨äº 2023-12-01 18:21:16">2023-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/xiaoya-Tvbox.html" title="xiaoya-Tvboxï¼šæµ·é‡ä¸“å±å½±è§†èµ„æºåº“"><img src="http://p9.qhimg.com/bdr/__85/t0153df2c1ccb1f5c1a.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="xiaoya-Tvboxï¼šæµ·é‡ä¸“å±å½±è§†èµ„æºåº“"/></a><div class="content"><a class="title" href="/post/xiaoya-Tvbox.html" title="xiaoya-Tvboxï¼šæµ·é‡ä¸“å±å½±è§†èµ„æºåº“">xiaoya-Tvboxï¼šæµ·é‡ä¸“å±å½±è§†èµ„æºåº“</a><time datetime="2023-11-22T04:21:16.000Z" title="å‘è¡¨äº 2023-11-22 12:21:16">2023-11-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/siri-ai.html" title="ç”¨AIå‡çº§ä½ çš„Siriæ™ºå•†"><img src="https://gitlab.com/xiaowansm/img/-/raw/main/pictures/2022/08/12_7_39_17_202208120739463.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ç”¨AIå‡çº§ä½ çš„Siriæ™ºå•†"/></a><div class="content"><a class="title" href="/post/siri-ai.html" title="ç”¨AIå‡çº§ä½ çš„Siriæ™ºå•†">ç”¨AIå‡çº§ä½ çš„Siriæ™ºå•†</a><time datetime="2023-11-22T02:21:16.000Z" title="å‘è¡¨äº 2023-11-22 10:21:16">2023-11-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/chrome.html" title="å¼€å¯è°·æ­Œæµè§ˆå™¨æ–°UIç•Œé¢"><img src="http://p18.qhimg.com/bdr/__85/t01828ffff019409f50.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å¼€å¯è°·æ­Œæµè§ˆå™¨æ–°UIç•Œé¢"/></a><div class="content"><a class="title" href="/post/chrome.html" title="å¼€å¯è°·æ­Œæµè§ˆå™¨æ–°UIç•Œé¢">å¼€å¯è°·æ­Œæµè§ˆå™¨æ–°UIç•Œé¢</a><time datetime="2023-11-02T01:21:16.000Z" title="å‘è¡¨äº 2023-11-02 09:21:16">2023-11-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 <i style="color:#FF6A6A" class="fa fa-heartbeat"></i> XiaoWanğŸ’¦</div><div class="footer_custom_text"><span id="jinrishici-sentence">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯....</span> <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script> <br>
<a target="_blank" href="https://pan.wwang.pw"><i class="fa fa-cloud" aria-hidden="true"></i> å›ºä»¶ä»“åº“ </a>  â€¢ <a target="_blank" href="https://pan.xiaowansm.repl.co/"><i class="fa fa-cloud-download" aria-hidden="true"></i> ç½‘ç›˜ </a>  â€¢ <a target="_blank" href="https://music.wwang.eu.org/"><i class="fa fa-music" aria-hidden="true"></i> éŸ³ä¹åº“ </a>  â€¢ <a target="_blank" href="https://t.me/xiaowansm"><i class="fa-brands fa-telegram"></i> TGç¾¤</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://koo.wwang.pw',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://koo.wwang.pw',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo@1/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && location.pathname =='/'){
    
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src="https://gitlab.com/xiaowansm/img/-/raw/main/pictures/2022/08/12_7_37_5_202208120737459.jpg" alt="https://gitlab.com/xiaowansm/img/-/raw/main/pictures/2022/08/12_7_37_5_202208120737459.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-03-08</span><a class="blog-slider__title" href="post/op-vip.html">OpenWrtå›ºä»¶å®šåˆ¶æœåŠ¡</a><div class="blog-slider__text">OpenWrtå›ºä»¶ç§äººå®šåˆ¶æœåŠ¡ï¼Œå®šåˆ¶ä¸“å±æ‚¨çš„å›ºä»¶ã€‚</div><a class="blog-slider__button" href="post/op-vip.html">è¯¦æƒ…</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src="https://gitlab.com/xiaowansm/img/-/raw/main/pictures/2022/08/12_7_37_5_202208120737459.jpg" alt="https://gitlab.com/xiaowansm/img/-/raw/main/pictures/2022/08/12_7_37_5_202208120737459.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2022-08-06</span><a class="blog-slider__title" href="post/op.html">OpenWrtåŸºç¡€ä½¿ç”¨æ•™ç¨‹</a><div class="blog-slider__text">OpenWrtåŸºç¡€ä½¿ç”¨æ•™ç¨‹ï¼Œç®€æ´æ˜“æ‡‚</div><a class="blog-slider__button" href="post/op.html">è¯¦æƒ…</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src="http://p16.qhimg.com/bdr/__85/t013d1246605bed9df6.jpg" alt="http://p16.qhimg.com/bdr/__85/t013d1246605bed9df6.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2022-09-06</span><a class="blog-slider__title" href="post/padavan.html">Padavanã€è€æ¯›å­ã€‘å›ºä»¶åŸºç¡€ä½¿ç”¨æ•™ç¨‹</a><div class="blog-slider__text">Padavanè€æ¯›å­å›ºä»¶åŸºç¡€ä½¿ç”¨æ•™ç¨‹</div><a class="blog-slider__button" href="post/padavan.html">è¯¦æƒ…</a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½swiper')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script>
<script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiper.min.js"></script>
<script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper@0.18/swiper/swiperindex.js"></script>
<style></style><script data-pjax>function history_calendar_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>é‚£å¹´ä»Šæ—¥</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
                console.log('å·²æŒ‚è½½history_calendar')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // æ— æŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨(æ”¯æŒpjaxè·³è½¬)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // æœ‰æŠ¥é”™ï¼Œä½†ä¸å½±å“ä½¿ç”¨(æ”¯æŒpjaxè·³è½¬)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            history_calendar_injector_config()
        } </script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = '3d926102a85f40e2a9583ae69e9f0517';
  var gaud_map_key = 'bca731ccbc9006e0d63ac3e2ba3a8a55';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '112.982279,28.19409';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>